prompt Loading YS_DOTMODULE...
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (23, 802001, 801000, '客户签收', '023_KHQS', '配送单号', 130001, 232002, 232060, 204002, null, to_date('23-04-2015 13:51:57', 'dd-mm-yyyy hh24:mi:ss'), to_date('14-08-2015 06:38:22', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (24, 802001, 801000, '客户部分拒收', '024_KHBFQS', '配送单号/拒收订单编号', 130001, 232002, 232061, 204002, null, to_date('23-04-2015 13:54:23', 'dd-mm-yyyy hh24:mi:ss'), to_date('14-08-2015 06:38:27', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (25, 802001, 801000, '客户全部拒收', '025_KHQBJS', '配送单号', 130001, 232002, 232061, 204002, null, to_date('23-04-2015 13:56:10', 'dd-mm-yyyy hh24:mi:ss'), to_date('14-08-2015 06:38:34', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (34, 802001, 801000, '退货出库', '034_THCK', '订单编号', 130001, 232043, 232080, 204002, null, to_date('06-07-2015 16:56:11', 'dd-mm-yyyy hh24:mi:ss'), to_date('18-09-2015 12:45:56', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (28, 802001, 801000, '出库单生成', '028_PSDSC', '车辆编码', 130001, 232048, 232049, 204002, null, to_date('23-04-2015 13:51:11', 'dd-mm-yyyy hh24:mi:ss'), to_date('16-07-2015 23:27:46', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (26, 802001, 801000, '物流箱回收', '026_ZZXHS', '车辆编码/物流箱编码', 130001, 232060, 0, 204002, null, to_date('23-04-2015 13:59:20', 'dd-mm-yyyy hh24:mi:ss'), to_date('12-08-2015 07:47:19', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (38, 802001, 801000, '生成销售退货汇总单', '038_XSTHHZD', null, 130001, 232070, 232071, 204000, null, to_date('06-07-2015 16:56:11', 'dd-mm-yyyy hh24:mi:ss'), to_date('21-09-2015 10:56:09', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (46, 802001, 801000, '提货装车（越库）', '046_THZC', null, 130001, 232047, 232048, 204002, null, to_date('06-07-2015 16:56:11', 'dd-mm-yyyy hh24:mi:ss'), to_date('06-11-2015 05:20:53', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (32, 802001, 801000, '缺货审批处理', '032_QHSPCL', null, 130001, 232031, 232050, 204000, null, to_date('06-07-2015 16:56:11', 'dd-mm-yyyy hh24:mi:ss'), to_date('26-08-2015 19:18:52', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (35, 802001, 801000, '退货报损', '035_THBS', '订单编号', 130001, 232043, 232091, 204002, null, to_date('06-07-2015 16:56:11', 'dd-mm-yyyy hh24:mi:ss'), to_date('18-09-2015 12:46:13', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (40, 802001, 801000, '提取买家退货', '040_TQMJTH', null, 130001, 232072, 232073, 204000, null, to_date('06-07-2015 16:56:11', 'dd-mm-yyyy hh24:mi:ss'), to_date('28-09-2015 12:16:04', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (42, 802001, 801000, '打印采购退货单', '042_CGTHDDY', null, 130001, 232081, 232085, 204000, null, to_date('06-07-2015 16:56:11', 'dd-mm-yyyy hh24:mi:ss'), to_date('28-09-2015 12:18:59', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (33, 802001, 801000, '退货入库', '033_THRK', '目的容器/订单编号', 130001, 232073, 232043, 204002, null, to_date('06-07-2015 16:56:11', 'dd-mm-yyyy hh24:mi:ss'), to_date('28-09-2015 13:33:54', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (44, 802001, 801000, '采购退货', '044_CGTH', null, 130001, 232087, 232090, 204002, null, to_date('06-07-2015 16:56:11', 'dd-mm-yyyy hh24:mi:ss'), to_date('28-09-2015 12:22:07', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (30, 802001, 801000, '处理买家退货请求', '030_CLTHDD', null, 130001, 232060, null, 204000, null, to_date('06-07-2015 16:56:11', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-09-2015 10:06:52', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (45, 802001, 801000, '分派提货车辆（越库）', '045_FPTHCL', null, 130001, 232023, 232047, 204002, null, to_date('06-07-2015 16:56:11', 'dd-mm-yyyy hh24:mi:ss'), to_date('06-11-2015 05:40:41', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (9, 802001, 801000, '提货', '009_TH', '订单编号', 130001, 232025, 232028, 204002, null, to_date('21-04-2015 12:08:44', 'dd-mm-yyyy hh24:mi:ss'), to_date('28-07-2015 17:49:19', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (36, 802001, 801000, '拼箱', '036_PX', '目的物流箱/订单编号', 130001, 232046, 232046, 204002, null, to_date('06-07-2015 16:56:11', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-08-2015 13:41:25', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (39, 802001, 801000, '打印销售退货单', '039_XSTHDDY', null, 130001, 232071, 232072, 204000, null, to_date('06-07-2015 16:56:11', 'dd-mm-yyyy hh24:mi:ss'), to_date('28-09-2015 12:14:43', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (43, 802001, 801000, '采购退货单分配', '043_CGTHDFP', null, 130001, 232085, 232087, 204002, null, to_date('06-07-2015 16:56:11', 'dd-mm-yyyy hh24:mi:ss'), to_date('28-09-2015 12:22:15', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (41, 802001, 801000, '生成采购退货汇总单', '041_CGTHHZ', null, 130001, 232080, 232081, 204000, null, to_date('06-07-2015 16:56:11', 'dd-mm-yyyy hh24:mi:ss'), to_date('28-09-2015 12:18:05', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (15, 802001, 801000, '入库收货', '015_RKSH', '容器编码/容器位置编码/订单编号', 130001, 232040, 232042, 204002, null, to_date('23-04-2015 08:42:28', 'dd-mm-yyyy hh24:mi:ss'), to_date('15-10-2015 21:49:30', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (47, 802001, 801000, '043_XXX[副]', '043_XXX', null, 130001, null, null, 204000, null, to_date('06-07-2015 16:56:11', 'dd-mm-yyyy hh24:mi:ss'), to_date('28-09-2015 12:19:28', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (48, 802001, 801000, '043_XXX[副]', '043_XXX', null, 130001, null, null, 204000, null, to_date('06-07-2015 16:56:11', 'dd-mm-yyyy hh24:mi:ss'), to_date('28-09-2015 12:19:29', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (11, 802001, 801000, '提货转运', '011_THZY', '总件数/转运人工号/密码', 130001, 232028, 232030, 204002, null, to_date('21-04-2015 12:08:44', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-07-2015 09:07:00', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (12, 802001, 801000, '入库卸货', '012_RKXH', '转运人工号', 130001, 232030, 232040, 204002, null, to_date('22-04-2015 18:18:27', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-07-2015 12:31:58', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (1, 802001, 801000, '状态查询', '001_CKDDXQ', '订单编号/容器/位置/包装箱', 130001, null, null, 204002, null, to_date('21-04-2015 12:08:41', 'dd-mm-yyyy hh24:mi:ss'), to_date('04-08-2015 13:51:01', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (20, 802001, 801000, '库内集货', '020_KNJH', '容器编码/目的位置编码/目的容器编码/物流箱编码', 130001, 232045, 232046, 204002, null, to_date('23-04-2015 13:44:56', 'dd-mm-yyyy hh24:mi:ss'), to_date('10-08-2015 17:47:04', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (4, 802001, 801000, '订单标签打印', '004_DDBQDY', null, 130001, 232022, 232023, 204000, null, to_date('21-04-2015 12:08:41', 'dd-mm-yyyy hh24:mi:ss'), to_date('08-05-2015 16:00:15', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (14, 802001, 801000, '入库质检', '014_RKZJ', '容器编码/容器位置编码/订单编号/选择质检结果', 130001, 232040, 232040, 204002, null, to_date('23-04-2015 08:17:32', 'dd-mm-yyyy hh24:mi:ss'), to_date('08-05-2015 18:15:58', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (5, 802001, 801000, '提货单分配', '005_THDFP', '提货汇总单号', 130001, 232023, 232024, 204002, null, to_date('21-04-2015 12:08:41', 'dd-mm-yyyy hh24:mi:ss'), to_date('11-05-2015 15:52:27', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (22, 802001, 801000, '配送单打印', '022_PSDDY', null, 130001, 232049, 232002, 204001, null, to_date('23-04-2015 13:51:11', 'dd-mm-yyyy hh24:mi:ss'), to_date('20-05-2015 09:49:58', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (37, 802001, 801000, '称重', '037_CZ', null, 130001, null, null, 204002, null, to_date('06-07-2015 16:56:11', 'dd-mm-yyyy hh24:mi:ss'), to_date('15-09-2015 22:19:36', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (21, 802001, 801000, '发货（出库）', '021_ZBCK', '车辆编码/物流容器编码/物流箱编码', 130001, 232046, 232048, 204002, null, to_date('23-04-2015 13:49:08', 'dd-mm-yyyy hh24:mi:ss'), to_date('20-05-2015 09:49:30', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (6, 802001, 801000, '提货单发放', '006_THDFF', '提货单编号/预计提货时间', 130001, 232024, 232025, 204002, null, to_date('21-04-2015 12:08:43', 'dd-mm-yyyy hh24:mi:ss'), to_date('04-05-2015 17:57:49', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (3, 802001, 801000, '提货单打印', '003_THDDY', null, 130001, 232021, 232022, 204001, null, to_date('21-04-2015 12:08:41', 'dd-mm-yyyy hh24:mi:ss'), to_date('22-04-2015 15:29:52', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (7, 802001, 801000, '卖家备货', '007_MJBH', null, 130001, 232020, 232026, 204000, null, to_date('21-04-2015 12:08:43', 'dd-mm-yyyy hh24:mi:ss'), to_date('22-04-2015 15:30:25', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (8, 802001, 801000, '卖家发货', '008_MJFH', null, 130001, 232026, 232027, 204000, null, to_date('21-04-2015 12:08:44', 'dd-mm-yyyy hh24:mi:ss'), to_date('22-04-2015 15:30:53', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (10, 802001, 801000, '提货（直接供应商）', '010_THZ', '提货汇总单号/提货单号/订单编号', 130001, 232027, 232028, 204002, null, to_date('21-04-2015 12:08:44', 'dd-mm-yyyy hh24:mi:ss'), to_date('23-04-2015 11:46:33', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (17, 802001, 801000, '拒收入库', '017_JSRK', '配送单号/容器编码/订单编号/容器位置编码', 130001, 232061, 232043, 204002, null, to_date('23-04-2015 08:49:39', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-09-2015 14:23:59', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (13, 802001, 801000, '入库卸货（直接供应商）', '013_RKXHZ', '供应商出库单号', 130001, 232027, 232040, 204002, null, to_date('22-04-2015 18:19:50', 'dd-mm-yyyy hh24:mi:ss'), to_date('23-04-2015 12:02:24', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (16, 802001, 801000, '入库收货（直接供应商）', '016_RKSHZ', '容器编码/容器位置编码/卖家出库单号', 130001, 232041, 232042, 204002, null, to_date('23-04-2015 08:45:17', 'dd-mm-yyyy hh24:mi:ss'), to_date('23-04-2015 12:17:12', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (18, 802001, 801000, '波次分拣', '018_BCFJ', '原容器编码/目标容器编码/订单编号/目标容器位置编码', 130001, 232042, 232044, 204002, null, to_date('23-04-2015 08:52:19', 'dd-mm-yyyy hh24:mi:ss'), to_date('23-04-2015 13:39:12', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (2, 802001, 801000, '分配提货路线', '002_FPTHLX', null, 130001, 232020, 232021, 204000, null, to_date('21-04-2015 12:08:41', 'dd-mm-yyyy hh24:mi:ss'), to_date('04-05-2015 17:55:38', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (27, 802001, 801000, '消单', '027_XDQS', '配送汇总单号', 130001, 232060, 232009, 204002, null, to_date('23-04-2015 13:59:20', 'dd-mm-yyyy hh24:mi:ss'), to_date('25-05-2015 11:46:10', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (19, 802001, 801000, '装箱', '019_ZX', '原容器编码/物流箱编码/订单编号/目标容器编码', 130001, 232044, 232045, 204002, null, to_date('23-04-2015 08:52:19', 'dd-mm-yyyy hh24:mi:ss'), to_date('28-05-2015 19:15:08', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (29, 802001, 801000, '客户修正重量', '029_KHXZZL', null, 130001, null, null, 204000, null, to_date('06-07-2015 16:56:11', 'dd-mm-yyyy hh24:mi:ss'), to_date('16-07-2015 23:28:52', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULE (dataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, istdate, uptdate)
values (31, 802001, 801000, '商品报缺', '031_SPBQ', null, 130001, 232025, 232031, 204002, null, to_date('06-07-2015 16:56:11', 'dd-mm-yyyy hh24:mi:ss'), to_date('22-07-2015 15:21:15', 'dd-mm-yyyy hh24:mi:ss'));
commit;
prompt 48 records loaded
prompt Loading YS_DOTMODULEDETAIL...
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (21, 14, 802001, 801000, '选择质检结果', 205004, '合格/不合格/虫眼/烂叶', '合格', 1, 1, 4, null, '0', 0, 0, null, '0', to_date('23-04-2015 12:04:23', 'dd-mm-yyyy hh24:mi:ss'), to_date('22-07-2015 07:49:30', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (102, 45, 802001, 801000, '提货汇总单号', 205001, null, null, 1, 1, 1, 206006, '1', null, null, null, null, to_date('05-11-2015 09:26:05', 'dd-mm-yyyy hh24:mi:ss'), to_date('05-11-2015 15:58:35', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (106, 46, 802001, 801000, '实际数量', 205007, null, null, 1, 1, 3, null, '1', null, null, null, null, to_date('05-11-2015 10:07:39', 'dd-mm-yyyy hh24:mi:ss'), to_date('05-11-2015 16:01:47', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (51, 21, 802001, 801000, '容器编码', 205001, null, null, 1, 1, 2, 206003, '1', 0, 0, '1', '0', to_date('23-04-2015 13:49:56', 'dd-mm-yyyy hh24:mi:ss'), to_date('25-06-2015 20:14:59', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (24, 15, 802001, 801000, '容器位置编码', 205001, null, null, 1, 1, 2, 206004, '1', 0, 0, '1', '0', to_date('23-04-2015 12:05:31', 'dd-mm-yyyy hh24:mi:ss'), to_date('25-06-2015 21:17:18', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (71, 26, 802001, 801000, '车辆编号', 205001, null, null, 1, 1, 1, 206008, '1', 0, 0, null, '0', to_date('25-05-2015 11:48:33', 'dd-mm-yyyy hh24:mi:ss'), to_date('12-08-2015 06:28:16', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (74, 26, 802001, 801000, '物流箱编码', 205001, null, null, 1, 2, 2, 206002, '1', 0, 0, '1', '0', to_date('25-05-2015 11:48:33', 'dd-mm-yyyy hh24:mi:ss'), to_date('12-08-2015 07:46:36', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (83, 35, 802001, 801000, '订单编号', 205001, null, null, 1, 2, 1, 206001, '1', 232043, 232072, null, null, to_date('26-08-2015 19:10:45', 'dd-mm-yyyy hh24:mi:ss'), to_date('26-08-2015 19:10:45', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (84, 35, 802001, 801000, '提交', 205002, null, null, null, null, 2, null, null, null, null, null, null, to_date('26-08-2015 19:11:08', 'dd-mm-yyyy hh24:mi:ss'), to_date('26-08-2015 19:11:08', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (85, 34, 802001, 801000, '订单编号', 205001, null, null, 1, 2, 1, 206001, '1', 232043, 232012, null, null, to_date('26-08-2015 19:11:57', 'dd-mm-yyyy hh24:mi:ss'), to_date('26-08-2015 19:11:57', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (89, 33, 802001, 801000, '位置', 205001, null, null, 1, 1, 3, 206004, null, null, null, null, null, to_date('26-08-2015 19:15:39', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-09-2015 13:58:21', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (87, 33, 802001, 801000, '目的容器', 205001, null, null, 1, 1, 1, 206003, '1', 0, 232043, null, null, to_date('26-08-2015 19:14:51', 'dd-mm-yyyy hh24:mi:ss'), to_date('26-08-2015 19:14:51', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (88, 33, 802001, 801000, '订单编号', 205001, null, null, 1, 2, 2, 206001, '1', 232011, 232043, null, null, to_date('26-08-2015 19:15:27', 'dd-mm-yyyy hh24:mi:ss'), to_date('26-08-2015 19:15:27', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (104, 46, 802001, 801000, '车辆编码', 205001, null, null, 1, 1, 1, 206008, '1', null, null, null, null, to_date('05-11-2015 10:05:34', 'dd-mm-yyyy hh24:mi:ss'), to_date('05-11-2015 10:06:00', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (86, 34, 802001, 801000, '提交', 205002, null, null, null, null, 2, null, null, null, null, null, null, to_date('26-08-2015 19:12:20', 'dd-mm-yyyy hh24:mi:ss'), to_date('18-09-2015 12:22:34', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (97, 43, 802001, 801000, '采购退货汇总单号', 205001, null, null, 1, 1, 1, 206013, '1', null, null, null, null, to_date('28-09-2015 17:21:36', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-09-2015 17:08:14', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (107, 46, 802001, 801000, '提交', 205002, null, null, null, null, 4, null, null, null, null, null, null, to_date('05-11-2015 10:08:09', 'dd-mm-yyyy hh24:mi:ss'), to_date('05-11-2015 10:08:09', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (105, 46, 802001, 801000, '订单编号', 205001, null, null, 1, 2, 2, 206001, '1', null, null, '1', null, to_date('05-11-2015 10:06:23', 'dd-mm-yyyy hh24:mi:ss'), to_date('05-11-2015 10:06:23', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (43, 19, 802001, 801000, '目标容器编码', 205001, null, null, 1, 1, 4, 206003, '1', 0, 0, '1', '0', to_date('23-04-2015 13:42:47', 'dd-mm-yyyy hh24:mi:ss'), to_date('02-07-2015 13:28:43', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (46, 20, 802001, 801000, '目的位置编码', 205001, null, null, 1, 1, 2, 206004, '1', 0, 0, '1', '0', to_date('23-04-2015 13:45:43', 'dd-mm-yyyy hh24:mi:ss'), to_date('07-07-2015 17:04:01', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (90, 36, 802001, 801000, '目的物流箱', 205001, null, null, 1, 1, 1, 206002, '1', null, null, null, null, to_date('27-08-2015 11:28:29', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-08-2015 10:16:29', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (98, 44, 802001, 801000, '采购退货单号', 205001, null, null, 1, 1, 1, 206014, '1', null, null, null, null, to_date('28-09-2015 17:22:12', 'dd-mm-yyyy hh24:mi:ss'), to_date('28-09-2015 17:22:12', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (31, 17, 802001, 801000, '容器编码', 205001, null, null, 1, 1, 1, 206003, '1', 0, 0, null, '0', to_date('23-04-2015 13:32:02', 'dd-mm-yyyy hh24:mi:ss'), to_date('15-10-2015 22:27:37', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (99, 44, 802001, 801000, '订单编号', 205001, null, null, 1, 2, 2, 206001, '1', null, null, '1', null, to_date('28-09-2015 17:22:40', 'dd-mm-yyyy hh24:mi:ss'), to_date('28-09-2015 17:22:40', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (100, 44, 802001, 801000, '提交', 205002, null, null, null, null, 3, null, null, null, null, null, null, to_date('28-09-2015 17:22:50', 'dd-mm-yyyy hh24:mi:ss'), to_date('28-09-2015 17:22:50', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (25, 15, 802001, 801000, '订单编号', 205001, null, null, 1, 2, 3, 206001, '1', 232040, 232042, null, '0', to_date('23-04-2015 12:05:55', 'dd-mm-yyyy hh24:mi:ss'), to_date('15-10-2015 21:48:27', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (30, 17, 802001, 801000, '配送单号', 205001, null, null, 1, 1, -1, 206009, '1', 0, 0, null, '0', to_date('23-04-2015 13:31:42', 'dd-mm-yyyy hh24:mi:ss'), to_date('15-10-2015 22:27:31', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (32, 17, 802001, 801000, '订单编号', 205001, null, null, 1, 2, 2, 206001, '1', 0, 0, null, '0', to_date('23-04-2015 13:32:21', 'dd-mm-yyyy hh24:mi:ss'), to_date('15-10-2015 22:27:49', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (33, 17, 802001, 801000, '容器位置编码', 205001, null, null, 1, 1, 3, 206004, '1', 0, 0, null, '0', to_date('23-04-2015 13:32:35', 'dd-mm-yyyy hh24:mi:ss'), to_date('15-10-2015 22:27:56', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (34, 17, 802001, 801000, '提交', 205002, null, null, 0, 1, 4, null, '0', 0, 0, null, '0', to_date('23-04-2015 13:33:18', 'dd-mm-yyyy hh24:mi:ss'), to_date('15-10-2015 22:28:03', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (77, 31, 802001, 801000, '提交', 205002, null, null, null, null, 2, null, null, null, null, null, null, to_date('23-07-2015 05:56:00', 'dd-mm-yyyy hh24:mi:ss'), to_date('23-07-2015 05:56:00', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (13, 12, 802001, 801000, '转运人工号', 205006, null, null, 1, 1, 1, null, '1', 0, 0, null, '0', to_date('23-04-2015 12:00:30', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-07-2015 20:46:04', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (4, 9, 802001, 801000, '提货单编号', 205001, null, null, 1, 1, -1, 206005, '1', 0, 0, null, '0', to_date('23-04-2015 11:25:09', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-07-2015 20:44:06', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (5, 9, 802001, 801000, '订单编号', 205001, null, null, 1, 2, 1, 206001, '1', 0, 0, '1', '0', to_date('23-04-2015 11:25:31', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-07-2015 20:44:12', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (64, 9, 802001, 801000, '提交', 205002, null, null, 0, 1, 2, null, '0', 0, 0, null, '0', to_date('23-04-2015 15:47:15', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-07-2015 20:44:19', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (96, 40, 802001, 801000, '提交', 205002, null, null, null, null, 3, null, null, null, null, null, null, to_date('28-09-2015 17:20:42', 'dd-mm-yyyy hh24:mi:ss'), to_date('28-09-2015 17:20:42', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (10, 11, 802001, 801000, '提货单号', 205001, null, null, 1, 1, -1, 206005, '1', 0, 0, null, '0', to_date('23-04-2015 11:27:31', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-07-2015 20:44:46', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (11, 11, 802001, 801000, '总件数', 205007, null, null, 1, 1, 1, null, '0', 0, 0, null, '0', to_date('23-04-2015 11:27:50', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-07-2015 20:44:52', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (12, 11, 802001, 801000, '转运人工号', 205006, null, null, 0, 1, 2, null, '0', 0, 0, null, '0', to_date('23-04-2015 11:28:03', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-07-2015 20:45:07', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (78, 11, 802001, 801000, '转运人密码', 205009, null, null, 0, 1, 3, null, '0', 0, 0, null, '0', to_date('23-04-2015 11:28:03', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-07-2015 20:45:22', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (82, 1, 802001, 801000, '物流箱编号', 205001, null, null, 0, 1, 4, 206002, '1', null, null, null, null, to_date('04-08-2015 13:51:41', 'dd-mm-yyyy hh24:mi:ss'), to_date('04-08-2015 13:52:49', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (14, 12, 802001, 801000, '提交', 205002, null, null, 0, 0, 2, null, '0', 0, 0, null, '0', to_date('23-04-2015 12:00:42', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-07-2015 20:46:31', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (79, 11, 802001, 801000, '提交', 205002, null, null, 0, 0, 4, null, '0', 0, 0, null, '0', to_date('23-04-2015 11:28:03', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-07-2015 20:46:49', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (65, 1, 802001, 801000, '订单编号', 205001, null, null, 0, 1, 1, 206001, '1', 0, 0, null, '0', to_date('23-04-2015 16:36:29', 'dd-mm-yyyy hh24:mi:ss'), to_date('04-08-2015 13:51:48', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (94, 40, 802001, 801000, '销售退货单号', 205001, null, null, 1, 1, 1, 206012, '1', null, null, null, null, to_date('28-09-2015 17:20:03', 'dd-mm-yyyy hh24:mi:ss'), to_date('28-09-2015 17:20:03', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (95, 40, 802001, 801000, '订单编号', 205001, null, null, 1, 2, 2, 206001, '1', null, null, '1', null, to_date('28-09-2015 17:20:29', 'dd-mm-yyyy hh24:mi:ss'), to_date('28-09-2015 17:20:29', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (47, 20, 802001, 801000, '目的容器编码', 205001, null, null, 1, 1, 3, 206003, '1', 0, 0, '1', '0', to_date('23-04-2015 13:46:01', 'dd-mm-yyyy hh24:mi:ss'), to_date('02-06-2015 16:14:56', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (80, 1, 802001, 801000, '容器编号', 205001, null, null, 0, 1, 2, 206003, '1', null, null, null, null, to_date('04-08-2015 13:51:41', 'dd-mm-yyyy hh24:mi:ss'), to_date('04-08-2015 13:51:41', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (44, 19, 802001, 801000, '换下一物流箱', 205002, null, null, 0, 1, 5, null, '0', 0, 0, null, '0', to_date('23-04-2015 13:42:58', 'dd-mm-yyyy hh24:mi:ss'), to_date('14-06-2015 13:44:41', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (73, 19, 802001, 801000, '提交', 205002, null, null, 0, 1, 6, null, '0', 0, 0, null, '0', to_date('23-04-2015 13:42:58', 'dd-mm-yyyy hh24:mi:ss'), to_date('14-06-2015 13:44:49', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (41, 19, 802001, 801000, '目标物流箱编码', 205001, null, null, 1, 1, 2, 206002, '1', 0, 0, null, '0', to_date('23-04-2015 13:42:15', 'dd-mm-yyyy hh24:mi:ss'), to_date('10-08-2015 17:46:08', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (48, 20, 802001, 801000, '物流箱编码', 205001, null, null, 1, 2, 4, 206002, '1', 0, 0, '1', '0', to_date('23-04-2015 13:46:17', 'dd-mm-yyyy hh24:mi:ss'), to_date('01-06-2015 15:56:00', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (81, 1, 802001, 801000, '位置编号', 205001, null, null, 0, 1, 3, 206004, '1', null, null, null, null, to_date('04-08-2015 13:51:41', 'dd-mm-yyyy hh24:mi:ss'), to_date('04-08-2015 13:52:42', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (1, 6, 802001, 801000, '提货单编号', 205001, null, null, 1, 1, 1, 206005, '1', 0, 0, null, '0', to_date('23-04-2015 10:38:26', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-04-2015 11:49:07', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (2, 6, 802001, 801000, '预计提货时间', 205005, null, '04:00', 1, 1, 2, 0, '0', 0, 0, null, '0', to_date('23-04-2015 11:08:31', 'dd-mm-yyyy hh24:mi:ss'), to_date('23-04-2015 11:08:31', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (3, 6, 802001, 801000, '提交', 205002, null, null, 0, 1, 3, 0, '0', 0, 0, null, '0', to_date('23-04-2015 11:09:10', 'dd-mm-yyyy hh24:mi:ss'), to_date('23-04-2015 11:09:10', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (52, 21, 802001, 801000, '物流箱编码', 205001, null, null, 1, 2, 3, 206002, '1', 0, 0, '2', '0', to_date('23-04-2015 13:50:11', 'dd-mm-yyyy hh24:mi:ss'), to_date('05-08-2015 06:39:42', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (6, 10, 802001, 801000, '提货汇总单号', 205001, null, null, 1, 1, 1, 206006, '1', 0, 0, null, '0', to_date('23-04-2015 11:26:06', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-04-2015 11:47:49', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (7, 10, 802001, 801000, '提货单号', 205001, null, null, 1, 1, 2, 206005, '1', 0, 0, null, '0', to_date('23-04-2015 11:26:25', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-04-2015 11:47:59', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (8, 10, 802001, 801000, '订单编号', 205001, null, null, 1, 2, 3, 206001, '1', 0, 0, null, '0', to_date('23-04-2015 11:26:45', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-04-2015 11:48:07', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (9, 10, 802001, 801000, '提交', 205002, null, null, 0, 1, 4, 0, '0', 0, 0, null, '0', to_date('23-04-2015 11:26:56', 'dd-mm-yyyy hh24:mi:ss'), to_date('23-04-2015 11:26:56', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (101, 33, 802001, 801000, '提交', 205002, null, null, null, null, 4, null, null, null, null, null, null, to_date('26-08-2015 19:15:39', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-09-2015 13:58:28', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (92, 36, 802001, 801000, '提交', 205002, null, null, null, null, 3, null, null, null, null, null, null, to_date('27-08-2015 11:29:01', 'dd-mm-yyyy hh24:mi:ss'), to_date('27-08-2015 11:29:01', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (91, 36, 802001, 801000, '订单编号', 205001, null, null, 1, 2, 2, 206001, '1', null, null, '1', null, to_date('27-08-2015 11:28:48', 'dd-mm-yyyy hh24:mi:ss'), to_date('27-08-2015 11:37:03', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (93, 37, 802001, 801000, '订单编号', 205001, null, null, 1, 1, 1, 206001, '1', null, null, null, '1', to_date('15-09-2015 22:20:39', 'dd-mm-yyyy hh24:mi:ss'), to_date('15-09-2015 22:20:39', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (15, 5, 802001, 801000, '提货汇总单号', 205001, null, null, 1, 2, 1, 206006, '1', 232023, 232024, null, '0', to_date('23-04-2015 12:01:31', 'dd-mm-yyyy hh24:mi:ss'), to_date('11-05-2015 15:53:12', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (16, 13, 802001, 801000, '供应商出库单号', 205001, null, null, 1, 1, 1, 206007, '1', 0, 0, null, '0', to_date('23-04-2015 12:01:59', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-04-2015 11:46:38', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (17, 13, 802001, 801000, '提交', 205002, null, null, 0, 1, 2, 0, '0', 0, 0, null, '0', to_date('23-04-2015 12:02:11', 'dd-mm-yyyy hh24:mi:ss'), to_date('23-04-2015 12:02:11', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (18, 14, 802001, 801000, '容器编码', 205001, null, null, 1, 1, 1, 206003, '1', 0, 0, null, '0', to_date('23-04-2015 12:02:51', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-04-2015 11:45:52', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (76, 31, 802001, 801000, '订单编号', 205001, null, null, 1, 1, 1, 206001, '1', null, null, null, null, to_date('21-07-2015 19:18:29', 'dd-mm-yyyy hh24:mi:ss'), to_date('21-07-2015 19:18:29', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (22, 14, 802001, 801000, '提交', 205002, null, null, 0, 1, 5, 0, '0', 0, 0, null, '0', to_date('23-04-2015 12:04:34', 'dd-mm-yyyy hh24:mi:ss'), to_date('23-04-2015 12:04:34', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (23, 15, 802001, 801000, '容器编码', 205001, null, null, 1, 1, 1, 206003, '1', 232041, 232042, null, '0', to_date('23-04-2015 12:05:10', 'dd-mm-yyyy hh24:mi:ss'), to_date('08-05-2015 18:16:41', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (19, 14, 802001, 801000, '容器位置编码', 205001, null, null, 1, 1, 2, 206004, '1', 0, 0, '1', '0', to_date('23-04-2015 12:03:14', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-06-2015 23:11:19', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (103, 45, 802001, 801000, '车辆编码', 205001, null, null, 1, 1, 2, 206008, '1', null, null, null, null, to_date('05-11-2015 09:26:20', 'dd-mm-yyyy hh24:mi:ss'), to_date('05-11-2015 15:58:59', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (26, 16, 802001, 801000, '容器编码', 205001, null, null, 1, 1, 1, 206003, '1', 0, 0, null, '0', to_date('23-04-2015 12:06:41', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-04-2015 12:46:43', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (27, 16, 802001, 801000, '容器位置编码', 205001, null, null, 1, 1, 2, 206004, '1', 0, 0, null, '0', to_date('23-04-2015 13:30:31', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-04-2015 12:46:54', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (28, 16, 802001, 801000, '卖家出库单号', 205001, null, null, 1, 1, 3, 206007, '1', 0, 0, null, '0', to_date('23-04-2015 13:30:47', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-04-2015 12:47:10', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (29, 16, 802001, 801000, '提交', 205002, null, null, 0, 1, 4, 0, '0', 0, 0, null, '0', to_date('23-04-2015 13:31:16', 'dd-mm-yyyy hh24:mi:ss'), to_date('23-04-2015 13:31:16', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (108, 45, 802001, 801000, '物流箱编码', 205001, null, null, 1, 2, 3, 206002, '1', null, null, null, null, to_date('05-11-2015 15:59:22', 'dd-mm-yyyy hh24:mi:ss'), to_date('05-11-2015 15:59:22', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (109, 45, 802001, 801000, '提交', 205002, null, null, null, null, 4, null, null, null, null, null, null, to_date('05-11-2015 15:59:35', 'dd-mm-yyyy hh24:mi:ss'), to_date('05-11-2015 15:59:35', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (35, 18, 802001, 801000, '原容器编码', 205001, null, null, 1, 1, 1, 206003, '1', 0, 0, null, '0', to_date('23-04-2015 13:37:36', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-04-2015 12:48:32', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (36, 18, 802001, 801000, '目标容器编码', 205001, null, null, 1, 1, 2, 206003, '1', 0, 0, null, '0', to_date('23-04-2015 13:37:55', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-04-2015 12:48:42', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (37, 18, 802001, 801000, '订单编号', 205001, null, null, 1, 2, 3, 206001, '1', 0, 0, null, '0', to_date('23-04-2015 13:38:10', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-04-2015 12:48:50', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (38, 18, 802001, 801000, '目标容器位置编码', 205001, null, null, 1, 1, 4, 206004, '1', 0, 0, null, '0', to_date('23-04-2015 13:38:40', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-04-2015 12:48:59', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (39, 18, 802001, 801000, '提交', 205002, null, null, 0, 1, 5, 0, '0', 0, 0, null, '0', to_date('23-04-2015 13:38:50', 'dd-mm-yyyy hh24:mi:ss'), to_date('23-04-2015 13:38:50', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (40, 19, 802001, 801000, '原容器编码', 205001, null, null, 1, 1, 1, 206003, '1', 0, 0, null, '0', to_date('23-04-2015 13:41:56', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-04-2015 12:49:15', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (42, 19, 802001, 801000, '订单编号', 205001, null, null, 1, 2, 3, 206001, '1', 232044, 232045, '1', '1', to_date('23-04-2015 13:42:32', 'dd-mm-yyyy hh24:mi:ss'), to_date('28-05-2015 19:32:55', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (45, 20, 802001, 801000, '容器编码', 205001, null, null, 1, 1, 1, 206003, '1', 0, 0, null, '0', to_date('23-04-2015 13:45:26', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-04-2015 12:49:57', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (49, 20, 802001, 801000, '提交', 205002, null, null, 0, 1, 5, 0, '0', 0, 0, null, '0', to_date('23-04-2015 13:46:32', 'dd-mm-yyyy hh24:mi:ss'), to_date('23-04-2015 13:46:32', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (50, 21, 802001, 801000, '车辆编码', 205001, null, null, 1, 1, 1, 206008, '1', 0, 0, null, '0', to_date('23-04-2015 13:49:39', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-04-2015 12:51:04', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (53, 21, 802001, 801000, '提交', 205002, null, null, 0, 1, 4, 0, '0', 0, 0, null, '0', to_date('23-04-2015 13:50:20', 'dd-mm-yyyy hh24:mi:ss'), to_date('23-04-2015 13:50:20', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (54, 23, 802001, 801000, '配送单号', 205001, null, null, 1, 1, 1, 206009, '1', 0, 0, null, '0', to_date('23-04-2015 13:52:12', 'dd-mm-yyyy hh24:mi:ss'), to_date('22-05-2015 09:33:01', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (56, 24, 802001, 801000, '配送单号', 205001, null, null, 1, 1, 1, 206009, '1', 0, 0, null, '0', to_date('23-04-2015 13:54:42', 'dd-mm-yyyy hh24:mi:ss'), to_date('22-05-2015 09:50:08', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (57, 24, 802001, 801000, '拒收订单编号', 205001, null, null, 1, 2, 2, 206001, '1', 0, 0, null, '0', to_date('23-04-2015 13:54:55', 'dd-mm-yyyy hh24:mi:ss'), to_date('29-04-2015 12:52:35', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (58, 24, 802001, 801000, '提交', 205002, null, null, 0, 1, 3, 0, '0', 0, 0, null, '0', to_date('23-04-2015 13:55:10', 'dd-mm-yyyy hh24:mi:ss'), to_date('23-04-2015 13:55:10', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (59, 25, 802001, 801000, '配送单号', 205001, null, null, 1, 1, 1, 206009, '1', 0, 0, null, '0', to_date('23-04-2015 13:56:47', 'dd-mm-yyyy hh24:mi:ss'), to_date('22-05-2015 09:50:21', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (60, 25, 802001, 801000, '提交', 205002, null, null, 0, 1, 2, 0, '0', 0, 0, null, '0', to_date('23-04-2015 13:56:58', 'dd-mm-yyyy hh24:mi:ss'), to_date('23-04-2015 13:56:58', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (61, 27, 802001, 801000, '配送汇总单号', 205001, null, null, 1, 1, 1, 206010, '1', 0, 0, null, '0', to_date('23-04-2015 14:52:45', 'dd-mm-yyyy hh24:mi:ss'), to_date('25-05-2015 18:30:02', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (62, 27, 802001, 801000, '提交', 205002, null, null, 0, 1, 2, 0, '0', 0, 0, null, '0', to_date('23-04-2015 14:53:23', 'dd-mm-yyyy hh24:mi:ss'), to_date('23-04-2015 14:53:23', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (66, 15, 802001, 801000, '提交', 205002, null, null, 0, 1, 4, 206001, '0', 0, 0, null, '0', to_date('12-05-2015 09:36:18', 'dd-mm-yyyy hh24:mi:ss'), to_date('12-05-2015 09:58:31', 'dd-mm-yyyy hh24:mi:ss'));
commit;
prompt 100 records committed...
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (67, 28, 802001, 801000, '车辆编码', 205001, null, null, 1, 1, 1, 206008, '1', 232048, 232049, null, '0', to_date('21-05-2015 16:19:28', 'dd-mm-yyyy hh24:mi:ss'), to_date('21-05-2015 16:19:28', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (68, 28, 802001, 801000, '提交', 205002, null, null, 0, 1, 2, 0, '0', 0, 0, null, '0', to_date('21-05-2015 16:19:49', 'dd-mm-yyyy hh24:mi:ss'), to_date('21-05-2015 16:19:49', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (69, 23, 802001, 801000, '签收码', 205006, null, null, 1, 1, 2, 0, '0', 0, 0, null, '0', to_date('22-05-2015 09:27:13', 'dd-mm-yyyy hh24:mi:ss'), to_date('22-05-2015 09:27:13', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (70, 23, 802001, 801000, '提交', 205002, null, null, 0, 1, 3, 0, '0', 0, 0, null, '0', to_date('22-05-2015 09:27:26', 'dd-mm-yyyy hh24:mi:ss'), to_date('22-05-2015 09:27:26', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (20, 14, 802001, 801000, '订单编号', 205001, null, null, 1, 1, 3, 206001, '1', 0, 0, '1', '0', to_date('23-04-2015 12:03:28', 'dd-mm-yyyy hh24:mi:ss'), to_date('18-06-2015 21:34:17', 'dd-mm-yyyy hh24:mi:ss'));
insert into YS_DOTMODULEDETAIL (dataid, parentdataid, datasctlevel, datastatus, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, istdate, uptdate)
values (75, 26, 802001, 801000, '提交', 205002, null, null, 0, 1, 3, null, '0', 0, 0, null, '0', to_date('25-05-2015 11:48:43', 'dd-mm-yyyy hh24:mi:ss'), to_date('15-06-2015 16:11:41', 'dd-mm-yyyy hh24:mi:ss'));
commit;
prompt 106 records loaded





************************************** package 部分 **************************************

  -- 库内作业: 二维码校验
  procedure SP_PDA_ServiceDO_Check(
    a_operatorID    in varchar2,
    a_operator      in varchar2,
    a_moduleID      in varchar2,
    a_seq           in integer,
    a_qrcode        in varchar2,
    a_qrcode2       in varchar2,
    a_bluetooth     in varchar2,
    a_isInput       in varchar2,
    Message         out varchar2,
    ResultCursor    out rc_class
  );
    
  -- 库内作业: 提交
  procedure SP_PDA_ServiceDO_Commit(
    a_operatorID    in varchar2,
    a_operator      in varchar2,
    a_moduleID      in varchar2,
    a_paramStr      in varchar2,
    a_spliter       in varchar2,
    a_preCount      in number,
    a_reset         in number,
    Message         out varchar2,
    ResultCursor    out rc_class
  );

  
************************************** body 部分 **************************************
  
  
  -- 库内作业: 二维码校验
  procedure SP_PDA_ServiceDO_Check(
    a_operatorID    in varchar2,
    a_operator      in varchar2,
    a_moduleID      in varchar2,
    a_seq           in integer,
    a_qrcode        in varchar2,
    a_qrcode2       in varchar2,
    a_bluetooth     in varchar2,
    a_isInput       in varchar2,
    Message         out varchar2,
    ResultCursor    out rc_class
  ) is
    a_logStr        varchar2(500);

    counter         number;
    status          number;
    v_dmName        YS_DotModule.c1%type;
    v_dmCode        YS_DotModule.c2%type;
    v_dmStatus_0    YS_DotModule.c5%type;
    v_dmStatus_1    YS_DotModule.c6%type;
    
    v_qrcode        varchar2(30);
    v_jhhzdCode     varchar2(50);
    v_jhdCode       varchar2(50);
    v_tmpCode       varchar2(50);
    v_mid           number;
    v_seq           number;
    v_tmp           varchar2(2000);
  begin
    Message := 'SUCCESS';
    if a_isInput = 1 and substr(a_qrcode,1,1)='S' then
        select 'SUCCESS'||'|'||c11||'|'||c14||F_DataParamDesc(c13) into Message from BO_Order_Goods_Ing a where substr(a.c2,2)=replace(a_qrcode,'S','');
    end if;
    
    a_logStr := '库内作业二维码校验:'||to_char(sysdate,'yyyy-mm-dd hh24:mi:ss');
    v_qrcode := trim(UPPER(a_qrcode));
    
    select count(*) into counter from YS_DotModule where dataid = a_moduleID and c4 = 130001;
    if counter = 0 then
        Message := 'DOT模块['||a_moduleID||']不存在或模块无效！';
        open ResultCursor for select Message sqlmsg from dual;
        return;
    else
      select c1,c2,c5,c6 into v_dmName,v_dmCode,v_dmStatus_0,v_dmStatus_1 from YS_DotModule where dataid = a_moduleID;
      --v_dmCode := substr(v_dmCode, instr(v_dmCode, '_')+1);
      a_logStr := a_logStr ||' ['|| v_dmCode||'] ' || v_dmName;
      
      ----P_Log(a_logStr||' begin', a_operator);
      -------------------------------------------------------------------------------------
      
      if v_dmCode = '001_CKDDXQ' then --状态查询
          ---------------------------------------------------------------------------------------------------------
          if a_seq = 1 then --订单编号
              --检验订单状态
              select count(dataid) into counter from BO_Order_Goods_Ing where substr(c2,2) = replace(v_qrcode,'S','');
              if counter = 1 then
                  select a.c22,'下单日期'||a.c26||'，'||'买家'||a.c4||'，'||'卖家'||a.c6||'，'||a.c29||'，'
                         ||a.c28||'[提货人：'||c.c4||']'||'，'||a.c30||'，'||a.c31 
                    into status,v_tmp 
                    from BO_Order_Goods_Ing a, BO_Order_Ing_THD b, BO_Order_Ing_THHZD c
                   where a.c28=b.c2 and b.c1=c.c1 and substr(a.c2,2) = replace(v_qrcode,'S','');
              else
                  select a.c22,'下单日期'||a.c26||'，'||'买家'||a.c4||'，'||'卖家'||a.c6||'，'||a.c29||'，'
                         ||a.c28||'[提货人：'||c.c4||']'||'，'||a.c30||'，'||a.c31 
                    into status,v_tmp 
                    from BO_Order_Goods_Reback a, BO_Order_Ing_THD b, BO_Order_Ing_THHZD c
                   where a.c28=b.c2 and b.c1=c.c1 and substr(a.c2,2) = replace(v_qrcode,'S','');
              end if;
              if status is not null then
                  Message := '订单['||v_qrcode||'] 状态['||F_DataParamDesc(status)||']，'||v_tmp;
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
          elsif a_seq = 2 then --容器编号
              select count(*),max(c4),max(c5) into counter, status, v_tmpCode from YS_Container where c1=v_qrcode;
              if counter = 0 then
                  Message := '容器['||v_qrcode||']不存在！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              else
                  Message := '容器['||v_qrcode||'] 位置['||v_tmpCode||'] 状态['||F_DataParamDesc(status)||']';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;                
              end if;
              
          elsif a_seq = 3 then --位置编号
              select count(*),max(c4),max(c5) into counter, status, v_tmp from YS_Place where c1=v_qrcode;
              if counter = 0 then
                  Message := '位置['||v_qrcode||']不存在！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              else
                  Message := '位置['||v_qrcode||'] 所装容器['||v_tmp||'] 状态['||F_DataParamDesc(status)||']';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;                
              end if;
              
          elsif a_seq = 4 then --物流箱编号
              select count(*),max(c4),max(c5) into counter, status, v_tmpCode from YS_Package where c1=v_qrcode;
              if counter = 0 then
                  Message := '物流箱['||v_qrcode||']不存在！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              else
                  select count(*),NVL(max(c5),'') into counter, v_tmp from YS_Container where c1=v_tmpCode;
                  Message := '物流箱['||v_qrcode||'] 位置['||v_tmp||'] 所在容器['||v_tmpCode||'] 状态['||F_DataParamDesc(status)||']';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;                
              end if;

          end if;
          ---------------------------------------------------------------------------------------------------------
      
      elsif v_dmCode = '002_FPTHLX' then --分配提货路线
          null;
          
      elsif v_dmCode = '003_THDDY' then --提货单打印
          null;
          
      elsif v_dmCode = '004_DDBQDY' then --订单标签打印
          null;
      
      elsif v_dmCode = '005_THDFP' then --提货单分配
          ---------------------------------------------------------------------------------------------------------
          if a_seq = 1 then --提货汇总单号
              --检验有效性
              select count(*),max(c10),max(c2),max(c4) into counter,status,v_tmpCode,v_tmp from BO_Order_Ing_THHZD where c1=v_qrcode;
              if counter = 0 then
                  Message := '提货汇总单['||v_qrcode||']不存在！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验大客户
              if to_number(v_tmpCode) < 0 then
                  Message := '提货汇总单['||v_qrcode||']为大客户，请分派提货车辆！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验有效性
              if v_tmp is not null then
                  Message := '提货汇总单['||v_qrcode||']已分配给['||v_tmp||']！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> v_dmStatus_0 then
                  Message := '提货汇总单['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              --更新提货汇总单状态
              insert into ZBO_Order_Ing_THHZD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_THHZD where c1=v_qrcode) t0;
              update BO_Order_Ing_THHZD set c10=v_dmStatus_1, c3=a_operatorID, c4=a_operator, uptdate=sysdate where c1=v_qrcode;
              --更新提货单状态
              insert into ZBO_Order_Ing_THD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_THD where c1=v_qrcode) t0;
              update BO_Order_Ing_THD set c10=v_dmStatus_1, uptdate=sysdate where c1=v_qrcode;
              --更新订单状态
              insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing t where c22 = v_dmStatus_0
                 and exists (select a.dataid from BO_Order_Ing_THHZD a, BO_Order_Ing_THD b where a.c1=b.c1 and b.c2=t.c28 and a.c1=v_qrcode)) t0;
              update BO_Order_Goods_Ing t set c22=v_dmStatus_1, c29='提货单分配', uptdate=sysdate 
               where c22 = v_dmStatus_0
                 and exists (select a.dataid from BO_Order_Ing_THHZD a, BO_Order_Ing_THD b where a.c1=b.c1 and b.c2=t.c28 and a.c1=v_qrcode);
              
              Message := '提货汇总单['||v_qrcode||']分配成功。';
          end if;
          ---------------------------------------------------------------------------------------------------------
      
      elsif v_dmCode = '006_THDFF' then --提货单发放
          ---------------------------------------------------------------------------------------------------------
          if a_seq = 1 then --提货单号
              --检验有效性
              select count(*),max(c10) into counter,status from BO_Order_Ing_THD where c2=v_qrcode;
              if counter = 0 then
                  Message := '提货单['||v_qrcode||']不存在！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> v_dmStatus_0 then
                  Message := '提货单['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验提货人
              select distinct a.c3 into v_tmp from BO_Order_Ing_THHZD a,BO_Order_Ing_THD b where a.c1=b.c1 and b.c2 = v_qrcode;
              if v_tmp <> a_operatorID then
                  Message := '提货单['||v_qrcode||']不该由你发放！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
          end if;
          ---------------------------------------------------------------------------------------------------------
      
      elsif v_dmCode = '007_MJBH' then --卖家备货
          null;
      
      elsif v_dmCode = '008_MJFH' then --卖家发货
          null;
          
      elsif v_dmCode = '031_SPBQ' then --商品报缺
          ---------------------------------------------------------------------------------------------------------
          if a_seq = 1 then --订单编号
              --检验有效性
              select count(*),max(c22) into counter, status from BO_Order_Goods_Ing where substr(c2,2)=replace(v_qrcode,'S','');
              if counter = 0 then
                  Message := Message||'订单['||v_qrcode||']无效！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验订单状态
              if status > 232040 or status = v_dmStatus_1 then --准备入库之前的订单
                  Message := '订单['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
          end if;
          ---------------------------------------------------------------------------------------------------------
      
      elsif v_dmCode = '009_TH' then --提货   --2015-07-28 wxl 更改提货流程
          ---------------------------------------------------------------------------------------------------------          
          if a_seq = 1 then --订单编号
              --检验有效性
              select count(*),max(c22),max(c28) into counter,status,v_tmp from BO_Order_Goods_Ing where substr(c2,2)=replace(v_qrcode,'S','');
              if counter = 0 then
                  Message := Message||'订单['||v_qrcode||']无效！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              if status <> v_dmStatus_0 and status <> 232031 then
                  Message := '订单['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验提货人
              select count(*) into counter from BO_Order_Ing_THD a, BO_Order_Ing_THHZD b where a.c1=b.c1 and a.c2=v_tmp and b.c3=a_operatorID;
              if counter = 0 then
                  Message := '订单['||v_qrcode||']不属于提货人['||a_operator||']！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
          end if;
          ---------------------------------------------------------------------------------------------------------
      
      elsif v_dmCode = '010_THZ' then --提货（直接供应商）
          null;          
      
      elsif v_dmCode = '011_THZY' then --提货转运
          null;
        
      elsif v_dmCode = '012_RKXH' then --入库卸货
          null;
      
      elsif v_dmCode = '013_RKXHZ' then --入库卸货（直接供应商）
          null;
      
      elsif v_dmCode = '014_RKZJ' then --入库质检
          ---------------------------------------------------------------------------------------------------------
          if a_seq = 1 then --容器编码
              --检验有效性
              select count(*),max(c4) into counter,status from YS_Container where c1=v_qrcode;
              if counter <> 1 then
                  Message := '容器['||v_qrcode||']不可用！counter='||counter;
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> 0 and status <> v_dmStatus_1 then
                  Message := '容器['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
          elsif a_seq = 2 then --位置编码
              --检验有效性
              select count(*),max(c4),max(c5) into counter,status,v_tmp from YS_Place where c1=v_qrcode and c2<>2;
              if counter = 0 then
                  Message := '位置['||v_qrcode||']不可用！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> 0 and status <> v_dmStatus_1  then
                  Message := '位置['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status = v_dmStatus_1 and v_tmp <> a_qrcode2 then
                  Message := '位置['||v_qrcode||']不可用！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检查容器位置
              select count(*),max(c4),max(c5) into counter,status,v_tmp from YS_Container where c1=a_qrcode2;
              if status > 0 and v_tmp <> v_qrcode then
                  Message := '容器'||a_qrcode2||'与位置['||v_qrcode||']不符，应'||v_tmp||'！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
          elsif a_seq = 3 then --订单编号
              --检验有效性
              select count(*),max(c22) into counter, status from BO_Order_Goods_Ing where substr(c2,2)=replace(v_qrcode,'S','');
              if counter = 0 then
                  Message := Message||'订单['||v_qrcode||']无效！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验订单状态
              if status <> v_dmStatus_0 and status <> 232039 then --232039：入库协调
                  Message := '订单['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验订单所在容器
              select count(*),max(c6) into counter,v_tmp from BO_Order_Ing_QC where c1=v_qrcode and c6<>a_qrcode2 and c5=1;
              if counter > 0 then
                  Message := '错误，请将订单['||v_qrcode||']放回容器['||v_tmp||']！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
          end if;
          ---------------------------------------------------------------------------------------------------------              
      
      elsif v_dmCode = '015_RKSH' then --入库收货
          ---------------------------------------------------------------------------------------------------------
          if a_seq = 1 then --容器编码
              --检验有效性
              select count(*),max(c4) into counter,status from YS_Container where c1=v_qrcode;
              if counter <> 1 then
                  Message := Message||'容器['||v_qrcode||']不可用！counter='||counter;
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> v_dmStatus_0 then -- and status <> v_dmStatus_1 20150627 只允许一次性提交 wxl chen
                  Message := '容器['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
          elsif a_seq = 2 then --位置编码
              --检验有效性
              select count(*),max(c4),max(c5) into counter,status,v_tmp from YS_Place where c1=v_qrcode and c2<>2;
              if counter = 0 then
                  Message := Message||'位置['||v_qrcode||']不可用！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> v_dmStatus_0 then -- and status <> v_dmStatus_1 20150627 只允许一次性提交 wxl chen
                  Message := '位置['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验容器
              if v_tmp <> a_qrcode2 then
                  Message := '位置['||v_qrcode||']与容器['||a_qrcode2||']不匹配！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
          elsif a_seq = 3 then --订单编号
              --检验有效性
              select count(*),max(c22) into counter, status from BO_Order_Goods_Ing where substr(c2,2)=replace(v_qrcode,'S','');
              if counter = 0 then
                  Message := Message||'订单['||v_qrcode||']无效！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验订单状态
              if status <> v_dmStatus_0 then
                  Message := '订单['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
          end if;
          --------------------------------------------------------------------------------------------------------- 
      
      elsif v_dmCode = '016_RKSHZ' then --入库收货（直接供应商）
          null;
      
      elsif v_dmCode = '017_JSRK' then --拒收入库
          ---------------------------------------------------------------------------------------------------------
          /*if a_seq = 1 then --配送单号
              --检验有效性
              select count(*),max(c10) into counter,status from BO_Order_Ing_PSD where c2 = v_qrcode;
              if counter <> 1 then
                  Message := '配送单['||v_qrcode||']不可用！counter='||counter;
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              /*--检验状态
              if status <> v_dmStatus_0 then
                  Message := '配送单['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;*/
          if a_seq = 1 then --容器编码
              --检验有效性
              select count(*),max(c4) into counter,status from YS_Container where c1=v_qrcode;
              if counter <> 1 then
                  Message := '容器['||v_qrcode||']不可用！counter='||counter;
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> 0 then
                  Message := '容器['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
          elsif a_seq = 2 then --订单编号
              --检验有效性
              select count(*),max(c22),max(c4),max(c31) into counter, status, v_mid, v_tmpCode from BO_Order_Goods_Reback where substr(c2,2)=replace(v_qrcode,'S','');
              if counter = 0 then
                  Message := Message||'订单['||v_qrcode||']无效！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验订单状态
              if status <> v_dmStatus_0 then
                  Message := '订单['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
          elsif a_seq = 3 then --位置编码
              --检验有效性
              select count(*),max(c4) into counter,status from YS_Place where c1=v_qrcode and c2<>2;
              if counter = 0 then
                  Message := Message||'位置['||v_qrcode||']不可用！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> 0 then
                  Message := '位置['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
          end if;
          --------------------------------------------------------------------------------------------------------- 
      
      elsif v_dmCode = '018_BCFJ' then --波次分拣
          ---------------------------------------------------------------------------------------------------------
          if a_seq = 1 then --原容器编码
              --检验有效性
              select count(*),max(c4) into counter,status from YS_Container where c1=v_qrcode;
              if counter <> 1 then
                  Message := Message||'容器['||v_qrcode||']不可用！counter='||counter;
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> v_dmStatus_0 then
                  Message := '原容器编码['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;

              select count(distinct c.c2) into counter from BO_Order_Goods_Ing a, YS_Container b, BO_Order_Ing_JHD c where a.c30=c.c1 and a.c3=c.c3 and b.c6 like '%'||a.c2||'%' and b.c1=v_qrcode;
              Message := counter;
              P_Log(a_logStr||' '||Message, a_operator);
              
          elsif a_seq = 2 then --目标容器编码
              --检验有效性
              select count(*),max(c4) into counter,status from YS_Container where c1=v_qrcode;
              if counter <> 1 then
                  Message := Message||'容器['||v_qrcode||']不可用！counter='||counter;
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> 0 then
                  Message := '目标容器编码['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
          elsif a_seq = 3 then --订单编号
              --检验有效性
              select count(*),max(c22) into counter, status from BO_Order_Goods_Ing where substr(c2,2)=replace(v_qrcode,'S','');
              if counter = 0 then
                  Message := Message||'订单['||v_qrcode||']无效！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> v_dmStatus_0 then
                  Message := '订单['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              select count(*) into counter from YS_Container where c1 = a_qrcode2 and instr(c6,v_qrcode)>0;
              if counter = 0 then
                  Message := '订单['||v_qrcode||']不属于此分拣容器！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              select b.c2 into v_jhdcode from BO_Order_Goods_Ing a, BO_Order_Ing_JHD b where a.c30=b.c1 and a.c3=b.c3 and a.c25=b.c9 and substr(a.c2,2)=replace(v_qrcode,'S','');
              select ','||c11 into v_tmp from YS_Container where c1 = a_qrcode2;
              --取得目标容器序号
              v_seq := length(replace(translate(substr(v_tmp,1,instr(v_tmp,','||v_jhdcode||',')), 'JHABC-0123456789', ' '),' ',''));
              v_tmp := '请放进第 '||v_seq||' 个容器';
              Message := replace(Message, 'SUCCESS', v_tmp);
          /*    
          elsif a_seq = 4 then --位置编码
              --检验有效性
              select count(*),max(c4) into counter,status from YS_Place where c1=v_qrcode and c2<>2;
              if counter = 0 then
                  Message := Message||'位置['||v_qrcode||']不可用！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> 0 then
                  Message := '位置['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;*/
              
          else
            
              Message := '校验成功';
          end if;
          
          ---------------------------------------------------------------------------------------------------------
          
      elsif v_dmCode = '019_ZX' then --装箱
          ---------------------------------------------------------------------------------------------------------
          if a_seq = 1 then --原容器编码
              --检验有效性
              select count(*),max(c4) into counter,status from YS_Container where c1=v_qrcode;
              if counter <> 1 then
                  Message := '原容器['||v_qrcode||']不可用！counter='||counter;
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> v_dmStatus_0 then
                  Message := '原容器['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
          elsif a_seq = 2 then --物流箱编码
              --检验有效性
              select count(*),max(c4) into counter, status from YS_Package where c1=v_qrcode;
              if counter = 0 then
                  Message := '物流箱['||a_qrcode||']无效！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> 0 then -- or status=v_dmStatus_1 del by wxl 20150616 chen
                  Message := '物流箱['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
          elsif a_seq = 3 then --订单编号              
              v_qrcode := replace(a_qrcode,'S','');
              --检验有效性
              select count(a.dataid),max(a.c22),max(b.c18) into counter, status, v_tmp from BO_Order_Goods_Ing a, A_Goods_PS b where a.c10=b.dataid and substr(a.c2,2)=v_qrcode;
              if counter = 0 then
                  Message := '订单['||a_qrcode||']无效！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> v_dmStatus_0 then
                  Message := '订单['||a_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;              
              if to_number(v_tmp)=1 and (a_bluetooth is null or a_bluetooth = 0) then
                  Message := '蓝牙称重无效，请检查！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
                      
              --检验订单与原容器
              select count(dataid) into counter from YS_Container where c1=a_qrcode2 and instr(c6,a_qrcode)>0;
              if counter = 0 then
                  Message := '订单'||a_qrcode||'与原容器'||a_qrcode2||'不匹配！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              --蓝牙称重
              if a_bluetooth is not null then
                update BO_Order_Goods_Ing set c40=a_bluetooth where substr(c2,2) = v_qrcode;
              end if;
              
          elsif a_seq = 4 then --目标容器
              --检验状态
              select count(*),max(c4) into counter,status from YS_Container where c1=v_qrcode;
              if counter <> 1 then
                  Message := '目标容器['||v_qrcode||']不可用！counter='||counter;
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> 0 and status <> v_dmStatus_1 then
                  Message := '目标容器['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检查原容器所属买家 --mid 集货单
              select c9,c11 into v_mid,v_jhdCode from YS_Container where c1=a_qrcode2;
              select c1 into v_jhhzdCode from BO_Order_Ing_JHD where c2=v_jhdCode;
              select count(dataid) into counter from YS_Container where c1=v_qrcode and (c9 is null or c9=to_char(v_mid) and c11=v_jhhzdCode);
              if counter = 0 then
                  Message := '目标容器与订单不匹配！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
          end if;
          ---------------------------------------------------------------------------------------------------------
          
      elsif v_dmCode = '020_KNJH' then --库内集货
          ---------------------------------------------------------------------------------------------------------
          if a_seq = 1 then --原容器编码
              --检验有效性
              select count(*),max(c4),max(c9),max(c11) into counter,status,v_mid,v_jhhzdCode from YS_Container where c1=v_qrcode;
              if counter <> 1 then
                  Message := '容器['||v_qrcode||']不可用！counter='||counter;
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> v_dmStatus_0 then
                  Message := '原容器['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              --检查是否已存在该买家的区
              select count(*) into counter from YS_Place where c2=2 and c6=v_mid and c7=v_jhhzdCode;
              if counter > 0 then
                select '请到通道区'||substr(c1,3) into Message from YS_Place where c2=2 and c6=v_mid and c7=v_jhhzdCode;
              else
                
                --检查买家是否配置了配送区域序号
                select c15 into v_seq from BO_Order_Ing_JHD where c1=v_jhhzdCode and c4=v_mid;
                if v_seq is null then
                  Message := '买家[编号'||v_mid||']未配置区域配送序号！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
                end if;
                
                --检查是否已分配通道  [v_tmp暂存通道号]
                select count(*),max(c8) into counter,v_tmp from YS_Place where c2=2 and c7=v_jhhzdCode;
                if counter > 0 then  --当集货汇总单已存在通道
                  select count(*) into counter from YS_Place where c2=2 and c9=v_seq and c7=v_jhhzdCode;
                  if counter = 0 then
                    Message := '买家[编号'||v_mid||']的配送序号['||v_seq||']太大！';
                    P_Log(a_logStr||' '||Message, a_operator);
                    open ResultCursor for select Message sqlmsg from dual;
                    return;
                  end if;
                  insert into ZYS_Place select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Place where c2=2 and c9=v_seq and c7=v_jhhzdCode) t0;
                  update YS_Place set c6=v_mid,uptdate=sysdate where c2=2 and c9=v_seq and c7=v_jhhzdCode;
                  select '请到通道'||substr(c1,3) into Message from YS_Place where c2=2 and c9=v_seq and c7=v_jhhzdCode;
                else
                  
                  --分配新的通道
                  select count(*) into counter from YS_Place where c2=2 and c7 is null;
                  if counter = 0 then
                    Message := '当前没有空闲通道';
                  else
                    --集货汇总单所需的位置数目
                    select max(c15) into v_tmp from BO_Order_Ing_JHD where c1=v_jhhzdCode;
                    select count(count(*)) into counter from YS_Place where c2=2 and c7 is null group by c8 having count(*)>=to_number(v_tmp);
                    if counter = 0 then
                      select c8 into v_tmpCode from (select c8,count(*) from YS_Place where c2=2 and c7 is null group by c8 order by 2,1 desc) t where rownum=1;
                    else
                      select c8 into v_tmpCode from (select c8,count(*) from YS_Place where c2=2 and c7 is null group by c8 having count(*)>=to_number(v_tmp) order by 2,1) t where rownum=1;
                    end if;
                    
                    select min(c1) into Message from YS_Place where c2=2 and c7 is null and c8=v_tmpCode and c9=v_seq;
                    insert into ZYS_Place select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Place where c1=Message) t0;
                    update YS_Place set c6=v_mid,uptdate=sysdate where c1=Message;
                    insert into ZYS_Place select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Place where c2=2 and c8 = (select c8 from YS_Place where c1=Message)) t0;
                    update YS_Place set c7=v_jhhzdCode,uptdate=sysdate where c2=2 and c8 = (select c8 from YS_Place where c1=Message);
                    Message := '请到通道'||substr(Message,3)||'.';
                  end if;
                
                end if;
              end if;
          elsif a_seq = 2 then --目标位置
              --检验有效性
              select count(*),max(c4) into counter,status from YS_Place where c1=v_qrcode and c2=2;
              if counter = 0 then
                  Message := '位置['||v_qrcode||']不可用！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              --原容器的mid
              select c9,c11 into v_mid,v_jhhzdCode from YS_Container where c1=a_qrcode2;
              
              --检查位置是否正确
              select c1 into v_tmp from YS_Place where c2=2 and c6=v_mid and c7=v_jhhzdCode;
              if v_tmp <> v_qrcode then
                  Message := '位置'||v_qrcode||'不正确！应'||v_tmp;
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
          elsif a_seq = 3 then --目标容器
              --检验有效性
              select count(*),max(c4) into counter,status from YS_Container where c1=v_qrcode;
              if counter <> 1 then
                  Message := '容器['||v_qrcode||']不可用！counter='||counter;
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;

              if v_qrcode <> a_qrcode2 then                
                --检验状态
                if status <> 0 and status <> v_dmStatus_1 then
                    Message := '目标容器['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                    P_Log(a_logStr||' '||Message, a_operator);
                    open ResultCursor for select Message sqlmsg from dual;
                    return;
                end if;
                
                --原容器的mid,集货汇总单
                select c9,c11 into v_mid,v_jhhzdCode from YS_Container where c1=a_qrcode2;              
                --检查目标容器是否正确
                select count(*) into counter from YS_Container where c1=v_qrcode and (c9 is null or c9=v_mid and c11=v_jhhzdCode);
                if counter = 0 then
                    Message := '目标容器'||v_qrcode||'与原容器买家/集货单不匹配！';
                    P_Log(a_logStr||' '||Message, a_operator);
                    open ResultCursor for select Message sqlmsg from dual;
                    return;
                end if;
              end if;
              
          elsif a_seq = 4 then --物流箱
              --检验有效性
              select count(*),max(c4),max(c5) into counter,status,v_tmp from YS_Package where c1=v_qrcode;
              if counter = 0 then
                  Message := '物流箱['||v_qrcode||']无效！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> v_dmStatus_0 then
                  Message := '物流箱['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检查物流箱是否正确
              if v_tmp <> a_qrcode2 then
                  Message := '物流箱'||v_qrcode||'属于容器'||v_tmp||'，与原容器'||a_qrcode2||'不匹配！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
          end if;
          ---------------------------------------------------------------------------------------------------------
          
      elsif v_dmCode = '036_PX' then --拼箱
          ---------------------------------------------------------------------------------------------------------
          if a_seq = 1 then --物流箱编码
              --检验有效性
              select count(*),max(c4) into counter, status from YS_Package where c1=v_qrcode and c2<>9;
              if counter = 0 then
                  Message := '物流箱['||v_qrcode||']无效！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> v_dmStatus_0 then
                  Message := '物流箱['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
      
          elsif a_seq = 2 then --订单编号
              --检验有效性
              select count(*),max(c22),max(c4),max(c30) into counter, status, v_mid, v_jhhzdCode from BO_Order_Goods_Ing where substr(c2,2)=replace(v_qrcode,'S','');
              if counter = 0 then
                  Message := '订单['||v_qrcode||']无效！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> v_dmStatus_0 then
                  Message := '订单['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检查物流箱
              select count(*),max(c2),max(c6) into counter,v_seq,v_tmp from YS_Package where c1=a_qrcode2 and c7=v_mid and c8=v_jhhzdCode;
              if counter = 0 then
                  Message := '订单与目的物流箱不同买家或集货单！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              if instr(v_tmp,v_qrcode)>0 then
                  Message := '订单已在目的物流箱中！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              select c2 into v_mid from YS_Package where instr(c6,v_qrcode)>0;
              if v_mid <> v_seq then
                  Message := '订单原物流箱与目的物流箱类型不同！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
          
          end if;
          ---------------------------------------------------------------------------------------------------------
      
      elsif v_dmCode = '021_ZBCK' then --发货（出库）
          ---------------------------------------------------------------------------------------------------------
          if a_seq = 1 then --车辆编码
              --检验有效性
              select count(*),max(c4) into counter,status from YS_Car where c1=v_qrcode;
              if counter <> 1 then
                  Message := '车辆['||v_qrcode||']不可用！counter='||counter;
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> v_dmStatus_1 and status <> 0 then
                  Message := '车辆['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              --检查车辆
              select count(*),max(c1) into counter,v_tmp from BO_Order_Ing_JHHZD where (c2<>9 and c2<232048) and instr(','||c8,v_qrcode)>0;
              if counter = 0 then
                  Message := '车辆['||v_qrcode||']没有装载任务';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              select count(*) into counter from YS_Place where c2=2 and c7 in (select c1 from BO_Order_Ing_JHHZD where (c2<>9 and c2<232048) and instr(','||c8,v_qrcode)>0);
              if counter = 0 then
                  Message := '车辆['||v_qrcode||']所要装载的商品还未集货，请等待';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              select count(*),min(c8) into counter,Message from YS_Place where c2=2 and c7 in (select c1 from BO_Order_Ing_JHHZD where c2=232046 and instr(','||c8,v_qrcode)>0);
              if counter = 0 then
                  Message := '通道还未集完货，请等待';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              Message := '请到通道'||Message||'取货';
              
          elsif a_seq = 2 then --原容器编码
              --检验有效性
              select count(*),max(c4),max(c10),max(c11) into counter,status,v_seq,v_tmp from YS_Container where c1=v_qrcode;
              if counter = 0 then
                  Message := '容器['||v_qrcode||']不可用！counter='||counter;
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> v_dmStatus_0 then
                  Message := '原容器['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检查容器的集货完成状态   --//////////////////////////////20150722 锟 注释掉，允许上车 20150813 取消注释 陈总不同意
              if v_seq <> 1 then
                  Message := '容器['||v_qrcode||']集货还未完成！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检查集货汇总单是否派给了车
              select count(*) into counter from BO_Order_Ing_JHHZD where c1=v_tmp and instr(','||c8,a_qrcode2)>0;
              if counter = 0 then
                  Message := '容器['||v_qrcode||']与车辆'||a_qrcode2||'不匹配！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
          elsif a_seq = 3 then --物流箱
              --检验有效性
              select count(*),max(c4),max(c5) into counter,status,v_tmp from YS_Package where c1=v_qrcode;
              if counter = 0 then
                  Message := '物流箱['||v_qrcode||']无效！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> v_dmStatus_0 then
                  Message := '物流箱['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检查物流箱是否正确
              if v_tmp <> a_qrcode2 then
                  Message := '物流箱'||v_qrcode||'属于容器'||v_tmp||'，与原容器'||a_qrcode2||'不匹配！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              
          end if;
          ---------------------------------------------------------------------------------------------------------
          
      elsif v_dmCode = '028_PSDSC' then --出库单生成
          ---------------------------------------------------------------------------------------------------------
          if a_seq = 1 then --车辆编码
              --检验有效性
              select count(*),max(c4) into counter,status from YS_Car where c1=v_qrcode;
              if counter <> 1 then
                  Message := '车辆['||v_qrcode||']不可用！counter='||counter;
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> v_dmStatus_0 then
                  Message := '车辆['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
          end if;
          ---------------------------------------------------------------------------------------------------------
      
      elsif v_dmCode = '022_PSDDY' then --配送单打印
          ---------------------------------------------------------------------------------------------------------
          if a_seq = 1 then --车辆编码
              --检验有效性
              select count(*),max(c4) into counter,status from YS_Car where c1=v_qrcode;
              if counter <> 1 then
                  Message := '车辆['||v_qrcode||']不可用！counter='||counter;
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;

              --检验状态
              if status <> v_dmStatus_0 then
                  Message := '车辆['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
          end if;
          ---------------------------------------------------------------------------------------------------------
      
      elsif v_dmCode = '023_KHQS' then --客户签收
          ---------------------------------------------------------------------------------------------------------
          if a_seq = 1 then --配送单号
              --检验有效性
              select count(*),max(c10) into counter,status from BO_Order_Ing_PSD where c2 = v_qrcode;
              if counter <> 1 then
                  Message := '配送单['||v_qrcode||']不可用！counter='||counter;
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> v_dmStatus_0 then
                  Message := '配送单['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
          end if;
          ---------------------------------------------------------------------------------------------------------
      
      elsif v_dmCode = '024_KHBFQS' then --客户部分拒收
          ---------------------------------------------------------------------------------------------------------
          if a_seq = 1 then --配送单号
              --检验有效性
              select count(*),max(c10) into counter,status from BO_Order_Ing_PSD where c2 = v_qrcode;
              if counter <> 1 then
                  Message := '配送单['||v_qrcode||']不可用！counter='||counter;
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> v_dmStatus_0 then
                  Message := '配送单['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
          
          elsif a_seq = 2 then --订单编号
              --检验有效性
              select count(*),max(c22),max(c4),max(c31) into counter, status, v_mid, v_tmpCode from BO_Order_Goods_Ing where substr(c2,2)=replace(v_qrcode,'S','');
              if counter = 0 then
                  Message := '订单['||v_qrcode||']无效！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> v_dmStatus_0 then
                  Message := '订单['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              select count(*) into counter from BO_Order_Ing_PSD where c1=v_tmpCode and c2 = a_qrcode2 and c4=v_mid;
              if counter = 0 then
                  Message := '订单['||v_qrcode||']与配送单['||a_qrcode2||']不匹配！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
          end if;
          ---------------------------------------------------------------------------------------------------------
      
      elsif v_dmCode = '025_KHQBJS' then --客户全部拒收
          ---------------------------------------------------------------------------------------------------------
          if a_seq = 1 then --配送单号
              --检验有效性
              select count(*),max(c10) into counter,status from BO_Order_Ing_PSD where c2 = v_qrcode;
              if counter <> 1 then
                  Message := '配送单['||v_qrcode||']不可用！counter='||counter;
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> v_dmStatus_0 then
                  Message := '配送单['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
          end if;
          ---------------------------------------------------------------------------------------------------------
      elsif v_dmCode = '033_THRK' then --退货入库
          ---------------------------------------------------------------------------------------------------------
          if a_seq = 1 then --容器编码
              --检验有效性
              select count(*),max(c4) into counter,status from YS_Container where c1=v_qrcode;
              if counter <> 1 then
                  Message := '容器['||v_qrcode||']不可用！counter='||counter;
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> 0 then
                  Message := '容器['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
          elsif a_seq = 2 then --订单编号
              --检验有效性
              select count(*),max(c22) into counter, status from BO_Order_Goods_Reback where substr(c2,2)=replace(v_qrcode,'S','');
              if counter = 0 then
                  Message := Message||'订单['||v_qrcode||']无效！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验订单状态
              if status <> v_dmStatus_0 then
                  Message := '订单['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
                
          elsif a_seq = 3 then --位置编码
              --检验有效性
              select count(*),max(c4) into counter,status from YS_Place where c1=v_qrcode and c2<>2;
              if counter = 0 then
                  Message := Message||'位置['||v_qrcode||']不可用！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> 0 then
                  Message := '位置['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
          end if;
          ---------------------------------------------------------------------------------------------------------
      
      elsif v_dmCode = '040_TQMJTH' then --提取买家退货
          ---------------------------------------------------------------------------------------------------------
          if a_seq = 1 then --销售退货单号
              --检验有效性
              select count(*),max(c10) into counter,status from BO_Order_Reback_THD where c2 = v_qrcode;
              if counter <> 1 then
                  Message := '销售退货单['||v_qrcode||']不可用！counter='||counter;
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> v_dmStatus_0 then
                  Message := '销售退货单['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
          
          elsif a_seq = 2 then --订单编号
              --检验有效性
              select count(*),max(c22),max(c4),max(c45) into counter, status, v_mid, v_tmpCode from BO_Order_Goods_Reback where substr(c2,2)=replace(v_qrcode,'S','');
              if counter = 0 then
                  Message := '订单['||v_qrcode||']无效！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> v_dmStatus_0 then
                  Message := '订单['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              select count(*) into counter from BO_Order_Reback_THD where c1=v_tmpCode and c2 = a_qrcode2 and c4=v_mid;
              if counter = 0 then
                  Message := '订单['||v_qrcode||']与销售退货单['||a_qrcode2||']不匹配！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if; 
          end if;
          ---------------------------------------------------------------------------------------------------------
      
      elsif v_dmCode = '043_CGTHDFP' then --采购退货单分配
          ---------------------------------------------------------------------------------------------------------
          if a_seq = 1 then --采购退货汇总单号
              --检验有效性
              select count(*),max(c10),max(c4) into counter,status,v_tmp from BO_Order_SReback_THHZD where c1=v_qrcode;
              if counter = 0 then
                  Message := '采购退货汇总单['||v_qrcode||']不存在！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验有效性
              if v_tmp is not null then
                  Message := '采购退货汇总单['||v_qrcode||']已分配给['||v_tmp||']！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> v_dmStatus_0 then
                  Message := '采购退货汇总单['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              --更新采购退货汇总单状态
              insert into ZBO_Order_SReback_THHZD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_SReback_THHZD where c1=v_qrcode) t0;
              update BO_Order_SReback_THHZD set c10=v_dmStatus_1, c3=a_operatorID, c4=a_operator, uptdate=sysdate where c1=v_qrcode;
              --更新采购退货单状态
              insert into ZBO_Order_SReback_THD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_SReback_THD where c1=v_qrcode) t0;
              update BO_Order_SReback_THD set c10=v_dmStatus_1, uptdate=sysdate where c1=v_qrcode;
              --更新退单状态
              insert into ZBO_Order_Goods_Reback select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Reback t where c22 = v_dmStatus_0
                 and exists (select a.dataid from BO_Order_SReback_THHZD a, BO_Order_SReback_THD b where a.c1=b.c1 and b.c2=t.c46 and a.c1=v_qrcode)) t0;
              update BO_Order_Goods_Reback t set c22=v_dmStatus_1, c29='采购退货单分配', uptdate=sysdate 
               where c22 = v_dmStatus_0
                 and exists (select a.dataid from BO_Order_SReback_THHZD a, BO_Order_SReback_THD b where a.c1=b.c1 and b.c2=t.c46 and a.c1=v_qrcode);
              --更新订单状态
              insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing t where c22 = v_dmStatus_0
                 and exists (select a.dataid from BO_Order_SReback_THHZD a, BO_Order_SReback_THD b where a.c1=b.c1 and b.c2=t.c46 and a.c1=v_qrcode)) t0;
              update BO_Order_Goods_Ing t set c22=v_dmStatus_1, c29='采购退货单分配', uptdate=sysdate 
               where c22 = v_dmStatus_0
                 and exists (select a.dataid from BO_Order_SReback_THHZD a, BO_Order_SReback_THD b where a.c1=b.c1 and b.c2=t.c46 and a.c1=v_qrcode);
              
              Message := '采购退货汇总单['||v_qrcode||']分配成功。';
          end if;
          ---------------------------------------------------------------------------------------------------------

      elsif v_dmCode = '026_ZZXHS' then --周转箱回收
          ---------------------------------------------------------------------------------------------------------
          if a_seq = 1 then
              --检验有效性
              select count(*),max(c4) into counter,status from YS_Car where c1 = v_qrcode;
              if counter <> 1 then
                  Message := '车辆['||v_qrcode||']不可用！counter='||counter;
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              /*--检验状态
              if status <> 0 then
                  Message := '车辆['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;*/
            
          elsif a_seq = 2 then --周转箱编号
              --检验有效性
              select count(*),max(c4),max(c5),max(length(c6)) into counter,status,v_tmp,v_seq from YS_Package where c1 = v_qrcode;
              if counter <> 1 then
                  Message := '车辆['||v_qrcode||']不可用！counter='||counter;
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> v_dmStatus_0 and status <> 232047 then
                  Message := '周转箱['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              if v_seq > 0 then
                  Message := '周转箱['||v_qrcode||']未送货完成，不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              if v_tmp <> a_qrcode2 then
                  Message := '周转箱['||v_qrcode||']与车辆['||a_qrcode2||']不匹配！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              
          end if;
          ---------------------------------------------------------------------------------------------------------
      
      elsif v_dmCode = '027_XDQS' then --消单
          ---------------------------------------------------------------------------------------------------------
          if a_seq = 1 then --配送汇总单号
              --检验有效性
              select count(*),max(c2) into counter,status from BO_Order_Ing_PSHZD where c1 = v_qrcode;
              if counter <> 1 then
                  Message := '配送汇总单['||v_qrcode||']不可用！counter='||counter;
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> v_dmStatus_0 then
                  Message := '配送汇总单['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
          end if;
          ---------------------------------------------------------------------------------------------------------
      
      elsif v_dmCode = '037_CZ' then --称重
          ---------------------------------------------------------------------------------------------------------
          if a_seq = 1 then --订单编号
              
              if a_bluetooth is null or a_bluetooth = 0 then
                  Message := '蓝牙称重无效，请检查！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              v_qrcode := replace(a_qrcode,'S','');
              --检验有效性
              select count(*),max(c22) into counter, status from BO_Order_Goods_Ing where substr(c2,2)=v_qrcode;
              if counter = 0 then
                  Message := '订单['||a_qrcode||']无效！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              --蓝牙称重
              if a_bluetooth is not null then
                --备份历史
                insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing where substr(c2,2)=v_qrcode) t0;
                update BO_Order_Goods_Ing set c40=a_bluetooth where substr(c2,2) = v_qrcode;
          
                ----------------------------------- 按照称重结果重新计算订单价格 /////////////////////////////-------------------------------
                select count(*),max(c1),max(c4),max(c30),max(c31) into counter,v_tmp,v_mid,v_jhhzdCode,v_tmpCode from BO_Order_Goods_Ing t where substr(c2,2)=v_qrcode and c13 in (183001,183002,183021) and (c10<0 or exists(select dataid from A_Goods_PS m where m.dataid=t.c10 and m.c18=1));
                if counter > 0 then
                --更新子订单实际数量（原食）
                update BO_Order_Goods_Ing t set c16=c40*decode(c13, 183001,2, 183002,1, 183021,2000, 1) where substr(c2,2)=v_qrcode; --原食实际数量(斤)
                update BO_Order_Goods_Ing t set c16=floor(10*c16)/10 where substr(c2,2)=v_qrcode;
                update BO_Order_Goods_Ing t set c15=c16,c17=c16 where substr(c2,2)=v_qrcode; --原食实际数量(斤)
                --更新订单金额
                update BO_Order_Goods_Ing t set c33=c15*c32, c35=c16*c34, c37=c17*c36, c50=c15,c51=c15*c32,c52=c17,c53=c17*c36,c54=c17*c34 where substr(c2,2)=v_qrcode; --原食结算价、买家结算价
                --更新总订单实际金额
                insert into ZBO_Order_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing where c1=v_tmp) t0;
                update BO_Order_Ing t set (c8,c9,c12,c13,c14)=(select sum(c40), sum(c41), sum(c37), sum(c35), sum(c33) from BO_Order_Goods_Ing m where m.c1=t.c1) where c1=v_tmp; --原食结算价、买家结算价
                --更新集货单的总金额
                update BO_Order_Ing_JHD t set c13=(select sum(c37) from BO_Order_Goods_Ing m where m.c30=t.c1 and m.c4=t.c4) where c1=v_jhhzdCode and c4=v_mid;
                --更新配送单的总金额
                update BO_Order_Ing_PSD a set (c12,c13,c14)=(select count(distinct c2||c8||c32),sum(c40),sum(c53) from BO_Order_Goods_Ing m where m.c31=a.c1 and m.c4=a.c4) where c1=v_tmpCode and c4=v_mid;
                end if;
                ------------------------------------------------------------------------------------------------
              end if;
          end if;
          ---------------------------------------------------------------------------------------------------------

      elsif v_dmCode = '034_THCK' then --退货出库
          if a_seq = 1 then --订单编号
              --检验有效性
              select count(*),max(c22) into counter, status from BO_Order_Goods_Reback where substr(c2,2)=replace(v_qrcode,'S','');
              if counter = 0 then
                  Message := '订单['||v_qrcode||']无效！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> v_dmStatus_0 then
                  Message := '订单['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
      
          end if;
          ---------------------------------------------------------------------------------------------------------
      elsif v_dmCode = '035_THBS' then --退货报损
          ---------------------------------------------------------------------------------------------------------
          if a_seq = 1 then --订单编号
              --检验有效性
              select count(*),max(c22) into counter, status from BO_Order_Goods_Reback where substr(c2,2)=replace(v_qrcode,'S','');
              if counter = 0 then
                  Message := '订单['||v_qrcode||']无效！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> v_dmStatus_0 then
                  Message := '订单['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
      
          end if;
          ---------------------------------------------------------------------------------------------------------
      elsif v_dmCode = '045_FPTHCL' then --分派提货车辆（越库）
          ---------------------------------------------------------------------------------------------------------
          if a_seq = 1 then --提货汇总单号
              --检验有效性
              select count(*),max(c10),max(c4) into counter,status,v_tmp from BO_Order_Ing_THHZD where c1=v_qrcode;
              if counter = 0 then
                  Message := '提货汇总单['||v_qrcode||']不存在！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> v_dmStatus_0 and status <> v_dmStatus_1 then
                  Message := '提货汇总单['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
          elsif a_seq = 2 then --车辆编码
              --检验有效性
              select count(*),max(c4) into counter,status from YS_Car where c1=v_qrcode;
              if counter <> 1 then
                  Message := '车辆['||v_qrcode||']不可用！counter='||counter;
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> v_dmStatus_1 and status <> 0 then
                  Message := '车辆['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              --检查车辆
              select count(*),max(c1) into counter,v_tmp from BO_Order_Ing_JHHZD where (c2<>9 and c2<232048) and instr(','||c8,','||v_qrcode||',')>0;
              if counter = 0 then
                  Message := '车辆['||v_qrcode||']没有装载任务';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
          elsif a_seq = 3 then --物流箱
              --检验有效性
              select count(*),max(c4),max(c5) into counter,status,v_tmp from YS_Package where c1=v_qrcode;
              if counter = 0 then
                  Message := '物流箱['||v_qrcode||']无效！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> 0 then
                  Message := '物流箱['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
      
          end if;
          ---------------------------------------------------------------------------------------------------------
      elsif v_dmCode = '046_THZC' then --提货装车（越库）
          ---------------------------------------------------------------------------------------------------------
          if a_seq = 1 then --车辆编码
              --检验有效性
              select count(*),max(c4) into counter,status from YS_Car where c1=v_qrcode;
              if counter <> 1 then
                  Message := '车辆['||v_qrcode||']不可用！counter='||counter;
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> v_dmStatus_1 and status <> v_dmStatus_0 then
                  Message := '车辆['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
          elsif a_seq = 2 then --订单编号
              --检验有效性
              select count(*),max(c22),max(c4),max(c30) into counter, status, v_mid, v_jhhzdCode from BO_Order_Goods_Ing where substr(c2,2)=replace(v_qrcode,'S','');
              if counter = 0 then
                  Message := '订单['||v_qrcode||']无效！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验状态
              if status <> v_dmStatus_0 then
                  Message := '订单['||v_qrcode||']状态['||F_DataParamDesc(status)||']不符合流程规则！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              select count(*) into counter from BO_Order_Ing_JHD where c1=v_jhhzdCode and c4=v_mid and instr(','||c22, ','||a_qrcode2||',')>0;
              if counter = 0 then
                  Message := '订单['||v_qrcode||']与车辆不匹配！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
          end if;
          ---------------------------------------------------------------------------------------------------------
      end if;
      
      -------------------------------------------------------------------------------------
      P_Log(a_logStr||' [QRCode='||a_qrcode||',QRCode2='||a_qrcode2||']', a_operator);
    end if;
    
    --Message := a_logStr||'成功!';
    open ResultCursor for select '' sqlmsg from dual;
    commit;
  exception when others then
    rollback;
    P_Log(a_logStr||' exception:'||sqlerrm, a_operator);
    pkg_ofooddms_orderstat.P_SMS(1,138444, null, '70333: 请技术人员速查SP_PDA_ServiceDO_Check['||v_dmName||''||a_seq||']'||substr(sqlerrm,1,100)); --发送短信
    Message := a_logStr||'失败! [QRCode='||a_qrcode||',QRCode2='||a_qrcode2||']'||substr(sqlerrm,1,100);
    open ResultCursor for select Message sqlmsg from dual;
  end;

  -- 库内作业: 提交
  procedure SP_PDA_ServiceDO_Commit(
    a_operatorID    in varchar2,
    a_operator      in varchar2,
    a_moduleID      in varchar2,
    a_paramStr      in varchar2,
    a_spliter       in varchar2,
    a_preCount      in number,
    a_reset         in number,
    Message         out varchar2,
    ResultCursor    out rc_class
  ) is
    a_logStr        varchar2(500);
    v_paramStr      VARCHAR2(8000);
    tmp             VARCHAR2(4000);
    splitlen        integer;
    N               integer;
    v_spliter       varchar(1);
    
    procno          number;
    counter         number;
    status          number;
    v_dmName        YS_DotModule.c1%type;
    v_dmCode        YS_DotModule.c2%type;
    v_dmStatus_0    YS_DotModule.c5%type;
    v_dmStatus_1    YS_DotModule.c6%type;
    
    pbtn            VARCHAR2(10);       --提交按钮的seq：'PB-4' 'PB-5'
    p1              VARCHAR2(4000);
    p2              VARCHAR2(4000);
    p3              VARCHAR2(4000);
    p4              VARCHAR2(4000);
    p5              VARCHAR2(4000);
    p6              VARCHAR2(4000);
    p_reset         VARCHAR2(50);      --提交后的表单清空标识：'2`0`0`0'
    
    v_thhzdCode     VARCHAR2(50);  --提货汇总单ID
    v_thdCode       VARCHAR2(50);  --提货单ID
    v_jhhzdCode     VARCHAR2(500); --集货汇总单ID
    v_jhdCode       VARCHAR2(50);  --集货单ID
    v_pshzdCode     VARCHAR2(50);  --配送汇总单ID
    v_psdCode       VARCHAR2(50);  --配送单ID
    v_orderCode     VARCHAR2(4000); --订单ID
    v_containerCode VARCHAR2(200);  --容器ID
    v_container2Code VARCHAR2(200); --容器2ID
    v_carCode       VARCHAR2(20);   --车辆ID
    v_packageCode   VARCHAR2(4000); --物流箱ID
    v_placeCode     VARCHAR2(200);  --位置ID
    v_pstime        number;         --配送时间
    v_num           number;
    v_result        VARCHAR2(100);
    v_result2       VARCHAR2(200);
    v_mid           VARCHAR2(200);
    v_userNO        VARCHAR2(10);   --用户工号
    v_userPass      VARCHAR2(20);   --用户密码
  begin
    p_reset := '';
    a_logStr := to_char(sysdate,'yyyy-mm-dd hh24:mi:ss');
    
    select count(*) into counter from YS_DotModule where dataid = a_moduleID and c4 = 130001;
    if counter = 0 then
        Message := 'DOT模块不存在或模块无效！';
        open ResultCursor for select Message sqlmsg from dual;
        return;
    else
      select c1,c2,c5,c6 into v_dmName,v_dmCode,v_dmStatus_0,v_dmStatus_1 from YS_DotModule where dataid = a_moduleID;
      --v_dmCode := substr(v_dmCode, instr(v_dmCode, '_')+1);
      a_logStr := a_logStr ||' ['|| v_dmCode||'] ' || v_dmName || ' by ' ||a_operator;
      Message := '['||v_dmName||']';
      if a_reset = 1 then a_logStr := a_logStr || '【重置】'; end if;
      
      --P_Log(a_logStr||' begin:'||a_paramStr, a_operator);
      -------------------------------------------------------------------------------------
      if a_preCount > 0 then
        splitlen := length(a_spliter||'a')-1;
        v_paramStr := a_paramStr;
        for N in 1..a_preCount loop
            tmp := UPPER( substr(v_paramStr, 1, instr(v_paramStr, a_spliter)-1) );
               if N=1 then pbtn := tmp;
            elsif N=2 then p1 := tmp;
            elsif N=3 then p2 := tmp;
            elsif N=4 then p3 := tmp;
            elsif N=5 then p4 := tmp;
            elsif N=6 then p5 := tmp;
            elsif N=7 then p6 := tmp;
            end if;
            v_paramStr := substr(v_paramStr, instr(v_paramStr, a_spliter)+splitlen, length(v_paramStr));
        end loop;
        
        /*
        DECLARE CURSOR v_rs IS select * from YS_DotModuleDetail where parentDataid = a_moduleID;
        begin
            open v_rs;
            LOOP
              FETCH v_rs INTO v________________;
              exit when v_rs%notfound;
              
              
              
            END LOOP;
            close v_rs;
        end;*/
      end if;
      
      if v_dmCode = '001_CKDDXQ' then --查看订单详情
          v_orderCode := p1;
          ---------------------------------------------------------------------------------------------------------
          select count(*) into counter from BO_Order_Goods_Ing where substr(c2,2)=replace(v_orderCode,'S','');
          if counter = 0 then
              Message := Message||'订单不存在！';
              P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
              open ResultCursor for select Message sqlmsg from dual;
              return;
          end if;
          ---------------------------------------------------------------------------------------------------------
          
      elsif v_dmCode = '002_FPTHLX' then --生成提货汇总单
          if a_reset = 0 then
              select count(distinct a.c4) into counter from BO_Order_Ing_THD a, B_MMSeller b, B_MMSeller_Area c
               where a.c4=b.dataid and b.dataid=c.parentDataid
                 and a.c10 = 0
                 and (c.c3 is null or c.c3=0);
              if counter > 0 then
                Message := Message||'有'||counter||'个卖家未分配提货区域';
                rollback;
                P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                open ResultCursor for select Message sqlmsg from dual;
                return;
              end if;
              procno := 201;
              --提货单历史
              insert into ZBO_Order_Ing_THD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_THD where c10 = 0) t0;
              procno := 202;
              --[大客户买家]生成提货汇总单-------------------------------------------------------------------------------
              select NVL(max(c1), 'THZ'||to_char(sysdate,'yymmdd')||'0000') into v_thhzdCode from BO_Order_Ing_THHZD where instr(c1,'-')=0 and c1 like 'THZ'||to_char(sysdate,'yymmdd')||'%';
              insert into BO_Order_Ing_THHZD(dataid,c1,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12,c13,c14)
                   select seqBO_Order_Ing_THHZD.Nextval, 'THZ'||(to_number(substr(v_thhzdCode,4))+rownum), t.* from (select -1*a.c4 areaID, '' auid, '' thr,
                        to_char(sysdate,'yyyy-mm-dd') thrq, count(distinct a.c5) num_amid, count(a.dataid) num_order, sum(a.c19) zl, sum(a.c20) tj, 0 status, a_operatorID, a_operator,
                        to_char(sysdate,'yyyy-mm-dd') fhrq, sum(a.c33) totalPrice
                     from BO_Order_Goods_Ing a, BO_Order_Ing_THD b, B_MMBuyer c 
                    where a.c28=b.c2 and a.c3=c.c2 and c.c22=1 --大客户
                      and a.c22 = v_dmStatus_0
                      and b.c10 = 0
                    group by a.c4) t;
              procno := 203;
              --[大客户买家]分配提货单
              update BO_Order_Ing_THD t set c15=0, c17=0, c10 = 1, uptdate=sysdate,
                     c1=(select max(b.c1) from BO_Order_Goods_Ing a, BO_Order_Ing_THHZD b where a.c4=-1*b.c2 and b.c10=0 and a.c28=t.c2 and a.c22 = v_dmStatus_0)
              where c10 = 0 and exists (select a.dataid from BO_Order_Goods_Ing a, BO_Order_Ing_THHZD b where a.c4=-1*b.c2 and b.c10=0 and a.c28=t.c2 and a.c22 = v_dmStatus_0);
              procno := 204;
              -----------------------------------------------------------------------------------------------------------
          
              --生成提货汇总单
              select NVL(max(c1), 'THZ'||to_char(sysdate,'yymmdd')||'0000') into v_thhzdCode from BO_Order_Ing_THHZD where instr(c1,'-')=0 and c1 like 'THZ'||to_char(sysdate,'yymmdd')||'%';
              insert into BO_Order_Ing_THHZD(dataid,c1,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12,c13,c14)
                   select seqBO_Order_Ing_THHZD.Nextval, 'THZ'||(to_number(substr(v_thhzdCode,4))+rownum), t.* from (select c.c3 areaID, '' auid, '' thr,
                        to_char(sysdate,'yyyy-mm-dd') thrq, count(distinct a.c2) num_amid, sum(a.c11) num_order, sum(a.c12) zl, sum(a.c13) tj, 0 status, a_operatorID, a_operator,
                        to_char(sysdate,'yyyy-mm-dd') fhrq, sum(a.c16) totalPrice
                     from BO_Order_Ing_THD a, B_MMSeller b, B_MMSeller_Area c
                    where a.c4=b.dataid and b.dataid=c.parentDataid
                      and a.c10 = 0
                    group by c.c3) t;
              procno := 205;
              --分配提货单
              update BO_Order_Ing_THD t set (c1,c15,c17)=
                  (select max(b.c1) hzcode, pkg_ofooddms_orderStat.F_GetTHAreaSeq(a.parentDataid,a.c3,v_dmStatus_0),max(a.c2) seq
                  from B_MMSeller_Area a, BO_Order_Ing_THHZD b
                  where a.parentDataid=t.c4 and a.c3=b.c2 and b.c10=0 group by a.parentDataid,a.c3), c10 = 1, uptdate=sysdate
               where c10 = 0;
              procno := 206;
               
              --更新订单状态
              insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing where c22=v_dmStatus_0) t0;
              update BO_Order_Goods_Ing set c22=v_dmStatus_1, c29='生成提货汇总单', uptdate=sysdate where c22=v_dmStatus_0;
              procno := 207;
              commit;
          else
              --回退
              /*
              select count(*) into counter from BO_Order_Goods_Ing where c22=v_dmStatus_1;
              if counter = 0 then
                  Message := Message||'没有可回退（状态必须为'||v_dmStatus_1||'）的订单！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;*/
              
              /*--回退到分配前
              update BO_Order_Goods_Ing set c22=v_dmStatus_0, uptdate=sysdate where istdate<to_date('20150507','yyyymmdd');-- where c22=v_dmStatus_1;
              delete from BO_Order_Ing_THHZD where c10=0;
              update BO_Order_Ing_THD set c1='待分配', c10=0 where c10=0;
              update Ys_Container set c4=0,c5='',c6='',c9='',c10=0;
              update Ys_Package set c4=0,c5='',c6='',c7='';
              update Ys_Place set c4=0,c5='',c6='',c7='';
              update Ys_Car set c4=0,c5='',c6='',c7='',c8='',c9=0;  --回退结束*/
              
              
              /*--回退到处理前
              update BO_Order_Ing set c15=230003 where c17=232020 and c18=20150822;
              update BO_Order_Goods_Ing set c21=230003 where c22=232020 and c26=20150822;
              update BO_OrderHis set c15=230003 where c11>0 and c18=20150822;
              update BO_OrderHis_Goods set c21=230003 where c26=20150822;
              commit;
              insert into BO_Order select * from BO_Order_Ing where c15=230003 and c18=20150822;
              insert into BO_Order select * from BO_OrderHis where c15=230003 and c18=20150822;
              insert into BO_Order_GoodsDetail select * from BO_Order_Goods_Ing where c21=230003 and c26=20150822;
              insert into BO_Order_GoodsDetail select * from BO_OrderHis_Goods where c21=230003 and c26=20150822;
              commit;
              delete from BO_Order_Ing where c15=230003 and c18=20150822;
              delete from BO_OrderHis where c15=230003 and c18=20150822;
              delete from BO_Order_Goods_Ing where c21=230003 and c26=20150822;
              delete from BO_OrderHis_Goods where c21=230003 and c26=20150822;
              delete from BO_Order_Ing_THHZD where c10=0;
              delete from BO_Order_Ing_THD where c10=0;
              delete from BO_Order_Ing_JHHZD where c2=0;
              delete from BO_Order_Ing_JHD where c10=0;
              commit;  --回退结束*/
              
              
              /*
              select count(*) into counter from BO_Order_Ing_JHHZD where c1 like 'JH'||to_char(sysdate,'yymmddhh24')||'%';
              if counter > 0 then
                Message := Message||'当前时间已处理过，请等待下一整点！';
                P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                open ResultCursor for select Message sqlmsg from dual;
                return;
              end if;*/

              --处理订单
              pkg_ofooddms_orderStat.SP_Order_Deal(a_operator);
              P_Log('库内处理订单: pkg_ofooddms_orderStat.SP_Order_Deal', a_operator);
              Message := Message||'手工处理订单命令';
          end if;                
      
      elsif v_dmCode = '003_THDDY' then --提货汇总单打印
          v_thhzdCode := p1;
          ---------------------------------------------------------------------------------------------------------
          --检验是否存在
          select count(*) into counter from BO_Order_Ing_THHZD where c1=v_thhzdCode;
          if counter = 0 then
              Message := Message||'提货汇总单['||v_thhzdCode||']不存在！';
              P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
              open ResultCursor for select Message sqlmsg from dual;
              return;
          end if;
          if a_reset = 0 then
              --更新提货汇总单状态
              insert into ZBO_Order_Ing_THHZD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_THHZD where c1=v_thhzdCode and c10=0) t0;
              update BO_Order_Ing_THHZD set c10=v_dmStatus_1, uptdate=sysdate where c1=v_thhzdCode and c10=0;
              --更新订单状态
              insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing t where c22 = v_dmStatus_0
                 and exists (select a.dataid from BO_Order_Ing_THHZD a, BO_Order_Ing_THD b where a.c1=b.c1 and b.c2=t.c28 and a.c1=v_thhzdCode)) t0;
              update BO_Order_Goods_Ing t set c22=v_dmStatus_1, c29='提货汇总单打印', uptdate=sysdate 
               where c22 = v_dmStatus_0
                 and exists (select a.dataid from BO_Order_Ing_THHZD a, BO_Order_Ing_THD b where a.c1=b.c1 and b.c2=t.c28 and a.c1=v_thhzdCode);
          
          else
              --回退
              null;
          end if;
          ---------------------------------------------------------------------------------------------------------
      
      elsif v_dmCode = '004_DDBQDY' then --订单标签打印
          v_thdCode := p1;
          ---------------------------------------------------------------------------------------------------------
          --检验是否存在
          select count(*) into counter from BO_Order_Ing_THD where c2=v_thdCode;
          if counter = 0 then
              Message := Message||'提货单['||v_thdCode||']不存在！';
              P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
              open ResultCursor for select Message sqlmsg from dual;
              return;
          end if;
          
          if a_reset = 0 then
              --更新提货单状态
              insert into ZBO_Order_Ing_THD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_THD where c2=v_thdCode and c10=1) t0;
              update BO_Order_Ing_THD set c10=v_dmStatus_1, uptdate=sysdate where c2=v_thdCode and c10=1;
              --更新订单状态
              insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing where c22 = v_dmStatus_0 and c28 = v_thdCode) t0;
              update BO_Order_Goods_Ing t set c22=v_dmStatus_1, c29='订单标签打印', uptdate=sysdate 
               where c22 = v_dmStatus_0
                 and c28 = v_thdCode;
                 
              commit;
              
              select c1 into v_thhzdCode from BO_Order_Ing_THD where c2=v_thdCode;
              select count(*) into counter from BO_Order_Ing_THD where c1=v_thhzdCode and c10<v_dmStatus_1;
              if counter = 0 then
                --更新提货汇总单状态
                insert into ZBO_Order_Ing_THHZD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_THHZD where c1=v_thhzdCode and c10<v_dmStatus_1) t0;
                update BO_Order_Ing_THHZD set c10=v_dmStatus_1, uptdate=sysdate where c1=v_thhzdCode and c10<v_dmStatus_1;
              end if;
          
          else
              --回退
              null;
          end if;
          ---------------------------------------------------------------------------------------------------------
      
      elsif v_dmCode = '005_THDFP' then --提货单分配  （已在校验中直接执行此段程序)
          null;/* 
          v_thhzdCode := p1;
          ---------------------------------------------------------------------------------------------------------     
          if a_reset = 0 then
              --检验有效性
              select count(*),max(c4) into counter,tmp from BO_Order_Ing_THHZD where c1=v_thhzdCode and c10=v_dmStatus_0;
              if counter = 0 then
                  Message := Message||'提货汇总单['||v_thhzdCode||']不可用或状态不符！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验有效性
              if tmp is not null then
                  Message := Message||'提货汇总单['||v_thhzdCode||']已分配给['||tmp||']！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检查订单状态 2015-07-27 add by wxl 吴
              select count(*) into counter from BO_Order_Goods_Ing where c22<>v_dmStatus_0 and c28 in (select c2 from BO_Order_Ing_THD where c1=v_thhzdCode);
              if counter > 0 then
                  Message := Message||'提货汇总单['||v_thhzdCode||']有['||counter||']个订单状态不符！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              --更新提货汇总单状态
              insert into ZBO_Order_Ing_THHZD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_THHZD where c1=v_thhzdCode) t0;
              update BO_Order_Ing_THHZD set c10=v_dmStatus_1, c3=a_operatorID, c4=a_operator, uptdate=sysdate where c1=v_thhzdCode;
              --更新提货单状态
              insert into ZBO_Order_Ing_THD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_THD where c1=v_thhzdCode) t0;
              update BO_Order_Ing_THD set c10=v_dmStatus_1, uptdate=sysdate where c1=v_thhzdCode;
              --更新订单状态
              insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing t where c22 = v_dmStatus_0
                 and exists (select a.dataid from BO_Order_Ing_THHZD a, BO_Order_Ing_THD b where a.c1=b.c1 and b.c2=t.c28 and a.c1=v_thhzdCode)) t0;
              update BO_Order_Goods_Ing t set c22=v_dmStatus_1, c29='提货单分配给'||a_operator, uptdate=sysdate 
               where c22 = v_dmStatus_0
                 and exists (select a.dataid from BO_Order_Ing_THHZD a, BO_Order_Ing_THD b where a.c1=b.c1 and b.c2=t.c28 and a.c1=v_thhzdCode);
          
          else --回退              
              --更新提货汇总单状态
              insert into ZBO_Order_Ing_THHZD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_THHZD where c1=v_thhzdCode) t0;
              update BO_Order_Ing_THHZD set c10=v_dmStatus_0, c3='', c4='', uptdate=sysdate where c1=v_thhzdCode;
              --更新提货单状态
              insert into ZBO_Order_Ing_THD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_THD where c1=v_thhzdCode) t0;
              update BO_Order_Ing_THD set c10=v_dmStatus_0, uptdate=sysdate where c1=v_thhzdCode;
              --更新订单状态
              insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing t where c22 = v_dmStatus_1
                 and exists (select a.dataid from BO_Order_Ing_THHZD a, BO_Order_Ing_THD b where a.c1=b.c1 and b.c2=t.c28 and a.c1=v_thhzdCode)) t0;
              update BO_Order_Goods_Ing t set c22=v_dmStatus_0, c29='提货单分配(back)', uptdate=sysdate 
               where c22 = v_dmStatus_1
                 and exists (select a.dataid from BO_Order_Ing_THHZD a, BO_Order_Ing_THD b where a.c1=b.c1 and b.c2=t.c28 and a.c1=v_thhzdCode);
          
          end if;*/
          ---------------------------------------------------------------------------------------------------------
      
      elsif v_dmCode = '006_THDFF' then --提货单发放
          v_thdCode := p1;
          ---------------------------------------------------------------------------------------------------------          
          if a_reset = 0 then
              --检验有效性
              select count(*) into counter from BO_Order_Ing_THD where c2=v_thdCode and c10=v_dmStatus_0;
              if counter = 0 then
                  Message := Message||'提货单['||v_thhzdCode||']不可用或状态不符！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              --更新提货单状态
              insert into ZBO_Order_Ing_THD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_THD where c2=v_thdCode and c10=v_dmStatus_0) t0;
              update BO_Order_Ing_THD set c10=v_dmStatus_1, c9=p2, uptdate=sysdate where c2=v_thdCode and c10=v_dmStatus_0;
              --更新订单状态
              insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing where c22 = v_dmStatus_0 and c28 = v_thdCode) t0;
              update BO_Order_Goods_Ing t set c22=v_dmStatus_1, c29='提货单发放', uptdate=sysdate 
               where c22 = v_dmStatus_0
                 and c28 = v_thdCode;
          
              select c1 into v_thhzdCode from BO_Order_Ing_THD where c2=v_thdCode;
              select count(*) into counter from BO_Order_Ing_THD where c1=v_thhzdCode and c10<v_dmStatus_1;
              if counter = 0 then
                --更新提货汇总单状态
                insert into ZBO_Order_Ing_THHZD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_THHZD where c1=v_thhzdCode) t0;
                update BO_Order_Ing_THHZD set c10=v_dmStatus_1, uptdate=sysdate where c1=v_thhzdCode and c10<v_dmStatus_1;
              end if;
          else
              --回退
              null;
          end if;
          ---------------------------------------------------------------------------------------------------------
      
      elsif v_dmCode = '007_MJBH' then --卖家备货
          null;
      
      elsif v_dmCode = '008_MJFH' then --卖家发货
          null;
          
      elsif v_dmCode = '031_SPBQ' then --商品报缺
          v_orderCode := p1;
          ---------------------------------------------------------------------------------------------------------
          v_orderCode := replace(v_orderCode, 'S', ''); --去掉订单编号的'S'
          if a_reset = 0 then
              --检验订单
              select count(*),max(c22),max(c4),max(c30) into counter,status,v_mid,v_jhhzdCode from BO_Order_Goods_Ing where substr(c2,2)=v_orderCode and c22<232040;  --准备入库之前的订单
              if counter = 0 then
                  Message := Message||'订单['||v_orderCode||']不存在或状态不符！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              if status = v_dmStatus_1 then
                  Message := Message||'订单['||v_orderCode||']已报缺，请不要重复提交！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --报缺入库协调的订单
              if status = 232039 then                  
                  --更新质检位置状态
                  insert into ZYS_Place select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Place where c1=(select c5 from YS_Container where instr(c7,v_orderCode)>0)) t0;
                  update YS_Place set c4=0, c5='', uptdate=sysdate where c1=(select c5 from YS_Container where instr(c7,v_orderCode)>0);
                  --更新质检容器状态
                  insert into ZYS_Container select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Container where instr(c7,v_orderCode)>0) t0;
                  update YS_Container set c4=0, c5='', c7='', uptdate=sysdate where instr(c7,v_orderCode)>0;                
              end if;
              
              --更新子订单状态
              insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing t
               where -----c22 = v_dmStatus_0 and 
                 substr(c2,2)=v_orderCode) t0;              
              update BO_Order_Goods_Ing t set c11=c11||'-----[报缺]', c22 = v_dmStatus_1, c29=to_char(sysdate,'yyyy-mm-dd hh24:mi:ss') ||' 报缺', uptdate=sysdate
               where -----c22 = v_dmStatus_0 and 
                 substr(c2,2)=v_orderCode;
                 
              commit;
              
              select count(*),max(c1) into counter,v_containerCode from YS_Container where c9=v_mid and c11=v_jhhzdCode and c4=232046;
              if counter > 0 then
                  --集货是否完成(并检查232031报缺订单)
                  select count(*), sum(decode(c22,232031,0,1)) into counter,v_num from BO_Order_Goods_Ing where c4=v_mid and c30=v_jhhzdCode and c22<>232046;
                  if counter = 0 then
                    insert into ZYS_Container select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Container where c1=v_containerCode) t0;
                    update YS_Container set c10=1 where c1=v_containerCode;
                  elsif v_num = 0 then --仅剩报缺订单未集货
                    insert into ZYS_Container select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Container where c1=v_containerCode) t0;
                    update YS_Container set c10=1 where c1=v_containerCode; --报缺
                  end if;
                  
                  --集货汇总单是否集货完成
                  select count(*), sum(decode(c22,232031,0,1)) into counter,v_num from BO_Order_Goods_Ing where c30=v_jhhzdCode and c22<>232046;
                  if counter = 0 then
                    insert into ZBO_Order_Ing_JHHZD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_JHHZD where c1=v_jhhzdCode) t0;
                    update BO_Order_Ing_JHHZD set c2=232046 where c1=v_jhhzdCode;
                  elsif v_num = 0 then --仅剩报缺订单未集货
                    insert into ZBO_Order_Ing_JHHZD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_JHHZD where c1=v_jhhzdCode) t0;
                    update BO_Order_Ing_JHHZD set c2=232031 where c1=v_jhhzdCode; --报缺 c2=232031
                  end if;
              end if;
              
              
          else
              --回退
              null;
          end if;
          ---------------------------------------------------------------------------------------------------------
      
      elsif v_dmCode = '009_TH' then --提货   --2015-07-28 wxl 更改提货流程         
          v_orderCode := p1;
          ---------------------------------------------------------------------------------------------------------
          if a_reset = 0 then
              --检查订单状态  (报缺订单也可以提)
              select count(*),sum(decode(c22,v_dmStatus_0,1,232031,1,0)) into counter,v_num from BO_Order_Goods_Ing where instr(v_orderCode,c2)>0;
              if counter <> v_num then
                  Message := Message||'有'||counter-v_num||'个订单状态不符合流程规则！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检查提货人
              select count(distinct c.c3),max(a.c1),count(b.dataid),max(c.c3) into counter,v_thhzdCode,v_num,tmp from BO_Order_Ing_THD a, BO_Order_Goods_Ing b, BO_Order_Ing_THHZD c where a.c1=c.c1 and a.c2=b.c28 and instr(v_orderCode,b.c2)>0;
              if counter <> 1 or tmp <> a_operatorID then
                  Message := Message||'有订单不属于提货人['||a_operator||']！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;

              --更新订单状态
              insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing
               where (c22 = v_dmStatus_0 or c22 = 232031)
                 and instr(v_orderCode,c2)>0 ) t0;
              update BO_Order_Goods_Ing t set c11=replace(c11,'-----[报缺]',''), c22=v_dmStatus_1, c29='提货[by '||a_operator||a_operatorID||']', uptdate=sysdate
               where (c22 = v_dmStatus_0 or c22 = 232031)
                 and instr(v_orderCode,c2)>0;
                            
              --检查提货单是否提货完成
              insert into ZBO_Order_Ing_THD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_THD t
               where c10=v_dmStatus_0
                and exists (select dataid from BO_Order_Goods_Ing m where m.c28=t.c2 and instr(v_orderCode,m.c2)>0)
                and not exists (select dataid from BO_Order_Goods_Ing m where m.c28=t.c2 and m.c22 between 232023 and v_dmStatus_0) ) t0;
              update BO_Order_Ing_THD t set c10=v_dmStatus_1, uptdate=sysdate 
               where c10=v_dmStatus_0
                and exists (select dataid from BO_Order_Goods_Ing m where m.c28=t.c2 and instr(v_orderCode,m.c2)>0)
                and not exists (select dataid from BO_Order_Goods_Ing m where m.c28=t.c2 and m.c22 between 232023 and v_dmStatus_0);
              --检查提货汇总单是否提货完成
              insert into ZBO_Order_Ing_THHZD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_THHZD t
               where exists (select m.dataid from BO_Order_Goods_Ing m, BO_Order_Ing_THD n where m.c28=n.c2 and n.c1=t.c1 and instr(v_orderCode,m.c2)>0)
                 and not exists (select m.dataid from BO_Order_Goods_Ing m, BO_Order_Ing_THD n where m.c28=n.c2 and n.c1=t.c1 and m.c22 between 232023 and v_dmStatus_0)) t0;
              update BO_Order_Ing_THHZD t set c10=v_dmStatus_1, uptdate=sysdate
               where exists (select m.dataid from BO_Order_Goods_Ing m, BO_Order_Ing_THD n where m.c28=n.c2 and n.c1=t.c1 and instr(v_orderCode,m.c2)>0)
                 and not exists (select m.dataid from BO_Order_Goods_Ing m,BO_Order_Ing_THD n where m.c28=n.c2 and n.c1=t.c1 and m.c22 between 232023 and v_dmStatus_0);
                         
          else
              --回退
              null;
          end if;
         ---------------------------------------------------------------------------------------------------------
        
      elsif v_dmCode = '010_THZ' then --提货（直接供应商）
          null;
      
      elsif v_dmCode = '011_THZY' then --提货转运
          v_num := p1;
          v_userNO := p2;
          v_userPass := p3;
          ---------------------------------------------------------------------------------------------------------          
          if a_reset = 0 then
              --检验转运人员身份
              select count(*),max(c4),max(c10) into counter,tmp,v_result from YS_DotUser where c2=v_userNO;-- and c3=v_userPass;
              if counter = 0 then
                  Message := Message||'工号['||v_userNO||']验证失败！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              select count(*) into counter from YS_DotRoleModule where parentDataid=tmp and c1=11;
              if counter = 0 then
                  Message := Message||'工号['||v_userNO||']没有转运权限！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              --检验状态
              select count(b.dataid) into counter from BO_Order_Ing_THD a, BO_Order_Goods_Ing b, BO_Order_Ing_THHZD c where a.c1=c.c1 and a.c2=b.c28 and c.c3=a_operatorID and b.c22=v_dmStatus_0;
              if counter <> v_num then
                  Message := Message||'订单数不匹配，应为'||counter||'！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;

              --更新订单状态
              insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing t
               where c22 = v_dmStatus_0
                 and exists (select a.dataid from BO_Order_Ing_THD a, BO_Order_Ing_THHZD c where a.c1=c.c1 and a.c2=t.c28 and c.c3=a_operatorID) ) t0;
              update BO_Order_Goods_Ing t set c22=v_dmStatus_1, c29='提货转运by '||v_result||v_userNO, uptdate=sysdate
               where c22 = v_dmStatus_0
                 and exists (select a.dataid from BO_Order_Ing_THD a, BO_Order_Ing_THHZD c where a.c1=c.c1 and a.c2=t.c28 and c.c3=a_operatorID);
              
              commit;
              
              --检查提货单是否提货完成
              insert into ZBO_Order_Ing_THD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_THD t
               where c10=v_dmStatus_0
                and exists (select dataid from BO_Order_Goods_Ing m where m.c28=t.c2 and instr(v_orderCode,m.c2)>0)
                and not exists (select dataid from BO_Order_Goods_Ing m where m.c28=t.c2 and m.c22 between 232023 and v_dmStatus_0) ) t0;
              update BO_Order_Ing_THD t set c10=v_dmStatus_1, uptdate=sysdate 
               where c10=v_dmStatus_0
                and exists (select dataid from BO_Order_Goods_Ing m where m.c28=t.c2 and instr(v_orderCode,m.c2)>0)
                and not exists (select dataid from BO_Order_Goods_Ing m where m.c28=t.c2 and m.c22 between 232023 and v_dmStatus_0);
              --检查提货汇总单是否提货完成
              insert into ZBO_Order_Ing_THHZD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_THHZD t
               where exists (select m.dataid from BO_Order_Goods_Ing m, BO_Order_Ing_THD n where m.c28=n.c2 and n.c1=t.c1 and instr(v_orderCode,m.c2)>0)
                 and not exists (select m.dataid from BO_Order_Goods_Ing m, BO_Order_Ing_THD n where m.c28=n.c2 and n.c1=t.c1 and m.c22 between 232023 and v_dmStatus_0)) t0;
              update BO_Order_Ing_THHZD t set c10=v_dmStatus_1, uptdate=sysdate
               where exists (select m.dataid from BO_Order_Goods_Ing m, BO_Order_Ing_THD n where m.c28=n.c2 and n.c1=t.c1 and instr(v_orderCode,m.c2)>0)
                 and not exists (select m.dataid from BO_Order_Goods_Ing m,BO_Order_Ing_THD n where m.c28=n.c2 and n.c1=t.c1 and m.c22 between 232023 and v_dmStatus_0);
                                                 
          else
              --回退
              null;
          end if;
          ---------------------------------------------------------------------------------------------------------
      
      elsif v_dmCode = '012_RKXH' then --入库卸货
          v_userNO := p1;
          ---------------------------------------------------------------------------------------------------------          
          if a_reset = 0 then
              --检验状态
              select count(*) into counter from BO_Order_Goods_Ing where c22=v_dmStatus_0 and c29 like '%'||v_userNO;
              if counter = 0 then
                  Message := Message||'工号['||v_userNO||']不可用或状态不符！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
          
              --更新订单状态
              insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing where c22 = v_dmStatus_0 and c29 like '%'||v_userNO) t0;
              update BO_Order_Goods_Ing t set c22=v_dmStatus_1, c29='入库卸货', uptdate=sysdate 
               where c22 = v_dmStatus_0
                 and c29 like '%'||v_userNO;

              commit;
              
              --检查提货单是否提货完成
              insert into ZBO_Order_Ing_THD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_THD t
               where c10=v_dmStatus_0
                and exists (select dataid from BO_Order_Goods_Ing m where m.c28=t.c2 and instr(v_orderCode,m.c2)>0)
                and not exists (select dataid from BO_Order_Goods_Ing m where m.c28=t.c2 and m.c22 between 232023 and v_dmStatus_0) ) t0;
              update BO_Order_Ing_THD t set c10=v_dmStatus_1, uptdate=sysdate 
               where c10=v_dmStatus_0
                and exists (select dataid from BO_Order_Goods_Ing m where m.c28=t.c2 and instr(v_orderCode,m.c2)>0)
                and not exists (select dataid from BO_Order_Goods_Ing m where m.c28=t.c2 and m.c22 between 232023 and v_dmStatus_0);
              --检查提货汇总单是否提货完成
              insert into ZBO_Order_Ing_THHZD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_THHZD t
               where exists (select m.dataid from BO_Order_Goods_Ing m, BO_Order_Ing_THD n where m.c28=n.c2 and n.c1=t.c1 and instr(v_orderCode,m.c2)>0)
                 and not exists (select m.dataid from BO_Order_Goods_Ing m, BO_Order_Ing_THD n where m.c28=n.c2 and n.c1=t.c1 and m.c22 between 232023 and v_dmStatus_0)) t0;
              update BO_Order_Ing_THHZD t set c10=v_dmStatus_1, uptdate=sysdate
               where exists (select m.dataid from BO_Order_Goods_Ing m, BO_Order_Ing_THD n where m.c28=n.c2 and n.c1=t.c1 and instr(v_orderCode,m.c2)>0)
                 and not exists (select m.dataid from BO_Order_Goods_Ing m,BO_Order_Ing_THD n where m.c28=n.c2 and n.c1=t.c1 and m.c22 between 232023 and v_dmStatus_0);
                                   
          else
              --回退
              null;
          end if;
          ---------------------------------------------------------------------------------------------------------
      
      elsif v_dmCode = '013_RKXHZ' then --入库卸货（直接供应商）
          null;
      
      elsif v_dmCode = '014_RKZJ' then --入库质检
          v_containerCode := p1;
          v_placeCode := p2;
          v_orderCode := p3;
          v_result := p4;
          ---------------------------------------------------------------------------------------------------------
          if a_reset = 0 then
              --检验有效性
              select count(*),max(c5) into counter,tmp from YS_Container where c1=v_containerCode and (c4=0 or c4=v_dmStatus_1);
              if counter = 0 then
                  Message := Message||'容器['||v_containerCode||']不可用或状态不符！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              if tmp is not null and tmp <> v_placeCode then
                  Message := Message||'容器['||v_containerCode||']与位置['||v_placeCode||']不符，应'||tmp||'！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验有效性
              select count(*),max(c5) into counter,tmp from YS_Place where c1=v_placeCode and (c4=0 or c4=v_dmStatus_1) and c2<>2;
              if counter = 0 then
                  Message := Message||'位置['||v_placeCode||']不可用或状态不符！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              if tmp is not null and tmp <> v_containerCode then
                  Message := Message||'位置['||v_placeCode||']不可用！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验有效性
              select count(*) into counter from BO_Order_Goods_Ing where substr(c2,2)=replace(v_orderCode,'S','') and (c22=v_dmStatus_0 or c22=232039);
              if counter = 0 then
                  Message := Message||'订单['||v_orderCode||']无效或状态不符！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;              
              --检验订单所在容器
              select count(*),max(c6) into counter,tmp from BO_Order_Ing_QC where c1=v_orderCode and c6<>v_containerCode and c5=1;
              if counter > 0 then
                  Message := '错误，请将订单['||v_orderCode||']放回容器['||tmp||']！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              --更新质检结果
              insert into ZBO_Order_Ing_QC select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_QC where c1=v_orderCode) t0;
              delete from BO_Order_Ing_QC where c1=v_orderCode;
              insert into BO_Order_Ing_QC(dataid,c1,c2,c3,c4,c5,c6) values(seqBO_Order_Ing_QC.Nextval,v_orderCode,v_result,a_operatorID,a_operator,1,v_containerCode);
              
              --更新容器状态 质检结果
              insert into ZYS_Container select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Container where c1=v_containerCode) t0;
              update YS_Container set c4=v_dmStatus_1, c5=v_placeCode, c7=v_orderCode||v_result, uptdate=sysdate where c1=v_containerCode;
              
              --更新位置状态
              insert into ZYS_Place select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Place where c1=v_placeCode) t0;
              update YS_Place set c4=v_dmStatus_1, c5=v_containerCode, uptdate=sysdate where c1=v_placeCode;
              
              --更新订单              
              if v_result = '合格' then
                  insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing where substr(c2,2)=replace(v_orderCode,'S','')) t0;
                  update BO_Order_Goods_Ing set c22=v_dmStatus_1, c29='入库质检'||v_placeCode||'-'||v_containerCode||':'||v_result, uptdate=sysdate where substr(c2,2)=replace(v_orderCode,'S','');
              else 
                  --不合格 -> 232039入库协调
                  update BO_Order_Ing_QC set c5=2 where c1=v_orderCode;
                  insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing where substr(c2,2)=replace(v_orderCode,'S','')) t0;
                  update BO_Order_Goods_Ing set c22=232039, c29='入库质检'||v_placeCode||'-'||v_containerCode||':'||v_result, uptdate=sysdate where substr(c2,2)=replace(v_orderCode,'S','');
              end if;
          
          else
              --回退
              null;
          end if;
          ---------------------------------------------------------------------------------------------------------
      
      elsif v_dmCode = '015_RKSH' then --入库收货
          v_containerCode := p1;
          v_placeCode := p2;
          v_orderCode := p3;
          ---------------------------------------------------------------------------------------------------------
          if a_reset = 0 then
              --检验有效性
              select count(*) into counter from YS_Container where c1=v_containerCode and (c4=v_dmStatus_0 or c4=v_dmStatus_1);
              if counter = 0 then
                  Message := Message||'容器['||v_containerCode||']不可用或状态不符！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验有效性
              select count(*) into counter from YS_Place where c1=v_placeCode and (c4=v_dmStatus_0 or c4=v_dmStatus_1) and c2<>2 and c5=v_containerCode;
              if counter = 0 then
                  Message := Message||'位置['||v_placeCode||']不可用或状态不符！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              --检查已质检的订单
              select count(*) into counter from BO_Order_Ing_QC where c6<>v_containerCode and c2='合格' and c5=1 and instr(v_orderCode,c1)>=1;
              if counter > 0 then
                  Message := Message||'误扫了其他容器的已质检的订单！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;             
              --检查质检订单是否在容器
              select count(*) into counter from BO_Order_Ing_QC where c6=v_containerCode and c2='合格' and c5=1 and instr(v_orderCode,c1)<1;
              if counter > 0 then
                  Message := '漏扫了已质检的订单！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              --更新质检记录
              update BO_Order_Ing_QC set c5=2,uptdate=sysdate where c6=v_containerCode and c5=1;

              --更新容器状态
              insert into ZYS_Container select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Container where c1=v_containerCode) t0;
              update YS_Container set c4=v_dmStatus_1, c5=v_placeCode, c6=c6||v_orderCode||',', c8=F_Order_SellMid_List(c6||v_orderCode), c9=F_Order_BuyMid_List(c6||v_orderCode), c11=F_Order_JHD_List(c6||v_orderCode), uptdate=sysdate where c1=v_containerCode;
              
              --更新位置状态
              insert into ZYS_Place select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Place where c1=v_placeCode) t0;
              update YS_Place set c4=v_dmStatus_1, c5=v_containerCode, uptdate=sysdate where c1=v_placeCode;

              --更新订单状态
              insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing
               where c22 = v_dmStatus_0
                 and instr(v_orderCode, c2)>0) t0;
              update BO_Order_Goods_Ing t set c22=v_dmStatus_1, c29='入库收货'||v_placeCode||'-'||v_containerCode, uptdate=sysdate
               where c22 = v_dmStatus_0
                 and instr(v_orderCode, c2)>0;
              
              commit;
              
              --检查提货单是否提货完成
              insert into ZBO_Order_Ing_THD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_THD t
               where c10=v_dmStatus_0
                and exists (select dataid from BO_Order_Goods_Ing m where m.c28=t.c2 and instr(v_orderCode,m.c2)>0)
                and not exists (select dataid from BO_Order_Goods_Ing m where m.c28=t.c2 and m.c22 between 232023 and v_dmStatus_0) ) t0;
              update BO_Order_Ing_THD t set c10=v_dmStatus_1, uptdate=sysdate 
               where c10=v_dmStatus_0
                and exists (select dataid from BO_Order_Goods_Ing m where m.c28=t.c2 and instr(v_orderCode,m.c2)>0)
                and not exists (select dataid from BO_Order_Goods_Ing m where m.c28=t.c2 and m.c22 between 232023 and v_dmStatus_0);
              --检查提货汇总单是否提货完成
              insert into ZBO_Order_Ing_THHZD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_THHZD t
               where exists (select m.dataid from BO_Order_Goods_Ing m, BO_Order_Ing_THD n where m.c28=n.c2 and n.c1=t.c1 and instr(v_orderCode,m.c2)>0)
                 and not exists (select m.dataid from BO_Order_Goods_Ing m, BO_Order_Ing_THD n where m.c28=n.c2 and n.c1=t.c1 and m.c22 between 232023 and v_dmStatus_0)) t0;
              update BO_Order_Ing_THHZD t set c10=v_dmStatus_1, uptdate=sysdate
               where exists (select m.dataid from BO_Order_Goods_Ing m, BO_Order_Ing_THD n where m.c28=n.c2 and n.c1=t.c1 and instr(v_orderCode,m.c2)>0)
                 and not exists (select m.dataid from BO_Order_Goods_Ing m,BO_Order_Ing_THD n where m.c28=n.c2 and n.c1=t.c1 and m.c22 between 232023 and v_dmStatus_0);
                         
          else
              --回退
              null;
          end if;
          ---------------------------------------------------------------------------------------------------------
      
      elsif v_dmCode = '016_RKSHZ' then --入库收货（直接供应商）
          null;
      
      elsif v_dmCode = '017_JSRK' then --拒收入库
          --v_psdCode := p1;
          v_containerCode := p1;
          v_orderCode := p2;
          v_placeCode := p3;
          ---------------------------------------------------------------------------------------------------------
          if a_reset = 0 then
              --检验有效性
              select count(*) into counter from YS_Container where c1=v_containerCode and c4=0;
              if counter = 0 then
                  Message := Message||'容器['||v_containerCode||']不可用或状态不符！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验有效性
              select count(*) into counter from YS_Place where c1=v_placeCode and c4=0 and c2<>2;
              if counter = 0 then
                  Message := Message||'位置['||v_placeCode||']不可用或状态不符！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验订单状态
              select count(dataid),max(c2) into counter,tmp from BO_Order_Goods_Reback where c22<>v_dmStatus_0 and instr(v_orderCode,c2)>0;
              if counter > 0 then
                  Message := Message||'订单['||tmp||']状态不符！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              --更新容器状态 位置 订单
              insert into ZYS_Container select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Container where c1=v_containerCode) t0;
              update YS_Container set c4=v_dmStatus_1, c5=v_placeCode, c6=c6||v_orderCode, c8=F_Order_SellMid_List(c6||v_orderCode), c9=F_Order_BuyMid_List(c6||v_orderCode), c11=F_Order_JHD_List(c6||v_orderCode), uptdate=sysdate where c1=v_containerCode;
              --更新退单状态
              insert into ZBO_Order_Goods_Reback select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Reback
               where c22 = v_dmStatus_0
                 and instr(v_orderCode,c2)>0) t0;
              update BO_Order_Goods_Reback t set c22=v_dmStatus_1, c29='拒收入库'||v_placeCode||'-'||v_containerCode, uptdate=sysdate
               where c22 = v_dmStatus_0
                 and instr(v_orderCode,c2)>0;
              --更新订单状态
              insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing
               where c22 = v_dmStatus_0
                 and instr(v_orderCode,c2)>0) t0;
              update BO_Order_Goods_Ing t set c22=v_dmStatus_1, c29='拒收入库'||v_placeCode||'-'||v_containerCode, uptdate=sysdate
               where c22 = v_dmStatus_0
                 and instr(v_orderCode,c2)>0;
              
              --更新配送单
              insert into ZBO_Order_Ing_PSD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_PSD t where (c1,c4) in (select c31,c4 from BO_Order_Goods_Reback m where instr(v_orderCode,m.c2)>0) and not exists (select dataid from BO_Order_Goods_Reback m where m.c4=t.c4 and m.c31=t.c1 and m.c22=v_dmStatus_0)) t0;
              update BO_Order_Ing_PSD t set c10=v_dmStatus_1, uptdate=sysdate where (c1,c4) in (select c31,c4 from BO_Order_Goods_Reback m where instr(v_orderCode,m.c2)>0) and not exists (select dataid from BO_Order_Goods_Reback m where m.c4=t.c4 and m.c31=t.c1 and m.c22=v_dmStatus_0);
          
          else
              --回退
              null;
          end if;
          ---------------------------------------------------------------------------------------------------------
      
      elsif v_dmCode = '018_BCFJ' then --波次分拣
          v_containerCode := p1;
          v_container2Code := p2;
          v_orderCode := p3;
          v_placeCode := p4; --暂不用
          ---------------------------------------------------------------------------------------------------------
          if a_reset = 0 then            
              
              --检验有效性
              select count(*) into counter from YS_Container where c1=v_containerCode and c4=v_dmStatus_0;
              if counter = 0 then
                  Message := Message||'容器['||v_containerCode||']不可用或状态不符！';
                  rollback;
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
     
              --检查订单数目
              select count(*), max(a.c11) into counter,tmp from BO_Order_Goods_Ing a, YS_Container b  where b.c1=v_containerCode and instr(b.c6,a.c2)>0 and instr(v_orderCode,a.c2)=0;
              if counter > 0 then
                  Message := Message||'原容器中有'||counter||'个订单[如:'||tmp||']未扫完！';
                  rollback;
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              --原容器的集货单列表
              select c11 into tmp from YS_Container where c1 = v_containerCode;
              if length(tmp) = 0 then
                  Message := Message||'原容器没有买家MID数据！';
                  rollback;
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              v_spliter := ',';
              splitlen := length(v_spliter||'a')-1;
                
              v_container2Code := v_container2Code || v_spliter;
              v_placeCode := v_placeCode || v_spliter;
              
              while instr(v_container2Code, v_spliter)>0 loop
                  p1 := substr(v_container2Code, 1, instr(v_container2Code, v_spliter)-1);--目标容器编号
                  p2 := substr(v_placeCode, 1, instr(v_placeCode, v_spliter)-1);--目标位置编号
                  p3 := substr(tmp, 1, instr(tmp, v_spliter)-1);--买家集货单
                  
                  --检验有效性
                  select count(*) into counter from YS_Container where c1=p1 and c4=0;
                  if counter = 0 then
                      Message := Message||'容器['||p1||']不可用或状态不符！';
                      rollback;
                      P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                      open ResultCursor for select Message sqlmsg from dual;
                      return;
                  end if;
                   
                  select c4 into p4 from BO_Order_Ing_JHD where c2=p3;
                  insert into ZYS_Container select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Container where c1=p1) t0;
                  update YS_Container set c4=v_dmStatus_1, c6=F_Order_List_ByJHD(v_orderCode, p3), c9=p4, c11=p3, uptdate=sysdate where c1=p1;
                  
                  --更新容器为分拣完成状态 位置 订单
                  --更新订单状态
                  insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing
                   where c22 = v_dmStatus_0
                     and (c4,c30) = (select c4,c1 from BO_Order_Ing_JHD where c2=p3)
                     and instr(v_orderCode,c2)>0) t0;
                  update BO_Order_Goods_Ing t set c22=v_dmStatus_1, c29='波次分拣'||p2||'-'||p1, uptdate=sysdate
                   where c22 = v_dmStatus_0
                     and (c4,c30) = (select c4,c1 from BO_Order_Ing_JHD where c2=p3)
                     and instr(v_orderCode,c2)>0;
                  
                  v_container2Code := substr(v_container2Code, instr(v_container2Code, v_spliter)+splitlen, length(v_container2Code));
                  v_placeCode := substr(v_placeCode, instr(v_placeCode, v_spliter)+splitlen, length(v_placeCode));
                  tmp := substr(tmp, instr(tmp, v_spliter)+splitlen, length(tmp));
              end loop;
              
              --更新位置状态
              insert into ZYS_Place select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Place where c1=(select c5 from YS_Container where c1=v_containerCode)) t0;
              update YS_Place set c4=0, c5='', uptdate=sysdate where c1=(select c5 from YS_Container where c1=v_containerCode);
              
              --释放空的容器
              insert into ZYS_Container select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Container where c1=v_containerCode) t0;
              update YS_Container set c4=0,c5='',c6='',c7='',c8='',c9='',c10=0,c11='',uptdate=sysdate where c1=v_containerCode;
          else
              --回退
              null;
          end if;
          ---------------------------------------------------------------------------------------------------------
      
      elsif v_dmCode = '019_ZX' then --装箱
          v_containerCode := p1;
          v_packageCode := p2;
          v_orderCode := p3;
          v_container2Code := p4;
          ---------------------------------------------------------------------------------------------------------
          if a_reset = 0 then             
              
              --检验有效性
              select count(*),max(c9),max(c11) into counter,v_mid,v_jhdCode from YS_Container where c1=v_containerCode and c4=v_dmStatus_0;
              if counter = 0 then
                  Message := Message||'原容器['||v_containerCode||']不可用或状态不符！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验有效性
              select count(*) into counter from YS_Container where c1=v_container2Code and (c4=0 or c4=v_dmStatus_1);
              if counter = 0 then
                  Message := Message||'目标容器['||v_container2Code||']不可用或状态不符！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验有效性
              select count(*) into counter from YS_Package where c1=v_packageCode and c4=0;
              if counter = 0 then
                  Message := Message||'物流箱['||v_packageCode||']不可用或状态不符！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              --检查订单数目
              select count(dataid) into counter from BO_Order_Goods_Ing where instr(v_orderCode,c2)>0;
              select count(a.dataid) into v_num from BO_Order_Goods_Ing a,YS_Container b where b.c1 = v_containerCode and instr(b.c6,a.c2)>0;
              if counter <> v_num then
                  if pbtn = 'PB-6' then --提交按钮
                      Message := Message||'原容器中有'||to_char(v_num-counter)||'个订单未扫完！';
                      rollback;
                      P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                      open ResultCursor for select Message sqlmsg from dual;
                      return;
                  else
                      p_reset := '2';
                  end if;
              else
                  p_reset := '0';
              end if;
          
              --检查订单买家是否一致  --mid / 集货汇总单号
              select count(distinct b.c2) into counter from BO_Order_Goods_Ing a, BO_Order_Ing_JHD b where a.c30=b.c1 and a.c3=b.c3 and a.c25=b.c22 and instr(v_orderCode,a.c2)>0;
              if counter > 1 then
                  Message := Message||'订单不是同一集货单！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              select c1 into v_jhhzdCode from BO_Order_Ing_JHD where c2=v_jhdCode;
              --检查原容器                  
              select count(dataid) into counter from BO_Order_Goods_Ing where instr(v_orderCode,c2)>0 and c4=v_mid and c30=v_jhhzdCode;
              if counter = 0 then
                  Message := Message||'原容器与订单不是同一集货单！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检查物流箱的买家
              select count(*) into counter from YS_Package where c1=v_packageCode and (c4=0 or c4=v_dmStatus_1 and c7=v_mid and c8=v_jhhzdCode);
              if counter = 0 then
                  Message := Message||'订单与物流箱不是同一集货单！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检查目标容器
              select count(dataid) into counter from YS_Container where c1=v_container2Code and (c9 is null or c9=to_char(v_mid) and c11=v_jhhzdCode);
              if counter = 0 then
                  Message := Message||'目标容器与订单不是同一集货单！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              --更新容器
              v_spliter := ',';
              splitlen := length(v_spliter||'a')-1;
              tmp := v_orderCode || v_spliter;
              while instr(tmp, v_spliter)>0 loop
                  p1 := substr(tmp, 1, instr(tmp, v_spliter)-1);--订单编号                   
                  --更新容器订单
                  insert into ZYS_Container select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Container where c1=v_containerCode) t0;
                  update YS_Container set c6=replace(replace(c6, p1, ''), ',,', ''), uptdate=sysdate where c1=v_containerCode;
                  tmp := substr(tmp, instr(tmp, v_spliter)+splitlen, length(tmp));
              end loop;
              
              --更新目标容器
              insert into ZYS_Container select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Container where c1=v_container2Code) t0;
              update YS_Container set c4=v_dmStatus_1, c6=c6||v_packageCode||',', c9=v_mid, c10=0, c11=v_jhhzdCode, uptdate=sysdate where c1=v_container2Code;
              --更新物流箱
              insert into ZYS_Package select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Package where c1=v_packageCode) t0;
              update YS_Package set c4=v_dmStatus_1, c5=v_container2Code, c6=c6||v_orderCode||',', c7=v_mid, c8=v_jhhzdCode, uptdate=sysdate where c1=v_packageCode;
              
              --更新订单状态
              insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing
               where c22 = v_dmStatus_0
                 and instr(v_orderCode,c2)>0 ) t0;
              update BO_Order_Goods_Ing t set c22=v_dmStatus_1, c29='装箱'||v_container2Code||'-'||v_packageCode, uptdate=sysdate
               where c22 = v_dmStatus_0
                 and instr(v_orderCode,c2)>0;

              --------------------------------- 按照称重结果重新计算订单价格 begin -----------------------------------
              --更新子订单实际数量（原食）
              update BO_Order_Goods_Ing t set c16=c40*decode(c13, 183001,2, 183002,1, 183021,2000, 1) where c13 in (183001,183002,183021) and instr(v_orderCode,c2)>0 and (c10<0 or exists(select dataid from A_Goods_PS m where m.dataid=t.c10 and m.c18=1)); --原食实际数量(斤)
              update BO_Order_Goods_Ing t set c16=floor(10*c16)/10 where instr(v_orderCode,c2)>0;
              update BO_Order_Goods_Ing t set c15=c16,c17=c16 where c13 in (183001,183002,183021) and instr(v_orderCode,c2)>0 and (c10<0 or exists(select dataid from A_Goods_PS m where m.dataid=t.c10 and m.c18=1)); --原食实际数量(斤)
              --更新订单金额
              update BO_Order_Goods_Ing t set c33=c15*c32, c35=c16*c34, c37=c17*c36, c50=c15,c51=c15*c32,c52=c17,c53=c17*c36,c54=c17*c34 where instr(v_orderCode,c2)>0; --原食结算价、买家结算价
              --更新总订单实际金额
              insert into ZBO_Order_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing where c23=v_jhhzdCode and c3=v_mid) t0;
              update BO_Order_Ing t set (c8,c9,c12,c13,c14)=(select sum(c40), sum(c41), sum(c37), sum(c35), sum(c33) from BO_Order_Goods_Ing m where m.c1=t.c1) where c23=v_jhhzdCode and c3=v_mid; --原食结算价、买家结算价
              --更新集货单的总金额
              update BO_Order_Ing_JHD t set c13=(select sum(c37) from BO_Order_Goods_Ing m where m.c30=t.c1 and m.c4=t.c4) where c1=v_jhhzdCode and c4=v_mid;
              ----------------------------------------- 称重取值 end -------------------------------------------------
              
              commit;
              
              --释放空的容器
              insert into ZYS_Container select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Container where c1=v_containerCode and (c6 is null or c6=',')) t0;
              update YS_Container set c4=0,c5='',c6='',c7='',c8='',c9='',c10=0,c11='',uptdate=sysdate where c1=v_containerCode and (c6 is null or c6=',');
          
          else
              --回退
              null;
          end if;
          ---------------------------------------------------------------------------------------------------------
                
      elsif v_dmCode = '020_KNJH' then --库内集货
          v_containerCode := p1;
          v_placeCode := p2;
          v_container2Code := p3;
          v_packageCode := p4;
          ---------------------------------------------------------------------------------------------------------
          if a_reset = 0 then
              --检验有效性
              select count(*) into counter from YS_Container where c1=v_containerCode and c4=v_dmStatus_0;
              if counter = 0 then
                  Message := Message||'原容器['||v_containerCode||']不可用！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              if v_containerCode <> v_container2Code then
                  --检验有效性
                  select count(*) into counter from YS_Container where c1=v_container2Code and (c4=0 or c4=v_dmStatus_1);
                  if counter = 0 then
                      Message := Message||'目标容器['||v_container2Code||']不可用！';
                      P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                      open ResultCursor for select Message sqlmsg from dual;
                      return;
                  end if;
              end if;
              --检验有效性
              select count(*) into counter from YS_Place where c1=v_placeCode and c2=2;
              if counter = 0 then
                  Message := Message||'位置['||v_placeCode||']不可用！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              select c9,c11 into v_mid,v_jhhzdCode from YS_Container where c1=v_containerCode;
              --检查位置是否正确
              select c1 into p1 from YS_Place where c2=2 and c6=v_mid and c7=v_jhhzdCode;
              if p1 <> v_placeCode then
                  Message := Message||'位置不匹配！当前'||v_placeCode||'，应'||p1;
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              --检查物流箱是否正确
              select count(*) into counter from YS_Package where instr(v_packageCode,c1)>0 and c5<>v_containerCode;
              if counter > 0 then
                  Message := Message||'物流箱'||p1||'与原容器不匹配！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              --检查物流箱数目
              select count(dataid) into counter from YS_Package where instr(v_packageCode,c1)>0;
              select count(a.dataid) into v_num from YS_Package a, YS_Container b where b.c1 = v_containerCode and instr(b.c6,a.c1)>0;
              if counter <> v_num then
                  if v_containerCode = v_container2Code then
                      Message := Message||'原容器中有'||to_char(v_num-counter)||'个物流箱未扫完！';
                      rollback;
                      P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                      open ResultCursor for select Message sqlmsg from dual;
                      return;
                  else
                      p_reset := '2';
                  end if;
              else
                  p_reset := '0';
              end if;
                
              --更新容器
              if v_containerCode <> v_container2Code then
                
                --检查目标容器是否正确
                select count(*) into counter from YS_Container where c1=v_container2Code and (c9=v_mid and c11=v_jhhzdCode or c9 is null);
                if counter = 0 then
                    Message := Message||'目标容器'||v_container2Code||'与原容器不属于同一买家/集货单！';
                    P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                    open ResultCursor for select Message sqlmsg from dual;
                    return;
                end if;
              
                v_spliter := ',';
                splitlen := length(v_spliter||'a')-1;
                tmp := v_packageCode || v_spliter;
                while instr(tmp, v_spliter)>0 loop
                    p1 := substr(tmp, 1, instr(tmp, v_spliter)-1);--物流箱编号
                    --更新原容器内的物流箱
                    insert into ZYS_Container select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Container where c1=v_containerCode) t0;
                    update YS_Container set c6=replace(c6, p1||',', ''), uptdate=sysdate where c1=v_containerCode;
                    tmp := substr(tmp, instr(tmp, v_spliter)+splitlen, length(tmp));
                end loop;
                
                insert into ZYS_Container select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Container where c1=v_container2Code) t0;
                update YS_Container set c4=v_dmStatus_1, c5=v_placeCode, c6=c6||v_packageCode||',', c9=v_mid, c11=v_jhhzdCode, uptdate=sysdate where c1=v_container2Code;
              else
                insert into ZYS_Container select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Container where c1=v_containerCode) t0;
                update YS_Container set c4=v_dmStatus_1, c5=v_placeCode, uptdate=sysdate where c1=v_containerCode;
              end if;
              
              --更新位置状态
              insert into ZYS_Place select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Place where c1=v_placeCode) t0;
              update YS_Place set c4=v_dmStatus_1, c5=c5||v_container2Code||',', c6=v_mid, uptdate=sysdate where c1=v_placeCode and (c5 is null or instr(c5,v_container2Code)<1);
              
              --更新物流箱状态
              insert into ZYS_Package select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Package where instr(v_packageCode, c1)>0) t0;
              update YS_Package set c4=v_dmStatus_1, c5=v_container2Code, uptdate=sysdate where instr(v_packageCode, c1)>0;
       
              --更新订单状态
              insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing t
               where c22 = v_dmStatus_0
                 and exists (select dataid from YS_Package a where instr(v_packageCode, a.c1)>0 and instr(a.c6, t.c2)>0)) t0;
              update BO_Order_Goods_Ing t set c22=v_dmStatus_1, c29=(select '库内集货'||v_placeCode||'-'||v_container2Code||'-'||m.c1 from YS_Package m where instr(m.c6, t.c2)>0), uptdate=sysdate
               where c22 = v_dmStatus_0
                 and exists (select dataid from YS_Package a where instr(v_packageCode, a.c1)>0 and instr(a.c6, t.c2)>0);
              
              commit;
              
              --集货是否完成(并检查232050缺货订单)
              select count(*), sum(decode(c22,232050,0,1)) into counter,v_num from BO_Order_Goods_Ing where c4=v_mid and c30=v_jhhzdCode and c22<>v_dmStatus_1;
              if counter = 0 then
                insert into ZYS_Container select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Container where c9=v_mid and c4=v_dmStatus_1) t0;
                update YS_Container set c10=1 where c9=v_mid and c11=v_jhhzdCode;
              elsif v_num = 0 then --仅剩缺货订单未集货
                insert into ZYS_Container select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Container where c9=v_mid and c4=v_dmStatus_1) t0;
                update YS_Container set c10=1 where c9=v_mid and c11=v_jhhzdCode; --缺货
              end if;
              
              --集货汇总单是否集货完成
              select count(*), sum(decode(c22,232050,0,1)) into counter,v_num from BO_Order_Goods_Ing where c30=v_jhhzdCode and c22<>v_dmStatus_1;
              if counter = 0 then
                insert into ZBO_Order_Ing_JHHZD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_JHHZD where c1=v_jhhzdCode) t0;
                update BO_Order_Ing_JHHZD set c2=v_dmStatus_1 where c1=v_jhhzdCode;
              elsif v_num = 0 then --仅剩缺货订单未集货
                insert into ZBO_Order_Ing_JHHZD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_JHHZD where c1=v_jhhzdCode) t0;
                update BO_Order_Ing_JHHZD set c2=v_dmStatus_1 where c1=v_jhhzdCode; --缺货 c2=232050
              end if;
              
              --释放空的容器
              insert into ZYS_Container select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Container where c1=v_containerCode and (c6 is null or c6=',')) t0;
              update YS_Container set c4=0,c5='',c6='',c7='',c8='',c9='',c10=0,c11='',uptdate=sysdate where c1=v_containerCode and (c6 is null or c6=',');
          
          else
              --回退
              null;
          end if;
          ---------------------------------------------------------------------------------------------------------
          
      elsif v_dmCode = '036_PX' then --拼箱
          v_packageCode := p1;
          v_orderCode := p2;
          ---------------------------------------------------------------------------------------------------------
          if a_reset = 0 then
              --检验有效性
              select count(*),max(c2),max(c5),max(c7),max(c8) into counter,v_result,v_containerCode,v_mid,v_jhhzdCode from YS_Package where c1=v_packageCode and c4=v_dmStatus_0 and c2<>9;
              if counter = 0 then
                  Message := Message||'物流箱['||v_packageCode||']不可用或状态不符！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验订单
              select count(*) into counter from BO_Order_Goods_Ing where instr(v_orderCode,c2)>0;
              select count(*) into v_num from BO_Order_Goods_Ing where instr(v_orderCode,c2)>0 and c4=v_mid and c30=v_jhhzdCode;
              if counter <> v_num then
                  Message := Message||'物流箱与订单的集货单不符！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              select c5 into v_placeCode from YS_Container where c1=v_containerCode;
              
              --更新原物流箱
              v_spliter := ',';
              splitlen := length(v_spliter||'a')-1;
              tmp := v_orderCode || v_spliter;
              while instr(tmp, v_spliter)>0 loop
                  p1 := substr(tmp, 1, instr(tmp, v_spliter)-1);--订单编号
                  --原物流箱 p2编号 p3类型 p4容器
                  select c1,c2,c5 into p2,p3,p4 from YS_Package where instr(c6,p1)>0;
                  if to_number(v_result) <> to_number(p3) then
                    Message := Message||'目的物流箱与订单原物流箱类型不符！';
                    rollback;
                    P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                    open ResultCursor for select Message sqlmsg from dual;
                    return;
                  end if;
                  
                  --更新原物流箱订单
                  insert into ZYS_Package select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Package where c1=p2) t0;
                  update YS_Package set c6=replace(c6, p1||',', ''), uptdate=sysdate where c1=p2;
                  --释放空的物流箱
                  insert into ZYS_Package select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Package where c1=p2 and c4=v_dmStatus_0 and (c6 is null or c6=',')) t0;
                  update YS_Package set c4=0,c5='',c6='',c7='',c8='',c9='',c10=0,c11='',uptdate=sysdate where c1=p2 and c4=v_dmStatus_0 and (c6 is null or c6=',');
                  --更新原物流箱的容器
                  insert into ZYS_Container select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Container a where c1=p4 and c4=v_dmStatus_0 and 0<(select count(*) from YS_Package b where c1=p2 and instr(a.c6,b.c1)>0 and b.c4=0)) t0;
                  update YS_Container a set c6=replace(c6,p2||',',''),uptdate=sysdate
                   where c1=p4 and c4=v_dmStatus_0 and 0<(select count(*) from YS_Package b where c1=p2 and instr(a.c6,b.c1)>0 and b.c4=0);
                  --释放空的容器
                  update YS_Container set c4=0,c5='',c6='',c7='',c8='',c9='',c10=0,c11='',uptdate=sysdate where c1=p4 and c4=v_dmStatus_0 and (c6 is null or c6=',');
                  --更新容器的位置
                  insert into ZYS_Place select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Place a where c1=v_placeCode and c4=v_dmStatus_0 and 0<(select count(*) from YS_Container b where c1=p4 and instr(a.c5,b.c1)>0 and b.c4=0)) t0;
                  update YS_Place a set c5=replace(c5,p4||',',''),uptdate=sysdate 
                   where c1=v_placeCode and c4=v_dmStatus_0 and 0<(select count(*) from YS_Container b where c1=p4 and instr(a.c5,b.c1)>0 and b.c4=0);
                  
                  tmp := substr(tmp, instr(tmp, v_spliter)+splitlen, length(tmp));
              end loop;
              
              --更新目的物流箱
              insert into ZYS_Package select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Package where c1=v_packageCode) t0;
              update YS_Package set c6=c6||v_orderCode||',', uptdate=sysdate where c1=v_packageCode;
              
              --更新订单状态
              insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing
               where instr(v_orderCode,c2)>0 ) t0;
              update BO_Order_Goods_Ing t set c29=substr(c29,1,instr(c29,'-'))||'拼箱'||v_containerCode||'-'||v_packageCode, uptdate=sysdate
               where instr(v_orderCode,c2)>0;

          else
              --回退
              null;
          end if;
          ---------------------------------------------------------------------------------------------------------

      elsif v_dmCode = '032_QHSPCL' then --缺货审批处理
          v_jhhzdCode := p1;
          ---------------------------------------------------------------------------------------------------------
          if a_reset = 0 then
              --检验集货汇总单
              select count(*) into counter from BO_Order_Ing_JHHZD where c1=v_jhhzdCode;-- and c2=v_dmStatus_0;
              if counter = 0 then
                  Message := Message||'集货汇总单['||v_jhhzdCode||']不存在或状态不符！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              --更新子订单状态
              insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing t
               where c22 = v_dmStatus_0
                 and c30 = v_jhhzdCode) t0;
              update BO_Order_Goods_Ing t set c11=replace(c11,'[报缺]','[今日缺货]'), c21=230101, c22=v_dmStatus_1, c15=0,c16=0,c17=0,c33=0,c35=0,c37=0, c50=0,c51=0,c52=0,c53=0,c54=0, c29=to_char(sysdate,'yyyy-mm-dd hh24:mi:ss') ||' 缺货审批处理', uptdate=sysdate
               where c22 = v_dmStatus_0
                 and c30 = v_jhhzdCode;
              --更改订单金额
              insert into ZBO_Order_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing where c1 in (select distinct c1 from BO_Order_Goods_Ing where c30=v_jhhzdCode) ) t0;
              update BO_Order_Ing a set (c5,c6,c7,c8,c9,c11,c12,c13,c14)=(select sum(b.c18*b.c14),sum(b.c39),count(distinct c2||c8||c32),sum(c40),sum(c41),sum(c38),sum(c37),sum(c35),sum(c33) from BO_Order_Goods_Ing b where b.c1=a.c1) where c1 in (select distinct c1 from BO_Order_Goods_Ing where c30=v_jhhzdCode);
              --更改集货单金额
              insert into ZBO_Order_Ing_JHD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_JHD where c1=v_jhhzdCode) t0;
              update BO_Order_Ing_JHD a set (c11,c13)=(select count(dataid),sum(c37) from BO_Order_Goods_Ing m where m.c30=a.c1 and m.c4=a.c4) where c1=v_jhhzdCode;
              
              commit;
              
              --集货区的容器是否集货完成(并检查232050缺货订单)
              insert into ZYS_Container select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Container where c11=v_jhhzdCode and c9 in (select distinct c4 from BO_Order_Goods_Ing where c30=v_jhhzdCode and c22<>232046 group by c4 having sum(decode(c22,232050,0,1))=0)) t0;
              update YS_Container set c10=1 where c11=v_jhhzdCode and c9 in (select distinct c4 from BO_Order_Goods_Ing where c30=v_jhhzdCode and c22<>232046 group by c4 having sum(decode(c22,232050,0,1))=0);
              
              --集货汇总单是否全部缺货
              select count(*), sum(decode(c22,232050,1,0)) into counter,v_num from BO_Order_Goods_Ing where c30=v_jhhzdCode;
              if counter = v_num then
                insert into ZBO_Order_Ing_JHHZD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_JHHZD where c1=v_jhhzdCode) t0;
                update BO_Order_Ing_JHHZD set c2=232050 where c1=v_jhhzdCode;--缺货
              end if;
              --集货汇总单是否集货完成
              select count(*), sum(decode(c22,232050,0,1)) into counter,v_num from BO_Order_Goods_Ing where c30=v_jhhzdCode and c22<>232046;
              if counter = 0 then
                insert into ZBO_Order_Ing_JHHZD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_JHHZD where c1=v_jhhzdCode) t0;
                update BO_Order_Ing_JHHZD set c2=232046 where c1=v_jhhzdCode;--准备出库
              elsif v_num = 0 then --仅剩缺货订单未集货
                insert into ZBO_Order_Ing_JHHZD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_JHHZD where c1=v_jhhzdCode) t0;
                update BO_Order_Ing_JHHZD set c2=232046 where c1=v_jhhzdCode;--准备出库
              end if;
              
          else
              --回退
              null;
          end if;
          ---------------------------------------------------------------------------------------------------------
      
      elsif v_dmCode = '021_ZBCK' then --发货（出库）
          v_carCode := p1;
          v_containerCode := p2;
          v_packageCode := p3;
          ---------------------------------------------------------------------------------------------------------
          if a_reset = 0 then
              --检验有效性
              select count(*) into counter from YS_Car where c1=v_carCode and (c4=0 or c4=v_dmStatus_1);
              if counter = 0 then
                  Message := Message||'车辆['||v_carCode||']不存在或状态不符！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验有效性
              select count(*) into counter from YS_Container where c1=v_containerCode and c4=v_dmStatus_0;
              if counter = 0 then
                  Message := Message||'容器['||v_containerCode||']不存在或状态不符！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;

              --位置编号 集货汇总单号 集货单号
              select c5,c9,c11 into v_placeCode,v_mid,v_jhhzdCode from YS_Container where c1=v_containerCode;
              select c2 into v_jhdCode from BO_Order_Ing_JHD where c1=v_jhhzdCode and c4=v_mid;
              --检查集货汇总单是否派给了车
              select count(*) into counter from BO_Order_Ing_JHHZD where c1=v_jhhzdCode and instr(','||c8,','||v_carCode||',')>0;
              if counter = 0 then
                  Message := Message||'派送的车辆不匹配！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              --检查容器的物流箱是否扫完整
              select count(a.dataid),min(b.c1) into counter, tmp from YS_Container a, YS_Package b
               where a.c1=v_containerCode
                 and a.c6 like '%'||b.c1||'%'
                 and instr(v_packageCode, b.c1)=0;
              if counter > 0 then
                  Message := Message||'容器['||v_containerCode||']还有'||counter||'个物流箱[比如'||tmp||']没扫描！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              --更新容器
              v_spliter := ',';
              splitlen := length(v_spliter||'a')-1;
              tmp := v_packageCode || v_spliter;
              while instr(tmp, v_spliter)>0 loop
                  p1 := substr(tmp, 1, instr(tmp, v_spliter)-1);--物流箱编号
                  select c5 into p2 from YS_Package where c1=p1;--所在容器
                  if p2 <> v_containerCode then
                    Message := Message||'物流箱['||p1||']与容器['||v_containerCode||']不匹配！';
                    P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                    rollback;
                    open ResultCursor for select Message sqlmsg from dual;
                    return;
                  end if;
                                  
                  --更新容器内的物流箱
                  insert into ZYS_Container select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Container where c1=v_containerCode) t0;
                  update YS_Container set c6=replace(c6, p1||',', ''), uptdate=sysdate where c1=v_containerCode;

                  tmp := substr(tmp, instr(tmp, v_spliter)+splitlen, length(tmp));
              end loop;
              
              --更新位置所装容器
              insert into ZYS_Place select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Place where c1=v_placeCode) t0;
              update YS_Place set c5=replace(c5, v_containerCode||',', ''), uptdate=sysdate where c1=v_placeCode;
              --更新位置状态
              insert into ZYS_Place select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Place where c1=v_placeCode and c5 is null) t0;
              update YS_Place set c4=0,c5='',c6='',uptdate=sysdate where c1=v_placeCode and c5 is null; --不清c7
              --更新集货通道状态
              select count(*) into counter from YS_Place where c2=2 and c4<>0 and c7=v_jhhzdCode;
              if counter = 0 then
                insert into ZYS_Place select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Place where c2=2 and c7=v_jhhzdCode) t0;
                update YS_Place set c7='' where c2=2 and c7=v_jhhzdCode; --清c7
              end if;
              
              --配送汇总单号
              select c8 into v_pshzdCode from YS_Car where c1=v_carCode;
              if v_pshzdCode is null then
                select NVL(max(c31), 'PSZ'||to_char(sysdate,'yymmdd')||'0000') into v_pshzdCode from BO_Order_Goods_Ing where c31 like 'PSZ'||to_char(sysdate,'yymmdd')||'%';
                v_pshzdCode := 'PSZ'||(to_number(substr(v_pshzdCode,4,10))+1);
              end if;
              --更新车辆
              insert into ZYS_Car select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Car where c1=v_carCode) t0;
              update YS_Car set c7=c7||v_jhhzdCode||',' where c1=v_carCode and (c7 is null or instr(c7,v_jhhzdCode)<1);
              update YS_Car set c6=c6||v_mid||',' where c1=v_carCode and (c6 is null or instr(','||c6,','||v_mid||',')<1);
              update YS_Car set c4=v_dmStatus_1, c8=v_pshzdCode, uptdate=sysdate where c1=v_carCode;
              
              --更新物流箱
              insert into ZYS_Package select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Package where instr(v_packageCode, c1)>0 ) t0;
              update YS_Package set c4=v_dmStatus_1, c5=v_carCode, c8=v_pshzdCode, uptdate=sysdate where instr(v_packageCode, c1)>0;
              
              --更新订单状态
              insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing t
               where c22 = v_dmStatus_0
                 and exists (select dataid from YS_Package a where instr(v_packageCode, a.c1)>0 and instr(a.c6, t.c2)>0)) t0;
              update BO_Order_Goods_Ing t set c22=v_dmStatus_1, c31=v_pshzdCode, c29='发货'||v_carCode||substr(c29,instr(c29, v_containerCode)+length(v_containerCode)), uptdate=sysdate
               where c22 = v_dmStatus_0
                 and exists (select dataid from YS_Package a where instr(v_packageCode, a.c1)>0 and instr(a.c6, t.c2)>0);
              --更新缺货订单状态
              insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing t where c4=v_mid and c22=232050 and c30=v_jhhzdCode) t0;
              update BO_Order_Goods_Ing t set c31=v_pshzdCode where c4=v_mid and c22=232050 and c30=v_jhhzdCode; --缺货
              
              --更新集货单的配送汇总单号
              insert into ZBO_Order_Ing_JHD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_JHD where c2=v_jhdCode) t0;
              update BO_Order_Ing_JHD set c16=v_pshzdCode, uptdate=sysdate where c2=v_jhdCode;
              --更新集货单状态
              select count(*) into counter from BO_Order_Goods_Ing where c30=v_jhhzdCode and c4=v_mid and (c22<>v_dmStatus_1 and c22<>232050); --缺货除外
              if counter = 0 then
                insert into ZBO_Order_Ing_JHD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_JHD where c2=v_jhdCode) t0;
                update BO_Order_Ing_JHD set c10=v_dmStatus_1, uptdate=sysdate where c2=v_jhdCode;
              end if;
              --更新集货汇总单状态
              insert into ZBO_Order_Ing_JHHZD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_JHHZD where c1=v_jhhzdCode and instr(c12,v_pshzdCode)<1) t0;
              update BO_Order_Ing_JHHZD set c12=c12||v_pshzdCode||',', uptdate=sysdate where c1=v_jhhzdCode and instr(c12,v_pshzdCode)<1;
              --集货汇总单是否装车完成
              select count(*) into counter from BO_Order_Goods_Ing where c30=v_jhhzdCode and (c22<>v_dmStatus_1 and c22<>232050); --缺货除外
              if counter = 0 then
                insert into ZBO_Order_Ing_JHHZD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_JHHZD where c1=v_jhhzdCode) t0;
                update BO_Order_Ing_JHHZD set c2=v_dmStatus_1, uptdate=sysdate where c1=v_jhhzdCode;
              end if;

              --释放空的容器
              insert into ZYS_Container select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Container where c1=v_containerCode and (c6 is null or c6=',')) t0;
              update YS_Container set c4=0,c5='',c6='',c7='',c8='',c9='',c10=0,c11='',uptdate=sysdate where c1=v_containerCode and (c6 is null or c6=',');
                        
          else
              --回退
              null;
          end if;
          ---------------------------------------------------------------------------------------------------------
      elsif v_dmCode = '028_PSDSC' then --出库单生成
          v_carCode := p1;
          ---------------------------------------------------------------------------------------------------------
          if a_reset = 0 then
              --检验有效性
              select count(*),max(c8) into counter,v_pshzdCode from YS_Car where c1=v_carCode and c4=v_dmStatus_0;
              if counter = 0 then
                  Message := Message||'车辆['||v_carCode||']不存在或状态不符！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              --是否装载完全（以买家为单位）
              select count(distinct a.c2),min(b.c1) into counter,tmp from BO_Order_Ing_JHD a, YS_Container b where a.c1=b.c11 and to_char(a.c4)=b.c9 and a.c16=v_pshzdCode and a.c10<>v_dmStatus_0;
              if counter > 0 then
                  Message := Message||'车辆有'||counter||'个买家[如容器'||tmp||']未装载完整！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --是否装载完全（以买家为单位）（大客户）
              select count(a.dataid),max(a.c11) into counter,tmp from BO_Order_Goods_Ing a, BO_Order_Ing_JHD b where a.c30=b.c1 and a.c4=b.c4 and a.c25=b.c9 and instr(b.c16,v_pshzdCode)>0 and (a.c22=232047);
              if counter > 0 then
                  Message := Message||'车辆未装载完整[如'||tmp||']未装载！';
                  rollback;
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;

              --清空未装车的其他集货汇总单
              insert into ZBO_Order_Ing_JHHZD select seq_z_datahis_iid.nextval,a_logStr||'[清空车辆]',t0.* from (select * from BO_Order_Ing_JHHZD where c8=v_carCode and c2<>9 and c12 is null) t0;
              update BO_Order_Ing_JHHZD set c8=substr(replace(','||c8,','||v_carCode||',',','), 2), uptdate=sysdate where instr(','||c8,v_carCode)>0 and c2<>9 and c12 is null;
              
              /* --允许一个集货通道，分配多辆车 2015-06-01 陈上召确认
              --装车是否完整
              select count(a.dataid) into counter from BO_Order_Goods_Ing a, BO_Order_Ing_JHHZD b where a.c30=b.c1 and b.c2=v_dmStatus_0 and b.c8=v_carCode and a.c22<>v_dmStatus_0;
              if counter > 0 then
                  Message := Message||'车辆未装载完整！';
                  rollback;
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;*/
              
              --更新车辆状态
              insert into ZYS_Car select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Car where c1=v_carCode and c4=v_dmStatus_0) t0;
              update YS_Car set c4=v_dmStatus_1, c9=1, uptdate=sysdate where c1=v_carCode and c4=v_dmStatus_0;
              
              --更新物流箱状态
              insert into ZYS_Package select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Package where c5=v_carCode) t0;
              update YS_Package set c4=v_dmStatus_1, c8=v_pshzdCode, uptdate=sysdate where c5=v_carCode;
              
              select to_char(sysdate,'yyyy-mm-dd hh24:mi') into tmp from dual;
              --生成配送汇总单
              insert into BO_Order_Ing_PSHZD(dataid,c1,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12,c13,c14,c18,c19)
              select seqBO_Order_Ing_PSHZD.Nextval,t.* from 
              (select distinct a.c8 pshzdCode,0 status, to_date(tmp,'yyyy-mm-dd hh24:mi') psTime,a.c2 carType,a.c1 carCode,a_operatorID,a_operator,a.c10 carCID, '' premark,F_Order_JHHZD_Area_List(a.c7) area,a.c6 mids,length(translate(a.c6, 'a0123456789', ' ')) num_amid,(select count(m.dataid) from YS_Package m where m.c5=a.c1) num_pack,(select count(n.dataid) from BO_Order_Goods_Ing n where n.c31=a.c8) num, sysdate startTime,null endTime
              from YS_Car a where a.c1=v_carCode
              group by a.c2,a.c1,a.c6,a.c7,a.c8,a.c10
              ) t;
              --生成配送单
              select NVL(max(c2), 'PS'||to_char(sysdate,'yymmdd')||'0000') into v_psdCode from BO_Order_Ing_PSD where c2 like 'PS'||to_char(sysdate,'yymmdd')||'%';
              insert into BO_Order_Ing_PSD(dataid,c2,c1,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12,c13,c14,c15,c16,c17,c18, c20,c21)
              select seqBO_Order_Ing_PSD.Nextval, 'PS'||(to_number(substr(v_psdCode,3))+rownum) psdCode, t.* from
              (select a.c31 pshzdCode, a.c3 amid, a.c4 mid, b.c1 mmName, b.c7 contact, b.c8 phone, b.c5 address,
                      min(a.c25) psTime, 0 status, (select count(m.dataid) from YS_Package m where m.c8=v_pshzdCode and m.c7=a.c4) num_pack, count(a.dataid) num_order,
                      sum(a.c40) weight, sum(a.c37) sumPriceFact_b, count(distinct a.c27) psSeq, null, round(dbms_random.value(1000,9999)) qsCode, decode(sum(decode(a.c22,232050,1,0)),0,'','今日缺货'||sum(decode(a.c22,232050,1,0))||'项，缺货总金额约'||sum(decode(a.c22,232050,a.c38,0))||'元') quehuoDesc,
                      c.c13 payType, c.c14 payDay
                 from BO_Order_Goods_Ing a, B_MMBuyer b, B_MMBuyer_Acctinfo c
                where a.c4=b.dataid and a.c3=b.c2 and b.c2=c.c1
                  and a.c22 = v_dmStatus_0
                  and a.c31 = v_pshzdCode
                  group by a.c31, a.c3, a.c4, b.c1, b.c7, b.c8, b.c5, c.c13,c.c14
              ) t;
              --生成销售退货单
              select NVL(max(c2), 'PTH'||to_char(sysdate,'yymmdd')||'0000') into v_psdCode from BO_Order_Reback_THD where c2 like 'PTH'||to_char(sysdate,'yymmdd')||'%';
              insert into BO_Order_Reback_THD(dataid,c2,c1,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12,c13,c14,c15,c16, c18,c19)
              select seqBO_Order_Reback_THD.Nextval, 'PTH'||(to_number(substr(v_psdCode,4))+rownum) psdCode, t.* from
              (select v_pshzdCode pshzdCode, a.c3 amid, a.c4 mid, b.c1 mmName, b.c7 contact, b.c8 phone, b.c5 address,
                      min(a.c25) psTime, 0 status, 0 num_pack, count(a.dataid) num_order,
                      sum(a.c40) weight, sum(a.c58) sumPriceFact_b, 0 psSeq, null rebackTime,
                      c.c13 payType, c.c14 payDay
                 from BO_Order_Goods_Reback a, B_MMBuyer b, B_MMBuyer_Acctinfo c
                where a.c4=b.dataid and a.c3=b.c2 and b.c2=c.c1
                  and a.c22 = 232070 --准备退货
                  and instr(a.c45,'随')>0
                  and a.c4 in (select c4 from BO_Order_Ing_PSD m where c1=v_pshzdCode)
                  group by a.c45, a.c3, a.c4, b.c1, b.c7, b.c8, b.c5, c.c13,c.c14
              ) t;
              --更新销售退货订单状态
              insert into ZBO_Order_Goods_Reback select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Reback t
               where c22 = 232070 --准备退货
                 and instr(t.c45,'随')>0
                  and t.c4 in (select c4 from BO_Order_Ing_PSD m where c1=v_pshzdCode) ) t0;
              update BO_Order_Goods_Reback t set c22=232071, c45=v_pshzdCode, uptdate=sysdate 
               where c22 = 232070 --准备退货
                 and instr(t.c45,'随')>0
                  and t.c4 in (select c4 from BO_Order_Ing_PSD m where c1=v_pshzdCode);
              --更新订单状态
              insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing t
               where c22 = 232070 --准备退货
                 and instr(t.c45,'随')>0
                  and t.c4 in (select c4 from BO_Order_Ing_PSD m where c1=v_pshzdCode) ) t0;
              update BO_Order_Goods_Ing t set c22=232071, c45=v_pshzdCode, uptdate=sysdate 
               where c22 = 232070 --准备退货
                 and instr(t.c45,'随')>0
                  and t.c4 in (select c4 from BO_Order_Ing_PSD m where c1=v_pshzdCode);
              
              --更新子订单状态
              insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing where c22=v_dmStatus_0 and c31=v_pshzdCode) t0;
              update BO_Order_Goods_Ing t set c22=v_dmStatus_1, uptdate=sysdate 
               where c22 = v_dmStatus_0
                 and c31 = v_pshzdCode;
              --更新总订单状态
              insert into ZBO_Order_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing where (c1,c23) in (select distinct c1,c30 from BO_Order_Goods_Ing a where a.c31=v_pshzdCode) ) t0;
              update BO_Order_Ing t set c17=v_dmStatus_1, c24=v_pshzdCode, uptdate=sysdate where (c1,c23) in (select distinct c1,c30 from BO_Order_Goods_Ing a where a.c31=v_pshzdCode);
          
              --更新集货单状态
              insert into ZBO_Order_Ing_JHD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_JHD 
               where c2 in (select b.c2 from BO_Order_Goods_Ing a, BO_Order_Ing_JHD b where instr(b.c16,v_pshzdCode)>0 and a.c30=b.c1 and a.c4=b.c4 and a.c25=b.c9 group by b.c2 having sum(decode(a.c22,v_dmStatus_1,0,232050,0,1))=0)) t0;
              update BO_Order_Ing_JHD set c10=9, uptdate=sysdate
               where c2 in (select b.c2 from BO_Order_Goods_Ing a, BO_Order_Ing_JHD b where instr(b.c16,v_pshzdCode)>0 and a.c30=b.c1 and a.c4=b.c4 and a.c25=b.c9 group by b.c2 having sum(decode(a.c22,v_dmStatus_1,0,232050,0,1))=0);
              --集货汇总单是否装车完成
              insert into ZBO_Order_Ing_JHHZD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_JHHZD 
               where c1 in (select b.c1 from BO_Order_Goods_Ing a, BO_Order_Ing_JHHZD b where instr(b.c12,v_pshzdCode)>0 and a.c30=b.c1 group by b.c1 having sum(decode(a.c22,v_dmStatus_1,0,232050,0,1))=0)) t0;
              update BO_Order_Ing_JHHZD set c2=9, uptdate=sysdate
               where c1 in (select b.c1 from BO_Order_Goods_Ing a, BO_Order_Ing_JHHZD b where instr(b.c12,v_pshzdCode)>0 and a.c30=b.c1 group by b.c1 having sum(decode(a.c22,v_dmStatus_1,0,232050,0,1))=0);
              
              pkg_ofooddms_orderStat.P_SMS(1, 138444, 333, '70004: 库内监管提醒'||v_pshzdCode||'准备发车');
          else
              --回退
              a_logStr := a_logStr||'--回退';
              select count(*),max(c8) into counter,v_pshzdCode from YS_Car where c1=v_carCode and c4=v_dmStatus_1;
              if counter = 0 then
                  Message := Message||'车辆['||v_carCode||']不存在或状态不符！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --更新集货单状态--回退
              insert into ZBO_Order_Ing_JHD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_JHD where c16=v_pshzdCode) t0;
              update BO_Order_Ing_JHD set c10=v_dmStatus_0, uptdate=sysdate where c16=v_pshzdCode; --已出库
              --更新车辆状态--回退
              insert into ZYS_Car select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Car where c1=v_carCode and c4=v_dmStatus_1) t0;
              update YS_Car set c4=v_dmStatus_0, c9=0, uptdate=sysdate where c1=v_carCode and c4=v_dmStatus_1;
              --生成配送汇总单--回退
              delete from BO_Order_Ing_PSHZD where c1=v_pshzdCode;
              --生成配送单--回退
              delete from BO_Order_Ing_PSD where c1=v_pshzdCode;
              --更新子订单状态--回退
              insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing where c22 = v_dmStatus_1 and c31 = v_pshzdCode) t0;
              update BO_Order_Goods_Ing t set c22=v_dmStatus_0, uptdate=sysdate 
               where c22 = v_dmStatus_1
                 and c31 = v_pshzdCode;
              --更新总订单状态--回退
              insert into ZBO_Order_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing where c17=v_dmStatus_1 and c24=v_pshzdCode ) t0;
              update BO_Order_Ing t set c17=232001, c24='', uptdate=sysdate where c17=v_dmStatus_1 and c24=v_pshzdCode;
              --集货汇总单是否装车完成--回退
              insert into ZBO_Order_Ing_JHHZD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_JHHZD
               where c1 in (select distinct c1 from BO_Order_Ing_JHD where c16=v_pshzdCode) 
                 and c2 = 9 ) t0;
              update BO_Order_Ing_JHHZD set c2=232048, uptdate=sysdate 
               where c1 in (select distinct c1 from BO_Order_Ing_JHD where c16=v_pshzdCode) 
                 and c2 = 9;
          end if;
          ---------------------------------------------------------------------------------------------------------

      elsif v_dmCode = '022_PSDDY' then --配送单打印
          v_pshzdCode := p1;
          ---------------------------------------------------------------------------------------------------------
          if a_reset = 0 then
              --检验有效性
              select count(*),max(c5) into counter,v_carCode from BO_Order_Ing_PSHZD where c1=v_pshzdCode;
              if counter = 0 then
                  Message := Message||'配送汇总单['||v_pshzdCode||']不存在！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              select count(*) into counter from BO_Order_Ing_PSHZD where c1=v_pshzdCode and c2=0;
              if counter = 1 then

                --更新车辆状态
                insert into ZYS_Car select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Car where c1=v_carCode and c4=v_dmStatus_0) t0;
                update YS_Car set c4=v_dmStatus_1, uptdate=sysdate where c1=v_carCode and c4=v_dmStatus_0;
                --更新物流箱状态
                insert into ZYS_Package select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Package where c5=v_carCode) t0;
                update YS_Package set c4=v_dmStatus_1, uptdate=sysdate where c5=v_carCode;

                --更新订单状态
                insert into ZBO_Order_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing where c24=v_pshzdCode) t0;
                update BO_Order_Ing set c15=230005, c17=v_dmStatus_1, uptdate=sysdate where c24=v_pshzdCode;
                --更新子订单状态
                insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing where c22 = v_dmStatus_0 and c31 = v_pshzdCode) t0;
                update BO_Order_Goods_Ing t set c21=230005, c22=v_dmStatus_1, uptdate=sysdate 
                 where c22 = v_dmStatus_0
                   and c31 = v_pshzdCode;
              end if;
              
              --发送签收码短信
              insert into BO_Sms_Ing(dataid,c1,c2,c3,c4,c5,c6)
              select seqBO_Sms_Ing.Nextval,'000000',a.c7,'您店采购的商品正在配送途中，本次配送的签收码为'||a.c17||'。',0,'',138001 from BO_Order_Ing_PSD a where a.c1=v_pshzdCode and a.c10=0;
                
              --更新配送单状态
              insert into ZBO_Order_Ing_PSD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_PSD where c1=v_pshzdCode and c10=0) t0;
              update BO_Order_Ing_PSD set c10=v_dmStatus_1, uptdate=sysdate where c1=v_pshzdCode and c10=0;
              --更新配送汇总单状态
              insert into ZBO_Order_Ing_PSHZD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_PSHZD where c1=v_pshzdCode and c2=0) t0;
              update BO_Order_Ing_PSHZD set c2=v_dmStatus_1, uptdate=sysdate where c1=v_pshzdCode and c2=0;
              
              
          else
              --回退
              null;
          end if;
          ---------------------------------------------------------------------------------------------------------
      
      elsif v_dmCode = '023_KHQS' or v_dmCode = '024_KHBFQS' or v_dmCode = '025_KHQBJS' then --客户签收  --客户部分拒收  --客户全部拒收
          v_psdCode := p1;
          v_num := p2;
          v_orderCode := p3;
          v_result := p4;
          ---------------------------------------------------------------------------------------------------------
          if a_reset = 0 then
              --检验有效性 --配送汇总单号 买家mid
              select count(*),max(c1),max(c4) into counter,v_pshzdCode,v_mid from BO_Order_Ing_PSD where c2=v_psdCode and c10=v_dmStatus_0;
              if counter = 0 then
                  Message := Message||'配送单['||v_psdCode||']不存在或状态不符！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              if v_dmCode = '023_KHQS' then --客户签收
                select count(*) into counter from BO_Order_Ing_PSD where c2=v_psdCode and c17=v_num;
                if counter = 0 then
                    Message := Message||'签收码不正确！';
                    P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                    open ResultCursor for select Message sqlmsg from dual;
                    return;
                end if;
              end if;
              
              if v_dmCode = '024_KHBFQS' then --客户部分拒收
                  select count(dataid) into counter from BO_Order_Goods_Ing where instr(v_orderCode,c2) > 0;
                  select count(dataid) into v_num from BO_Order_Goods_Ing where c4=v_mid and c31=v_pshzdCode and c10=v_dmStatus_0;
                  if counter = v_num then
                      v_dmCode := '025_KHQBJS'; --客户全部拒收
                      v_dmStatus_1 := 232061; --客户拒收
                  end if;
              end if;              
              
              --取得配送车辆
              select c1 into v_carCode from YS_Car where c8=v_pshzdCode;
              
              --更新车辆状态
              insert into ZYS_Car select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Car where c1=v_carCode and c4=v_dmStatus_0) t0;
              update YS_Car set c6=substr(replace(','||c6,','||v_mid||',',','),2), uptdate=sysdate where c1=v_carCode and c4=v_dmStatus_0;
              --更新物流箱状态
              insert into ZYS_Package select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Package where c8=v_pshzdCode and c7=v_mid) t0;
              update YS_Package set c4=232060, c6='', uptdate=sysdate where c8=v_pshzdCode and c7=v_mid;
              --更新虚拟物流箱状态
              insert into ZYS_Package select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Package where c2=9 and c8=v_pshzdCode and c7=v_mid) t0;
              update YS_Package set c4=0, c5='', c6='', c7=-1, c8='', uptdate=sysdate where c2=9 and c8=v_pshzdCode and c7=v_mid;
              --更新配送单状态: 232060-已签收
              insert into ZBO_Order_Ing_PSD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_PSD where c2=v_psdCode) t0;
              update BO_Order_Ing_PSD set c10=232060,c16=sysdate, uptdate=sysdate where c2=v_psdCode;
              --更新订单状态
              insert into ZBO_Order_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing where c3=v_mid and c24=v_pshzdCode) t0;
              update BO_Order_Ing set c15=230009, c16=231001, c17=v_dmStatus_1, c25=sysdate, uptdate=sysdate where c3=v_mid and c24=v_pshzdCode;
              
              if v_dmCode = '023_KHQS' then --客户签收
                  --更新子订单配送状态
                  insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing where c22=v_dmStatus_0 and c4=v_mid and c31=v_pshzdCode) t0;
                  update BO_Order_Goods_Ing t set c47=11, c22=v_dmStatus_1, c29=to_char(sysdate,'yyyy-mm-dd hh24:mi')||' 客户签收', uptdate=sysdate 
                   where c22 = v_dmStatus_0
                     and c4 = v_mid
                     and c31 = v_pshzdCode;
              elsif v_dmCode = '025_KHQBJS' then --客户全部拒收
                  --记录拒收费用233003
                  insert into BO_Order_FeeDetail(dataid,c1,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12,c13) 
                       select seqBO_Order_FeeDetail.nextval,ttt.* from (select c1 odid,-1,sum(c33) price_s,sum(c35) price_ys,sum(c37) price_b,233003 feeType,
                              '客户拒收'||sum(c37)||'元' feeDesc, 130001 status, 1 show,1 calcul,a_operatorID,a_operator,sysdate
                         from BO_Order_Goods_Ing
                        where c22 = v_dmStatus_0
                          and c4 = v_mid
                          and c31 = v_pshzdCode group by c1) ttt;
                  --更新子订单配送状态
                  insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing where c22 = v_dmStatus_0 and c4=v_mid and c31=v_pshzdCode) t0;
                  update BO_Order_Goods_Ing t set c47=10, c22=v_dmStatus_1, c17=0,c37=0, c57=c52,c58=c53,c59=c54, c24=to_char(sysdate,'yyyy-mm-dd hh24:mi')||' 客户拒收', c29=to_char(sysdate,'yyyy-mm-dd hh24:mi')||' 客户全部拒收', uptdate=sysdate 
                   where c22 = v_dmStatus_0
                     and c4 = v_mid
                     and c31 = v_pshzdCode;
                  --生成拒收订单
                  insert into BO_Order_Goods_Reback select * from BO_Order_Goods_Ing
                   where c22 = v_dmStatus_1
                     and c4 = v_mid
                     and c31 = v_pshzdCode;
                  
                  --更新总订单实际金额
                  insert into ZBO_Order_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing where c3=v_mid and c24=v_pshzdCode) t0;
                  update BO_Order_Ing t set (c8,c9,c12,c13,c14)=(select sum(c40), sum(c41), sum(c37), sum(c35), sum(c33) from BO_Order_Goods_Ing m where m.c1=t.c1) where c3=v_mid and c24=v_pshzdCode; --原食结算价、买家结算价
                  --更新集货单的总金额
                  update BO_Order_Ing_JHD t set c13=(select sum(c37) from BO_Order_Goods_Ing m where m.c30=t.c1 and m.c4=t.c4) where c1 in (select distinct c30 from BO_Order_Goods_Ing where c4=v_mid and c31=v_pshzdCode);
                  --更新配送单的总金额
                  update BO_Order_Ing_PSD t set c14=(select sum(c37) from BO_Order_Goods_Ing m where m.c4=t.c4 and m.c31=t.c1) where c2=v_psdCode;
                     
              elsif v_dmCode = '024_KHBFQS' then --客户部分拒收
                  --记录拒收费用233003
                  insert into BO_Order_FeeDetail(dataid,c1,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12,c13) 
                       select seqBO_Order_FeeDetail.nextval,ttt.* from (select c1 odid,-1,sum(c33) price_s,sum(c35) price_ys,sum(c37) price_b,233003 feeType,
                              '客户部分拒收'||sum(c37)||'元' feeDesc, 130001 status, 1 show,1 calcul,a_operatorID,a_operator,sysdate
                         from BO_Order_Goods_Ing
                        where c22 = v_dmStatus_0
                          and instr(v_orderCode,c2) > 0
                          and c4 = v_mid
                          and c31 = v_pshzdCode group by c1) ttt;
                  --更新子订单配送状态: 拒收
                  insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing t
                   where c22 = v_dmStatus_0
                     and instr(v_orderCode,c2) > 0
                     and c4 = v_mid
                     and c31 = v_pshzdCode) t0;
                  update BO_Order_Goods_Ing t set c47=10, c22=v_dmStatus_1, c17=0,c37=0, c57=c52,c58=c53,c59=c54, c24=to_char(sysdate,'yyyy-mm-dd hh24:mi')||' 客户拒收', c29=to_char(sysdate,'yyyy-mm-dd hh24:mi')||' 客户部分拒收', uptdate=sysdate
                   where c22 = v_dmStatus_0
                     and instr(v_orderCode,c2) > 0
                     and c4 = v_mid
                     and c31 = v_pshzdCode;
                  --生成拒收订单
                  insert into BO_Order_Goods_Reback select * from BO_Order_Goods_Ing
                   where c22 = v_dmStatus_1
                     and instr(v_orderCode,c2) > 0
                     and c4 = v_mid
                     and c31 = v_pshzdCode;

                  --更新子订单配送状态: 签收
                  insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing t
                   where c22 = v_dmStatus_0
                     and instr(v_orderCode,c2) = 0
                     and c4 = v_mid
                     and c31 = v_pshzdCode) t0;
                  update BO_Order_Goods_Ing t set c47=1, c22=232060, c29=to_char(sysdate,'yyyy-mm-dd hh24:mi')||' 客户部分签收', uptdate=sysdate
                   where c22 = v_dmStatus_0
                     and instr(v_orderCode,c2) = 0
                     and c4 = v_mid
                     and c31 = v_pshzdCode;
                  
                  --更新总订单实际金额
                  insert into ZBO_Order_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing where c3=v_mid and c24=v_pshzdCode) t0;
                  update BO_Order_Ing t set (c8,c9,c12,c13,c14)=(select sum(c40), sum(c41), sum(c37), sum(c35), sum(c33) from BO_Order_Goods_Ing m where m.c1=t.c1) where c3=v_mid and c24=v_pshzdCode; --原食结算价、买家结算价
                  /*--更新集货单的总金额
                  update BO_Order_Ing_JHD t set c13=(select sum(c37) from BO_Order_Goods_Ing m where m.c30=t.c1 and m.c4=t.c4) where c1 in (select distinct c30 from BO_Order_Goods_Ing where c4=v_mid and c31=v_pshzdCode);
                  --更新配送单的总金额
                  update BO_Order_Ing_PSD t set c14=(select sum(c37) from BO_Order_Goods_Ing m where m.c4=t.c4 and m.c31=t.c1) where c2=v_psdCode;
                  */
              end if;
              
              --更新子订单状态: 已完成
              insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing where c21=230005 and c4=v_mid and c31=v_pshzdCode) t0;
              update BO_Order_Goods_Ing t set c21=decode(c22,232061,230094,230009), c23=231001, uptdate=sysdate 
               where c21 = 230005 --正在发货途中
                 and c4 = v_mid
                 and c31 = v_pshzdCode;
                            
              select count(*) into counter from BO_Order_Ing_PSD where c1=v_pshzdCode and c10=v_dmStatus_0;
              if counter = 0 then
                --更新车辆状态
                insert into ZYS_Car select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Car where c8=v_pshzdCode) t0;
                update YS_Car set c4=0,c5='',c6='',c7='',c8='',c9=0, uptdate=sysdate where c8=v_pshzdCode;
                --更新配送汇总单状态: 232060-已签收
                insert into ZBO_Order_Ing_PSHZD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_PSHZD where c1=v_pshzdCode) t0;
                update BO_Order_Ing_PSHZD set c2=232060,c19=sysdate,uptdate=sysdate where c1=v_pshzdCode;
              end if;
          
          else
              --回退
              null;
          end if;
          ---------------------------------------------------------------------------------------------------------      

      elsif v_dmCode = '026_ZZXHS' then --物流箱回收
          v_carCode := p1;
          v_packageCode := p2;
          ---------------------------------------------------------------------------------------------------------
          if a_reset = 0 then
              --检验有效性
              select count(*) into counter from YS_Car where c1=v_carCode;
              if counter = 0 then
                  Message := Message||'车辆['||v_carCode||']不存在！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
                  
              --更新物流箱状态
              insert into ZYS_Package select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Package where c4<>0 and instr(v_packageCode,c1)>0) t0;
              update YS_Package set c4=0, c5='', c6='', c7=-1, c8='', uptdate=sysdate where c4<>0 and instr(v_packageCode,c1)>0;
          end if;   
          ---------------------------------------------------------------------------------------------------------
      
      elsif v_dmCode = '027_XDQS' then --消单
          v_pshzdCode := p1;
          ---------------------------------------------------------------------------------------------------------
          if a_reset = 0 then
              if instr(v_pshzdCode, 'PTHZ') = 0 then
                  --检验配送汇总单  --配送途中
                  select count(*) into counter from BO_Order_Ing_PSHZD where c1 = v_pshzdCode and c2=v_dmStatus_0;
                  if counter = 0 then
                      Message := Message||'配送汇总单['||v_pshzdCode||']不存在或状态不符！';
                      P_Log(a_logStr||' '||Message, a_operator);
                      open ResultCursor for select Message sqlmsg from dual;
                      return;
                  end if;
                  --检验状态  --签收/拒收入库完成
                  select count(*) into counter from BO_Order_Ing_PSD where c1=v_pshzdCode and (c10 <> v_dmStatus_0 and c10 <> 232043);
                  if counter > 0 then
                      Message := Message||'有['||counter||']个配送单状态不符合流程规则！';
                      P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                      open ResultCursor for select Message sqlmsg from dual;
                      return;
                  end if;
                  --检验物流箱是否入库
                  select count(dataid) into counter from YS_Package where c2<>2 and c8=v_pshzdCode;
                  if counter > 0 then
                      Message := Message||'有['||counter||']个物流箱未入库！';
                      P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                      open ResultCursor for select Message sqlmsg from dual;
                      return;
                  end if;
              else
                  --检验配送汇总单  --退货取货途中
                  select count(*) into counter from BO_Order_Reback_THHZD where c1 = v_pshzdCode and c2=232073;
                  if counter = 0 then
                      Message := Message||'销售退货汇总单['||v_pshzdCode||']不存在或状态不符！';
                      P_Log(a_logStr||' '||Message, a_operator);
                      open ResultCursor for select Message sqlmsg from dual;
                      return;
                  end if;
              end if;
              
              --检验状态  --销售退货入库完成
              select count(*) into counter from BO_Order_Reback_THD where c1=v_pshzdCode and c10 <> 232043;
              if counter > 0 then
                  Message := Message||'有['||counter||']个销售退货单状态不符合流程规则！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              if instr(v_pshzdCode, 'PTHZ') = 0 then
                --更新配送汇总单状态
                insert into ZBO_Order_Ing_PSHZD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing_PSHZD where c1=v_pshzdCode) t0;
                update BO_Order_Ing_PSHZD set c2=v_dmStatus_1, uptdate=sysdate where c1=v_pshzdCode;
              else
                --更新销售退货汇总单状态
                insert into ZBO_Order_Reback_THHZD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Reback_THHZD where c1=v_pshzdCode) t0;
                update BO_Order_Reback_THHZD set c2=v_dmStatus_1, uptdate=sysdate where c1=v_pshzdCode;
              end if;
          else
              --回退
              null;
          end if;
          ---------------------------------------------------------------------------------------------------------
          
      elsif v_dmCode = '030_CLTHDD' then --处理买家退货请求
          v_result := p1;
          v_orderCode := p2;
          v_num := p3;
          v_result2 := p4; --退货原因
          ---------------------------------------------------------------------------------------------------------
          v_orderCode := replace(v_orderCode, 'S', '');
          if a_reset = 0 then
              --检验订单
              select count(*) into counter from BO_Order_Goods_Ing where substr(c2,2)=v_orderCode and c22=v_dmStatus_0;
              if counter = 0 then
                  Message := Message||'订单['||v_orderCode||']不存在或状态不符！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              if v_result = 0 or v_result = 4 or v_result = 1 or v_result = 3 then --免单 --补贴 --退货 --直退
                  if v_result = 0 then --免单
                      tmp := 230098; --已免单 
                  elsif v_result = 4 then --补贴
                      tmp := 230097; --补贴
                  elsif v_result = 1 then --退货
                      tmp := 230012; --退货处理中
                  elsif v_result = 3 then --直退
                      tmp := 230096; --已退货  230095已部分退货
                  end if;
              
                  --更新子订单状态
                  insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing t
                   where c22 = v_dmStatus_0
                     and substr(c2,2) = v_orderCode) t0;
                  insert into ZBO_Order_Goods_Reback select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Reback t
                   where c22 = v_dmStatus_0
                     and substr(c2,2) = v_orderCode) t0;
                  if v_result = 0 then --免单
                      --费用明细
                      insert into BO_Order_FeeDetail(dataid,c1,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12,c13)
                      select seqBO_Order_FeeDetail.nextval,c1 odid,c2 sodid,0*c33 price_s,0*c35 price_ys,-1*c53 price_b,233004 feeType,'[免单]'||v_result2 feeDesc, 130001 status, 1 show,1 calcul,a_operatorID,a_operator,sysdate from BO_Order_GoodsDetail where substr(c2,2)=v_orderCode;
                      --更新订单费用
                      update BO_Order_Goods_Ing t set c47=11, c37=0, c61=c53, c21=tmp, c29=to_char(sysdate,'yyyy-mm-dd hh24:mi:ss') ||' 免单', uptdate=sysdate
                       where c22 = v_dmStatus_0
                         and substr(c2,2) = v_orderCode;
                      --更新退单费用
                      update BO_Order_Goods_Reback t set c47=11, c37=0, c61=c53, c21=tmp, c29=to_char(sysdate,'yyyy-mm-dd hh24:mi:ss') ||' 免单', uptdate=sysdate
                       where c22 = v_dmStatus_0
                         and substr(c2,2) = v_orderCode;
                  
                  elsif v_result = 4 then --补贴
                      --费用明细
                      insert into BO_Order_FeeDetail(dataid,c1,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12,c13)
                      select seqBO_Order_FeeDetail.nextval,c1 odid,c2 sodid,0*c33 price_s,0*c35 price_ys,-1*v_num price_b,233004 feeType,'[补贴]'||v_result2 feeDesc, 130001 status, 1 show,1 calcul,a_operatorID,a_operator,sysdate from BO_Order_GoodsDetail where substr(c2,2)=v_orderCode;
                      --更新订单费用
                      update BO_Order_Goods_Ing t set c47=11, c37=c37-v_num, c61=v_num, c21=tmp, c29=to_char(sysdate,'yyyy-mm-dd hh24:mi:ss') ||' 补贴'||v_num||'元', uptdate=sysdate
                       where c22 = v_dmStatus_0
                         and substr(c2,2) = v_orderCode;
                      --更新退单费用
                      update BO_Order_Goods_Reback t set c47=11, c37=c37-v_num, c61=v_num, c21=tmp, c29=to_char(sysdate,'yyyy-mm-dd hh24:mi:ss') ||' 补贴'||v_num||'元', uptdate=sysdate
                       where c22 = v_dmStatus_0
                         and substr(c2,2) = v_orderCode;
                         
                  elsif v_result = 1 then --同意退货
                      --费用明细
                      insert into BO_Order_FeeDetail(dataid,c1,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12,c13)
                      select seqBO_Order_FeeDetail.nextval,c1 odid,c2 sodid,0*c33 price_s,-1*c54 price_ys,-1*c53 price_b,233006 feeType,'[同意退货]'||v_result2 feeDesc, 130001 status, 1 show,1 calcul,a_operatorID,a_operator,sysdate from BO_Order_GoodsDetail where substr(c2,2)=v_orderCode;
                      --更新订单  --232070准备退货
                      update BO_Order_Goods_Ing t set c47=0, c21=tmp, c22=232070, c57=c52,c58=c53,c59=c54, c29=to_char(sysdate,'yyyy-mm-dd hh24:mi:ss') ||' 同意退货', uptdate=sysdate
                       where c22 = v_dmStatus_0
                         and substr(c2,2) = v_orderCode;
                      --更新退单  --232070准备退货
                      update BO_Order_Goods_Reback t set c47=0, c21=tmp, c22=232070, c57=c52,c58=c53,c59=c54, c29=to_char(sysdate,'yyyy-mm-dd hh24:mi:ss') ||' 同意退货', uptdate=sysdate
                       where c22 = v_dmStatus_0
                         and substr(c2,2) = v_orderCode;
                     
                  elsif v_result = 3 then --直退
                      --费用明细
                      insert into BO_Order_FeeDetail(dataid,c1,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12,c13)
                      select seqBO_Order_FeeDetail.nextval,c1 odid,c2 sodid,-1*c33 price_s,-1*c35 price_ys,-1*c37 price_b,233006 feeType,'[直退]'||v_result2 feeDesc, 130001 status, 1 show,1 calcul,a_operatorID,a_operator,sysdate from BO_Order_GoodsDetail where substr(c2,2)=v_orderCode;
                      --更新订单 --232086退货完成
                      update BO_Order_Goods_Ing t set c47=11, c33=0, c35=0, c37=0, c55=c50,c56=c51,c57=c52,c58=c53,c59=c54, c21=tmp, c22=232086, c29=to_char(sysdate,'yyyy-mm-dd hh24:mi:ss') ||' 直退', uptdate=sysdate
                       where c22 = v_dmStatus_0
                         and substr(c2,2) = v_orderCode;
                      --更新退单 --232086退货完成
                      update BO_Order_Goods_Reback t set c47=11, c33=0, c35=0, c37=0, c55=c50,c56=c51,c57=c52,c58=c53,c59=c54, c21=tmp, c22=232086, c29=to_char(sysdate,'yyyy-mm-dd hh24:mi:ss') ||' 直退', uptdate=sysdate
                       where c22 = v_dmStatus_0
                         and substr(c2,2) = v_orderCode;
                  end if;
                  
                  select c1 into tmp from BO_Order_Goods_Ing where substr(c2,2)=v_orderCode;
                  --更新订单状态
                  insert into ZBO_Order_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing t where c1=tmp ) t0;
                  update BO_Order_Ing t set (c8,c9,c12,c13,c14,c28,c29)=(select sum(c40),sum(c41),sum(c37),sum(c35),sum(c33),sum(c58),sum(decode(c58,0,0,1)) from BO_Order_Goods_Ing m where m.c1=t.c1), uptdate=sysdate where c1=tmp;
                  
                  select count(*) into counter from BO_Order_Goods_Ing where c1=tmp and c21=230011;
                  if counter = 0 then
                    select count(*) into counter from BO_Order_Goods_Ing where c1=tmp and c21=230012;
                    update BO_Order_Ing t set c15=decode(counter,0,230099,230012) where c1=tmp;
                  end if;
                
                
              elsif v_result = 2 then --拒绝退货
                  pkg_ofooddms_orderstat.P_SMS(0, 138444, '13811367810', '您的验证码为1111，系统不支持拒绝退货流程。');
                  Message := Message||'系统暂不支持[拒绝退货]流程！';
                  P_Log(a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              
              end if;
      
          else
              --回退
              null;
          end if;
          ---------------------------------------------------------------------------------------------------------
          
      elsif v_dmCode = '033_THRK' then --退货入库
          v_containerCode := p1;
          v_orderCode := p2;
          v_placeCode := p3;
          ---------------------------------------------------------------------------------------------------------
          if a_reset = 0 then
              --检验有效性
              select count(*) into counter from YS_Container where c1=v_containerCode and c4=0;
              if counter = 0 then
                  Message := Message||'容器['||v_containerCode||']不可用或状态不符！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验有效性
              select count(*) into counter from YS_Place where c1=v_placeCode and c4=0 and c2<>2;
              if counter = 0 then
                  Message := Message||'位置['||v_placeCode||']不可用或状态不符！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              --更新容器状态 位置 订单
              insert into ZYS_Container select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Container where c1=v_containerCode) t0;
              update YS_Container set c4=v_dmStatus_1, c5=v_placeCode, c6=c6||v_orderCode, c8=F_Order_SellMid_List(c6||v_orderCode), c9=F_Order_BuyMid_List(c6||v_orderCode), c11=F_Order_JHD_List(c6||v_orderCode), uptdate=sysdate where c1=v_containerCode;
              --更新退单状态
              insert into ZBO_Order_Goods_Reback select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Reback
               where c22 = v_dmStatus_0
                 and instr(v_orderCode,c2)>0) t0;
              update BO_Order_Goods_Reback t set c22=v_dmStatus_1, c29='退货入库'||v_placeCode||'-'||v_containerCode, uptdate=sysdate
               where c22 = v_dmStatus_0
                 and instr(v_orderCode,c2)>0;
              --更新订单状态
              insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing
               where c22 = v_dmStatus_0
                 and instr(v_orderCode,c2)>0) t0;
              update BO_Order_Goods_Ing t set c22=v_dmStatus_1, c29='退货入库'||v_placeCode||'-'||v_containerCode, uptdate=sysdate
               where c22 = v_dmStatus_0
                 and instr(v_orderCode,c2)>0;
              
          else
              --回退
              null;
          end if;
          ---------------------------------------------------------------------------------------------------------
          
      elsif v_dmCode = '034_THCK' then --退货出库
          v_orderCode := p1;
          ---------------------------------------------------------------------------------------------------------
          if a_reset = 0 then
              --检查订单
              select count(*) into counter from BO_Order_Goods_Reback where instr(v_orderCode,c2)>0;
              select count(*) into v_num from BO_Order_Goods_Reback where c22=v_dmStatus_0 and instr(v_orderCode,c2)>0;
              if counter = 0 or counter <> v_num then
                  Message := Message||'订单不符合规则！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              --更新退单状态
              insert into ZBO_Order_Goods_Reback select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Reback
               where c22 = v_dmStatus_0
                 and instr(v_orderCode,c2)>0) t0;
              update BO_Order_Goods_Reback t set c22=v_dmStatus_1, c29='退货出库', uptdate=sysdate
               where c22 = v_dmStatus_0
                 and instr(v_orderCode,c2)>0;
              --更新订单状态
              insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing
               where c22 = v_dmStatus_0
                 and instr(v_orderCode,c2)>0) t0;
              update BO_Order_Goods_Ing t set c22=v_dmStatus_1, c29='退货出库', uptdate=sysdate
               where c22 = v_dmStatus_0
                 and instr(v_orderCode,c2)>0;
              
          else
              --回退
              null;
          end if;
          ---------------------------------------------------------------------------------------------------------
          
      elsif v_dmCode = '035_THBS' then --退货报损
          v_orderCode := p1;
          ---------------------------------------------------------------------------------------------------------
          if a_reset = 0 then
              --检查订单
              select count(*) into counter from BO_Order_Goods_Reback where instr(v_orderCode,c2)>0;
              select count(*) into v_num from BO_Order_Goods_Reback where c22=v_dmStatus_0 and instr(v_orderCode,c2)>0;
              if counter = 0 or counter <> v_num then
                  Message := Message||'订单不符合规则！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              --更新退单状态
              insert into ZBO_Order_Goods_Reback select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Reback
               where c22 = v_dmStatus_0
                 and instr(v_orderCode,c2)>0) t0;
              update BO_Order_Goods_Reback t set c22=v_dmStatus_1, c29='退货报损', uptdate=sysdate
               where c22 = v_dmStatus_0
                 and instr(v_orderCode,c2)>0;
              --更新订单状态
              insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing
               where c22 = v_dmStatus_0
                 and instr(v_orderCode,c2)>0) t0;
              update BO_Order_Goods_Ing t set c22=v_dmStatus_1, c29='退货报损', uptdate=sysdate
               where c22 = v_dmStatus_0
                 and instr(v_orderCode,c2)>0;
              
          else
              --回退
              null;
          end if;
          ---------------------------------------------------------------------------------------------------------
          
      elsif v_dmCode = '038_XSTHHZD' then --生成销售退货汇总单
          ---------------------------------------------------------------------------------------------------------
          if a_reset = 0 then
              --检查销售退货订单
              select count(*) into counter from BO_Order_Goods_Reback where c22=v_dmStatus_0 and c45 is not null and instr(c45,'随')=0;
              if counter = 0 then
                  Message := Message||'没有符合规则的退货订单！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              --检验车辆状态
              select count(*),sum(decode(c4,0,0,232048,0,1)) into counter,v_num from YS_Car where c1 in (select c45 from BO_Order_Goods_Reback where c22=v_dmStatus_0 and c45 is not null and instr(c45,'随')=0);
              if counter=0 or v_num <> 0 then
                  Message := Message||'车辆['||v_carCode||']状态不符！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
          
              --更新车辆状态
              insert into ZYS_Car select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Car where c1 in (select c45 from BO_Order_Goods_Reback where c22=v_dmStatus_0 and c45 is not null and instr(c45,'随')=0)) t0;
              update YS_Car set c4=v_dmStatus_1, c9=1, uptdate=sysdate where c1 in (select c45 from BO_Order_Goods_Reback where c22=v_dmStatus_0 and c45 is not null and instr(c45,'随')=0);
              
              select NVL(max(c1), 'PTHZ'||to_char(sysdate,'yymmdd')||'0000') into v_pshzdCode from BO_Order_Reback_THHZD where c1 like 'PTHZ'||to_char(sysdate,'yymmdd')||'%';
              select to_char(sysdate,'yyyy-mm-dd hh24:mi') into tmp from dual;
              --生成销售退货汇总单
              insert into BO_Order_Reback_THHZD(dataid,c1,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12,c13,c14,c18,c19)
              select seqBO_Order_Reback_THHZD.Nextval, 'PTHZ'||(to_number(substr(v_pshzdCode,5))+rownum), t.* from 
              (select 0 status, to_date(tmp,'yyyy-mm-dd hh24:mi') psTime,b.c2 carType,b.c1 carCode,a_operatorID,a_operator,b.c10 carCID, '' premark,0 area,'' mids,count(distinct a.c3) num_amid,0 num_pack,count(a.dataid) num, sysdate startTime,null endTime
              from BO_Order_Goods_Reback a, YS_Car b where a.c22=v_dmStatus_0 and a.c45=b.c1
              group by b.c2,b.c1,b.c6,b.c7,b.c8,b.c10
              ) t;
              
              --生成销售退货单
              select NVL(max(c2), 'PTH'||to_char(sysdate,'yymmdd')||'0000') into v_psdCode from BO_Order_Reback_THD where c2 like 'PTH'||to_char(sysdate,'yymmdd')||'%';
              insert into BO_Order_Reback_THD(dataid,c2,c1,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12,c13,c14,c15,c16, c18,c19)
              select seqBO_Order_Reback_THD.Nextval, 'PTH'||(to_number(substr(v_psdCode,4))+rownum) psdCode, t.* from
              (select d.c1 pshzdCode, a.c3 amid, a.c4 mid, b.c1 mmName, b.c7 contact, b.c8 phone, b.c5 address,
                      to_char(sysdate,'yyyymmddhh24')||'00' psTime, 0 status, 0 num_pack, count(a.dataid) num_order,
                      sum(a.c40) weight, sum(a.c37) sumPriceFact_b, 0 psSeq, null,
                      c.c13 payType, c.c14 payDay
                 from BO_Order_Goods_Reback a, B_MMBuyer b, B_MMBuyer_Acctinfo c, BO_Order_Reback_THHZD d
                where a.c4=b.dataid and a.c3=b.c2 and b.c2=c.c1 and a.c45=d.c5
                  and a.c22 = v_dmStatus_0
                  group by a.c45, a.c3, a.c4, b.c1, b.c7, b.c8, b.c5, c.c13,c.c14, d.c1
              ) t;
              
              --更新退单状态
              insert into ZBO_Order_Goods_Reback select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Reback where c22 = v_dmStatus_0 and c45 in (select c1 from YS_Car) ) t0;
              update BO_Order_Goods_Reback t set c22=v_dmStatus_1, c45=(select c1 from BO_Order_Reback_THHZD m where m.c2=0 and m.c5=t.c45), uptdate=sysdate 
               where c22 = v_dmStatus_0
                 and c45 in (select c1 from YS_Car);
              --更新子订单状态
              insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing where c22 = v_dmStatus_0 and c45 in (select c1 from YS_Car) ) t0;
              update BO_Order_Goods_Ing t set c22=v_dmStatus_1, c45=(select c1 from BO_Order_Reback_THHZD m where m.c2=0 and m.c5=t.c45), uptdate=sysdate 
               where c22 = v_dmStatus_0
                 and c45 in (select c1 from YS_Car);
              --更新总订单状态
              insert into ZBO_Order_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Ing where c1 in (select distinct c1 from BO_Order_Goods_Ing a where a.c22=v_dmStatus_1) ) t0;
              update BO_Order_Ing t set c17=v_dmStatus_1, uptdate=sysdate where c1 in (select distinct c1 from BO_Order_Goods_Ing a where a.c22=v_dmStatus_1);

          else
              --回退
              a_logStr := a_logStr||'--回退';
              
          end if;
          ---------------------------------------------------------------------------------------------------------

      elsif v_dmCode = '039_XSTHDDY' then --销售退货单打印
          v_pshzdCode := p1;
          ---------------------------------------------------------------------------------------------------------
          if a_reset = 0 then
              --检验有效性
              select count(*),max(c5) into counter,v_carCode from BO_Order_Reback_THHZD where c1=v_pshzdCode;
              if counter = 0 then
                  Message := Message||'销售退货汇总单['||v_pshzdCode||']不存在！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              select count(*) into counter from BO_Order_Reback_THHZD where c1=v_pshzdCode and c2=0;
              if counter = 1 then

                --更新车辆状态
                insert into ZYS_Car select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Car where c1=v_carCode and c4=v_dmStatus_0) t0;
                update YS_Car set c4=v_dmStatus_1, uptdate=sysdate where c1=v_carCode and c4=v_dmStatus_0;

                --更新退单状态
                insert into ZBO_Order_Goods_Reback select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Reback where c22 = v_dmStatus_0 and c45 = v_pshzdCode) t0;
                update BO_Order_Goods_Reback t set c22=v_dmStatus_1, uptdate=sysdate 
                 where c22 = v_dmStatus_0
                   and c45 = v_pshzdCode;
                --更新子订单状态
                insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing where c22 = v_dmStatus_0 and c45 = v_pshzdCode) t0;
                update BO_Order_Goods_Ing t set c22=v_dmStatus_1, uptdate=sysdate 
                 where c22 = v_dmStatus_0
                   and c45 = v_pshzdCode;
              end if;
              
              --发送退货提醒短信
              insert into BO_Sms_Ing(dataid,c1,c2,c3,c4,c5,c6)
              select seqBO_Sms_Ing.Nextval,'000000',a.c7,'您店退货的商品请准备好，提货人员已在途中，敬请等待。',0,'',138001 from BO_Order_Reback_THD a where a.c1=v_pshzdCode and a.c10=0;
                
              --更新销售退货单状态
              insert into ZBO_Order_Reback_THD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Reback_THD where c1=v_pshzdCode and c10=0) t0;
              update BO_Order_Reback_THD set c10=v_dmStatus_1, uptdate=sysdate where c1=v_pshzdCode and c10=0;
              --更新销售退货汇总单状态
              insert into ZBO_Order_Reback_THHZD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Reback_THHZD where c1=v_pshzdCode and c2=0) t0;
              update BO_Order_Reback_THHZD set c2=v_dmStatus_1, uptdate=sysdate where c1=v_pshzdCode and c2=0;
              
          else
              --回退
              null;
          end if;
          ---------------------------------------------------------------------------------------------------------

      elsif v_dmCode = '040_TQMJTH' then --提取买家退货
          v_psdCode := p1;
          v_orderCode := p2;
          ---------------------------------------------------------------------------------------------------------
          if a_reset = 0 then
              --检验有效性
              select count(*) into counter from BO_Order_Reback_THD where c2=v_psdCode and c10=v_dmStatus_0;
              if counter = 0 then
                  Message := Message||'销售退货单['||v_psdCode||']不存在或状态不符！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              --取得配送汇总单号
              select distinct c1,c4 into v_pshzdCode,v_mid from BO_Order_Reback_THD where c2=v_psdCode;
              --取得配送车辆
              select c5 into v_carCode from BO_Order_Reback_THHZD where c1=v_pshzdCode;
              
              --检验订单
              select count(dataid) into counter from BO_Order_Goods_Reback where instr(v_orderCode,c2)>0;
              select count(dataid) into v_num from BO_Order_Goods_Reback where instr(v_orderCode,c2)>0 and c4=v_mid and c45=v_pshzdCode;
              if counter <> v_num then
                  Message := Message||'销售退货单['||v_psdCode||']与订单个数不符！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;

              --更新退单状态 --230096已退货
              insert into ZBO_Order_Goods_Reback select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Reback t
               where c22 = v_dmStatus_0
                 and instr(v_orderCode,c2) > 0
                 and c4 = v_mid
                 and c45 = v_pshzdCode) t0;
              update BO_Order_Goods_Reback t set c47=10, c21=230096, c22=v_dmStatus_1, c16=0,c17=0,c35=0,c37=0, c57=c52,c58=c53,c59=c54, c29='提取买家退货|'||v_carCode, uptdate=sysdate
               where c22 = v_dmStatus_0
                 and instr(v_orderCode,c2) > 0
                 and c4 = v_mid
                 and c45 = v_pshzdCode;
              --更新子订单状态 --230096已退货
              insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing t
               where c22 = v_dmStatus_0
                 and instr(v_orderCode,c2) > 0
                 and c4 = v_mid
                 and c45 = v_pshzdCode) t0;
              update BO_Order_Goods_Ing t set c47=10, c21=230096, c22=v_dmStatus_1, c16=0,c17=0,c35=0,c37=0, c57=c52,c58=c53,c59=c54, c29='提取买家退货|'||v_carCode, uptdate=sysdate
               where c22 = v_dmStatus_0
                 and instr(v_orderCode,c2) > 0
                 and c4 = v_mid
                 and c45 = v_pshzdCode;
                
              --更新销售退货单状态
              insert into ZBO_Order_Reback_THD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Reback_THD where c2=v_psdCode and c10=v_dmStatus_1) t0;
              update BO_Order_Reback_THD set c10=v_dmStatus_1, uptdate=sysdate where c2=v_psdCode and c10=v_dmStatus_0;

              if instr(v_pshzdCode, 'PTHZ')>0 then
                select count(*) into counter from BO_Order_Reback_THD where c1=v_pshzdCode and c10=v_dmStatus_0;
                if counter = 0 then
                  --更新车辆状态
                  insert into ZYS_Car select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from YS_Car where c8=v_pshzdCode) t0;
                  update YS_Car set c4=0,c5='',c6='',c7='',c8='',c9=0, uptdate=sysdate where c8=v_pshzdCode;
                  --更新销售退货汇总单状态: 232073-销售退货取货完成
                  insert into ZBO_Order_Reback_THHZD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Reback_THHZD where c1=v_pshzdCode) t0;
                  update BO_Order_Reback_THHZD set c2=232073,c19=sysdate,uptdate=sysdate where c1=v_pshzdCode;
                end if;
              end if;

          else
              --回退
              null;
          end if;
          ---------------------------------------------------------------------------------------------------------      
      
      elsif v_dmCode = '041_CGTHHZ' then --生成采购退货汇总单
          ---------------------------------------------------------------------------------------------------------
          if a_reset = 0 then
              --检验订单
              select count(dataid) into counter from BO_Order_Goods_Reback where c22=v_dmStatus_0;
              if counter = 0 then
                  Message := Message||'没有可生成汇总单的采购退货订单!';
                  rollback;
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              select count(distinct a.c4) into counter from BO_Order_Goods_Reback a, B_MMSeller b, B_MMSeller_Area c
               where a.c3=b.c2 and b.dataid=c.parentDataid and a.c22 = v_dmStatus_0 and (c.c3 is null or c.c3=0);
              if counter > 0 then
                  Message := Message||'有'||counter||'个卖家未分配区域!';
                  rollback;
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
          
              --生成采购退货汇总单
              select NVL(max(c1), 'STHZ'||to_char(sysdate,'yymmdd')||'0000') into v_thhzdCode from BO_Order_SReback_THHZD where c1 like 'STHZ'||to_char(sysdate,'yymmdd')||'%';
              insert into BO_Order_SReback_THHZD(dataid,c1,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12,c13,c14)
                   select seqBO_Order_SReback_THHZD.Nextval, 'STHZ'||(to_number(substr(v_thhzdCode,5))+rownum), t.* from (select c.c3 areaID, '' auid, '' thr,
                        to_char(sysdate,'yyyy-mm-dd') thrq, count(distinct a.c5) num_amid, count(a.dataid) num_order, sum(a.c40) zl, 0 tj, 0 status, a_operatorID, a_operator,
                        to_char(sysdate,'yyyy-mm-dd') fhrq, sum(a.c33) totalPrice
                     from BO_Order_Goods_Reback a, B_MMSeller b, B_MMSeller_Area c
                    where a.c5=b.c2 and c.parentDataid=a.c6
                      and a.c22=v_dmStatus_0
                      and not exists (select dataid from BO_Order_SReback_THHZD m where m.c2=c.c3 and m.c10=0)
                    group by c.c3) t;
              --生成采购退货单
              select NVL(max(c2), 'STH'||to_char(sysdate,'yymmdd')||'0000') into v_thdCode from BO_Order_SReback_THD where c2 like 'STH'||to_char(sysdate,'yymmdd')||'%';
              insert into BO_Order_SReback_THD(dataid,c2,c1,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12,c13,c14,c15,c16,c17, c18,c19)
                   select seqBO_Order_SReback_THD.Nextval, 'STH'||(to_number(substr(v_thdCode,4))+rownum),
                          t.* from (select d.c1 thhzdCode, a.c5 amid, a.c6 mid, b.c1 mmName, b.c7 contact, b.c8 phone,
                          b.c5 address, '' thTime, 0 status, count(a.dataid) num_order, sum(a.c40) zl, 0 tj, 1 seq,
                          pkg_ofooddms_orderStat.F_GetTHAreaSeq(a.c6,c.c3,v_dmStatus_0), sum(a.c33) totalPrice, max(c.c2) thseq,
                          e.c13 payType, e.c14 payDay
                     from BO_Order_Goods_Reback a, B_MMSeller b, B_MMSeller_Area c, BO_Order_SReback_THHZD d, b_Mmseller_Acctinfo e 
                    where a.c5=b.c2 and c.parentDataid=a.c6 and b.c2=e.c1 and c.c3=d.c2 and d.c10=0
                      and a.c22=v_dmStatus_0
                    group by a.c5, a.c6, b.c1, b.c5, b.c7, b.c8, c.c3, d.c1, e.c13,e.c14
                    order by mid,seq) t; 
              --更新退单状态
              insert into ZBO_Order_Goods_Reback select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Reback where c22=v_dmStatus_0) t0;
              update BO_Order_Goods_Reback t set c22=v_dmStatus_1, c46=(select max(c1) from BO_Order_SReback_THD a where a.c3=t.c5 and a.c10=0), c29='生成采购退货汇总单', uptdate=sysdate where c22=v_dmStatus_0;
              --更新订单状态
              insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing where c22=v_dmStatus_0) t0;
              update BO_Order_Goods_Ing t set c22=v_dmStatus_1, c46=(select max(c1) from BO_Order_SReback_THD a where a.c3=t.c5 and a.c10=0), c29='生成采购退货汇总单', uptdate=sysdate where c22=v_dmStatus_0;
              
          else      
              --回退
              null;
          end if;
          ---------------------------------------------------------------------------------------------------------

      elsif v_dmCode = '042_CGTHDDY' then --采购退货单打印
          v_thhzdCode := p1;
          ---------------------------------------------------------------------------------------------------------
          if a_reset = 0 then
              --检验有效性
              select count(*) into counter from BO_Order_SReback_THHZD where c1=v_thhzdCode;
              if counter = 0 then
                  Message := Message||'采购退货汇总单['||v_thhzdCode||']不存在！';
                  P_Log('库内作业:'||a_logStr||' '||Message, a_operator);
                  open ResultCursor for select Message sqlmsg from dual;
                  return;
              end if;
              
              select count(*) into counter from BO_Order_SReback_THHZD where c1=v_thhzdCode and c2=0;
              if counter = 1 then
                --更新退单状态
                insert into ZBO_Order_Goods_Reback select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Reback where c22=v_dmStatus_0 and c46=v_thhzdCode) t0;
                update BO_Order_Goods_Reback t set c22=v_dmStatus_1, uptdate=sysdate 
                 where c22 = v_dmStatus_0
                   and c46 = v_thhzdCode;
                --更新子订单状态
                insert into ZBO_Order_Goods_Ing select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_Goods_Ing where c22=v_dmStatus_0 and c46=v_thhzdCode) t0;
                update BO_Order_Goods_Ing t set c22=v_dmStatus_1, uptdate=sysdate 
                 where c22 = v_dmStatus_0
                   and c46 = v_thhzdCode;
              end if;
                
              --更新采购退货单状态
              insert into ZBO_Order_SReback_THD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_SReback_THD where c1=v_thhzdCode and c10=0) t0;
              update BO_Order_SReback_THD set c10=v_dmStatus_1, uptdate=sysdate where c1=v_thhzdCode and c10=0;
              --更新采购退货汇总单状态
              insert into ZBO_Order_SReback_THHZD select seq_z_datahis_iid.nextval,a_logStr,t0.* from (select * from BO_Order_SReback_THHZD where c1=v_thhzdCode and c10=0) t0;
              update BO_Order_SReback_THHZD set c10=v_dmStatus_1, uptdate=sysdate where c1=v_thhzdCode and c10=0;
              
          else
              --回退
              null;
          end if;
          ---------------------------------------------------------------------------------------------------------
      end if;
      
      -------------------------------------------------------------------------------------
      P_Log('库内作业: '||a_logStr||' ['||a_paramStr||']', a_operator);
      
    end if;
    
    Message := Message || '提交成功.';
    if length(p_reset)=0 then Message := Message ||'|'||p_reset; end if;
    open ResultCursor for select '' sqlmsg from dual;
    commit;
  exception when others then
    rollback;
    P_Log(a_logStr||' exception:'||sqlerrm, a_operator);
    pkg_ofooddms_orderstat.P_SMS(1,138444, null, '70333: 请技术人员速查SP_PDA_ServiceDO_Commit['||v_dmName||']'||substr(sqlerrm,1,100)); --发送短信
    Message := Message || '库内作业'||Message||': '||a_logStr||' ['||a_paramStr||'] 失败('||procno||')! '||substr(sqlerrm,1,100);
    open ResultCursor for select Message sqlmsg from dual;
  end;
  